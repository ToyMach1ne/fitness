!function(){function parseQuery(e){var t=new Object;if(!e)return t;for(var i=e.split(/[;&]/),n=0;n<i.length;n++){var a=i[n].split("=");if(a&&2===a.length){var s=unescape(a[0]),o=unescape(a[1]);o=o.replace(/\+/g," "),t[s]=o}}return t}if(window.jQuery&&window.jQuery.noConflict(),(!window.$||window.$.fn&&window.jQuery&&window.$.fn.jquery!=window.jQuery.fn.jquery)&&(window.$=window.jQuery),!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jWS requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function i(e){var t="length"in e&&e.length,i=Q.type(e);return"function"!==i&&!Q.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e))}function n(e,t,i){if(Q.isFunction(t))return Q.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return Q.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(re.test(t))return Q.filter(t,e,i);t=Q.filter(t,e)}return Q.grep(e,function(e){return V.call(t,e)>=0!==i})}function a(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function s(e){var t=pe[e]={};return Q.each(e.match(ge)||[],function(e,i){t[i]=!0}),t}function o(){X.removeEventListener("DOMContentLoaded",o,!1),e.removeEventListener("load",o,!1),Q.ready()}function r(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+r.uid++}function l(e,t,i){var n;if(void 0===i&&1===e.nodeType)if(n="data-"+t.replace(ke,"-$1").toLowerCase(),i=e.getAttribute(n),"string"==typeof i){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:be.test(i)?Q.parseJSON(i):i)}catch(a){}ve.set(e,t,i)}else i=void 0;return i}function c(){return!0}function d(){return!1}function u(){try{return X.activeElement}catch(e){}}function h(e,t){return Q.nodeName(e,"table")&&Q.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function g(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function p(e){var t=Me.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function f(e,t){for(var i=0,n=e.length;n>i;i++)me.set(e[i],"globalEval",!t||me.get(t[i],"globalEval"))}function w(e,t){var i,n,a,s,o,r,l,c;if(1===t.nodeType){if(me.hasData(e)&&(s=me.access(e),o=me.set(t,s),c=s.events)){delete o.handle,o.events={};for(a in c)for(i=0,n=c[a].length;n>i;i++)Q.event.add(t,a,c[a][i])}ve.hasData(e)&&(r=ve.access(e),l=Q.extend({},r),ve.set(t,l))}}function m(e,t){var i=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Q.nodeName(e,t)?Q.merge([e],i):i}function v(e,t){var i=t.nodeName.toLowerCase();"input"===i&&We.test(e.type)?t.checked=e.checked:("input"===i||"textarea"===i)&&(t.defaultValue=e.defaultValue)}function b(t,i){var n,a=Q(i.createElement(t)).appendTo(i.body),s=e.getDefaultComputedStyle&&(n=e.getDefaultComputedStyle(a[0]))?n.display:Q.css(a[0],"display");return a.detach(),s}function k(e){var t=X,i=Re[e];return i||(i=b(e,t),"none"!==i&&i||(je=(je||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=je[0].contentDocument,t.write(),t.close(),i=b(e,t),je.detach()),Re[e]=i),i}function _(e,t,i){var n,a,s,o,r=e.style;return i=i||Le(e),i&&(o=i.getPropertyValue(t)||i[t]),i&&(""!==o||Q.contains(e.ownerDocument,e)||(o=Q.style(e,t)),He.test(o)&&Fe.test(t)&&(n=r.width,a=r.minWidth,s=r.maxWidth,r.minWidth=r.maxWidth=r.width=o,o=i.width,r.width=n,r.minWidth=a,r.maxWidth=s)),void 0!==o?o+"":o}function y(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function x(e,t){if(t in e)return t;for(var i=t[0].toUpperCase()+t.slice(1),n=t,a=Ye.length;a--;)if(t=Ye[a]+i,t in e)return t;return n}function W(e,t,i){var n=Ge.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function C(e,t,i,n,a){for(var s=i===(n?"border":"content")?4:"width"===t?1:0,o=0;4>s;s+=2)"margin"===i&&(o+=Q.css(e,i+ye[s],!0,a)),n?("content"===i&&(o-=Q.css(e,"padding"+ye[s],!0,a)),"margin"!==i&&(o-=Q.css(e,"border"+ye[s]+"Width",!0,a))):(o+=Q.css(e,"padding"+ye[s],!0,a),"padding"!==i&&(o+=Q.css(e,"border"+ye[s]+"Width",!0,a)));return o}function T(e,t,i){var n=!0,a="width"===t?e.offsetWidth:e.offsetHeight,s=Le(e),o="border-box"===Q.css(e,"boxSizing",!1,s);if(0>=a||null==a){if(a=_(e,t,s),(0>a||null==a)&&(a=e.style[t]),He.test(a))return a;n=o&&(J.boxSizingReliable()||a===e.style[t]),a=parseFloat(a)||0}return a+C(e,t,i||(o?"border":"content"),n,s)+"px"}function S(e,t){for(var i,n,a,s=[],o=0,r=e.length;r>o;o++)n=e[o],n.style&&(s[o]=me.get(n,"olddisplay"),i=n.style.display,t?(s[o]||"none"!==i||(n.style.display=""),""===n.style.display&&xe(n)&&(s[o]=me.access(n,"olddisplay",k(n.nodeName)))):(a=xe(n),"none"===i&&a||me.set(n,"olddisplay",a?i:Q.css(n,"display"))));for(o=0;r>o;o++)n=e[o],n.style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?s[o]||"":"none"));return e}function B(e,t,i,n,a){return new B.prototype.init(e,t,i,n,a)}function I(){return setTimeout(function(){Je=void 0}),Je=Q.now()}function K(e,t){var i,n=0,a={height:e};for(t=t?1:0;4>n;n+=2-t)i=ye[n],a["margin"+i]=a["padding"+i]=e;return t&&(a.opacity=a.width=e),a}function O(e,t,i){for(var n,a=(it[t]||[]).concat(it["*"]),s=0,o=a.length;o>s;s++)if(n=a[s].call(i,t,e))return n}function D(e,t,i){var n,a,s,o,r,l,c,d,u=this,h={},g=e.style,p=e.nodeType&&xe(e),f=me.get(e,"fxshow");i.queue||(r=Q._queueHooks(e,"fx"),null==r.unqueued&&(r.unqueued=0,l=r.empty.fire,r.empty.fire=function(){r.unqueued||l()}),r.unqueued++,u.always(function(){u.always(function(){r.unqueued--,Q.queue(e,"fx").length||r.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[g.overflow,g.overflowX,g.overflowY],c=Q.css(e,"display"),d="none"===c?me.get(e,"olddisplay")||k(e.nodeName):c,"inline"===d&&"none"===Q.css(e,"float")&&(g.display="inline-block")),i.overflow&&(g.overflow="hidden",u.always(function(){g.overflow=i.overflow[0],g.overflowX=i.overflow[1],g.overflowY=i.overflow[2]}));for(n in t)if(a=t[n],Ze.exec(a)){if(delete t[n],s=s||"toggle"===a,a===(p?"hide":"show")){if("show"!==a||!f||void 0===f[n])continue;p=!0}h[n]=f&&f[n]||Q.style(e,n)}else c=void 0;if(Q.isEmptyObject(h))"inline"===("none"===c?k(e.nodeName):c)&&(g.display=c);else{f?"hidden"in f&&(p=f.hidden):f=me.access(e,"fxshow",{}),s&&(f.hidden=!p),p?Q(e).show():u.done(function(){Q(e).hide()}),u.done(function(){var t;me.remove(e,"fxshow");for(t in h)Q.style(e,t,h[t])});for(n in h)o=O(p?f[n]:0,n,u),n in f||(f[n]=o.start,p&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}function P(e,t){var i,n,a,s,o;for(i in e)if(n=Q.camelCase(i),a=t[n],s=e[i],Q.isArray(s)&&(a=s[1],s=e[i]=s[0]),i!==n&&(e[n]=s,delete e[i]),o=Q.cssHooks[n],o&&"expand"in o){s=o.expand(s),delete e[n];for(i in s)i in e||(e[i]=s[i],t[i]=a)}else t[n]=a}function U(e,t,i){var n,a,s=0,o=tt.length,r=Q.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var t=Je||I(),i=Math.max(0,c.startTime+c.duration-t),n=i/c.duration||0,s=1-n,o=0,l=c.tweens.length;l>o;o++)c.tweens[o].run(s);return r.notifyWith(e,[c,s,i]),1>s&&l?i:(r.resolveWith(e,[c]),!1)},c=r.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:Je||I(),duration:i.duration,tweens:[],createTween:function(t,i){var n=Q.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(a)return this;for(a=!0;n>i;i++)c.tweens[i].run(1);return t?r.resolveWith(e,[c,t]):r.rejectWith(e,[c,t]),this}}),d=c.props;for(P(d,c.opts.specialEasing);o>s;s++)if(n=tt[s].call(c,e,d,c.opts))return n;return Q.map(d,O,c),Q.isFunction(c.opts.start)&&c.opts.start.call(e,c),Q.fx.timer(Q.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function E(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,a=0,s=t.toLowerCase().match(ge)||[];if(Q.isFunction(i))for(;n=s[a++];)"+"===n[0]?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function M(e,t,i,n){function a(r){var l;return s[r]=!0,Q.each(e[r]||[],function(e,r){var c=r(t,i,n);return"string"!=typeof c||o||s[c]?o?!(l=c):void 0:(t.dataTypes.unshift(c),a(c),!1)}),l}var s={},o=e===bt;return a(t.dataTypes[0])||!s["*"]&&a("*")}function A(e,t){var i,n,a=Q.ajaxSettings.flatOptions||{};for(i in t)void 0!==t[i]&&((a[i]?e:n||(n={}))[i]=t[i]);return n&&Q.extend(!0,e,n),e}function N(e,t,i){for(var n,a,s,o,r=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=e.mimeType||t.getResponseHeader("Content-Type"));if(n)for(a in r)if(r[a]&&r[a].test(n)){l.unshift(a);break}if(l[0]in i)s=l[0];else{for(a in i){if(!l[0]||e.converters[a+" "+l[0]]){s=a;break}o||(o=a)}s=s||o}return s?(s!==l[0]&&l.unshift(s),i[s]):void 0}function j(e,t,i,n){var a,s,o,r,l,c={},d=e.dataTypes.slice();if(d[1])for(o in e.converters)c[o.toLowerCase()]=e.converters[o];for(s=d.shift();s;)if(e.responseFields[s]&&(i[e.responseFields[s]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=s,s=d.shift())if("*"===s)s=l;else if("*"!==l&&l!==s){if(o=c[l+" "+s]||c["* "+s],!o)for(a in c)if(r=a.split(" "),r[1]===s&&(o=c[l+" "+r[0]]||c["* "+r[0]])){o===!0?o=c[a]:c[a]!==!0&&(s=r[0],d.unshift(r[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(u){return{state:"parsererror",error:o?u:"No conversion from "+l+" to "+s}}}return{state:"success",data:t}}function R(e,t,i,n){var a;if(Q.isArray(t))Q.each(t,function(t,a){i||Wt.test(e)?n(e,a):R(e+"["+("object"==typeof a?t:"")+"]",a,i,n)});else if(i||"object"!==Q.type(t))n(e,t);else for(a in t)R(e+"["+a+"]",t[a],i,n)}function F(e){return Q.isWindow(e)?e:9===e.nodeType&&e.defaultView}var H=[],L=H.slice,z=H.concat,G=H.push,V=H.indexOf,$={},q=$.toString,Y=$.hasOwnProperty,J={},X=e.document,Z="2.1.4",Q=function(e,t){return new Q.fn.init(e,t)},ee=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,te=/^-ms-/,ie=/-([\da-z])/gi,ne=function(e,t){return t.toUpperCase()};Q.fn=Q.prototype={jws:Z,constructor:Q,selector:"",length:0,toArray:function(){return L.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:L.call(this)},pushStack:function(e){var t=Q.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Q.each(this,e,t)},map:function(e){return this.pushStack(Q.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(L.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(0>e?t:0);return this.pushStack(i>=0&&t>i?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:G,sort:H.sort,splice:H.splice},Q.extend=Q.fn.extend=function(){var e,t,i,n,a,s,o=arguments[0]||{},r=1,l=arguments.length,c=!1;for("boolean"==typeof o&&(c=o,o=arguments[r]||{},r++),"object"==typeof o||Q.isFunction(o)||(o={}),r===l&&(o=this,r--);l>r;r++)if(null!=(e=arguments[r]))for(t in e)i=o[t],n=e[t],o!==n&&(c&&n&&(Q.isPlainObject(n)||(a=Q.isArray(n)))?(a?(a=!1,s=i&&Q.isArray(i)?i:[]):s=i&&Q.isPlainObject(i)?i:{},o[t]=Q.extend(c,s,n)):void 0!==n&&(o[t]=n));return o},Q.extend({expando:"jWS"+(Z+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Q.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"===Q.type(e)&&!e.nodeType&&!Q.isWindow(e)&&!(e.constructor&&!Y.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?$[q.call(e)]||"object":typeof e},globalEval:function(e){var t,i=eval;e=Q.trim(e),e&&(1===e.indexOf("use strict")?(t=X.createElement("script"),t.text=e,X.head.appendChild(t).parentNode.removeChild(t)):i(e))},camelCase:function(e){return e.replace(te,"ms-").replace(ie,ne)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var a,s=0,o=e.length,r=i(e);if(n){if(r)for(;o>s&&(a=t.apply(e[s],n),a!==!1);s++);else for(s in e)if(a=t.apply(e[s],n),a===!1)break}else if(r)for(;o>s&&(a=t.call(e[s],s,e[s]),a!==!1);s++);else for(s in e)if(a=t.call(e[s],s,e[s]),a===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(ee,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(i(Object(e))?Q.merge(n,"string"==typeof e?[e]:e):G.call(n,e)),n},inArray:function(e,t,i){return null==t?-1:V.call(t,e,i)},merge:function(e,t){for(var i=+t.length,n=0,a=e.length;i>n;n++)e[a++]=t[n];return e.length=a,e},grep:function(e,t,i){for(var n,a=[],s=0,o=e.length,r=!i;o>s;s++)n=!t(e[s],s),n!==r&&a.push(e[s]);return a},map:function(e,t,n){var a,s=0,o=e.length,r=i(e),l=[];if(r)for(;o>s;s++)a=t(e[s],s,n),null!=a&&l.push(a);else for(s in e)a=t(e[s],s,n),null!=a&&l.push(a);return z.apply([],l)},guid:1,proxy:function(e,t){var i,n,a;return"string"==typeof t&&(i=e[t],t=e,e=i),Q.isFunction(e)?(n=L.call(arguments,2),a=function(){return e.apply(t||this,n.concat(L.call(arguments)))},a.guid=e.guid=e.guid||Q.guid++,a):void 0},now:Date.now,support:J}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){$["[object "+t+"]"]=t.toLowerCase()});var ae=function(e){function t(e,t,i,n){var a,s,o,r,l,c,u,g,p,f;if((t?t.ownerDocument||t:R)!==D&&O(t),t=t||D,i=i||[],r=t.nodeType,"string"!=typeof e||!e||1!==r&&9!==r&&11!==r)return i;if(!n&&U){if(11!==r&&(a=ve.exec(e)))if(o=a[1]){if(9===r){if(s=t.getElementById(o),!s||!s.parentNode)return i;if(s.id===o)return i.push(s),i}else if(t.ownerDocument&&(s=t.ownerDocument.getElementById(o))&&N(t,s)&&s.id===o)return i.push(s),i}else{if(a[2])return Z.apply(i,t.getElementsByTagName(e)),i;if((o=a[3])&&_.getElementsByClassName)return Z.apply(i,t.getElementsByClassName(o)),i}if(_.qsa&&(!E||!E.test(e))){if(g=u=j,p=t,f=1!==r&&e,1===r&&"object"!==t.nodeName.toLowerCase()){for(c=C(e),(u=t.getAttribute("id"))?g=u.replace(ke,"\\$&"):t.setAttribute("id",g),g="[id='"+g+"'] ",l=c.length;l--;)c[l]=g+h(c[l]);p=be.test(e)&&d(t.parentNode)||t,f=c.join(",")}if(f)try{return Z.apply(i,p.querySelectorAll(f)),i}catch(w){}finally{u||t.removeAttribute("id")}}}return S(e.replace(le,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>y.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[j]=!0,e}function a(e){var t=D.createElement("div");try{return!!e(t)}catch(i){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function s(e,t){for(var i=e.split("|"),n=e.length;n--;)y.attrHandle[i[n]]=t}function o(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||$)-(~e.sourceIndex||$);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function r(e){return function(t){var i=t.nodeName.toLowerCase();return"input"===i&&t.type===e}}function l(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}function c(e){return n(function(t){return t=+t,n(function(i,n){for(var a,s=e([],i.length,t),o=s.length;o--;)i[a=s[o]]&&(i[a]=!(n[a]=i[a]))})})}function d(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function u(){}function h(e){for(var t=0,i=e.length,n="";i>t;t++)n+=e[t].value;return n}function g(e,t,i){var n=t.dir,a=i&&"parentNode"===n,s=H++;return t.first?function(t,i,s){for(;t=t[n];)if(1===t.nodeType||a)return e(t,i,s)}:function(t,i,o){var r,l,c=[F,s];if(o){for(;t=t[n];)if((1===t.nodeType||a)&&e(t,i,o))return!0}else for(;t=t[n];)if(1===t.nodeType||a){if(l=t[j]||(t[j]={}),(r=l[n])&&r[0]===F&&r[1]===s)return c[2]=r[2];if(l[n]=c,c[2]=e(t,i,o))return!0}}}function p(e){return e.length>1?function(t,i,n){for(var a=e.length;a--;)if(!e[a](t,i,n))return!1;return!0}:e[0]}function f(e,i,n){for(var a=0,s=i.length;s>a;a++)t(e,i[a],n);return n}function w(e,t,i,n,a){for(var s,o=[],r=0,l=e.length,c=null!=t;l>r;r++)(s=e[r])&&(!i||i(s,n,a))&&(o.push(s),c&&t.push(r));return o}function m(e,t,i,a,s,o){return a&&!a[j]&&(a=m(a)),s&&!s[j]&&(s=m(s,o)),n(function(n,o,r,l){var c,d,u,h=[],g=[],p=o.length,m=n||f(t||"*",r.nodeType?[r]:r,[]),v=!e||!n&&t?m:w(m,h,e,r,l),b=i?s||(n?e:p||a)?[]:o:v;if(i&&i(v,b,r,l),a)for(c=w(b,g),a(c,[],r,l),d=c.length;d--;)(u=c[d])&&(b[g[d]]=!(v[g[d]]=u));if(n){if(s||e){if(s){for(c=[],d=b.length;d--;)(u=b[d])&&c.push(v[d]=u);s(null,b=[],c,l)}for(d=b.length;d--;)(u=b[d])&&(c=s?ee(n,u):h[d])>-1&&(n[c]=!(o[c]=u))}}else b=w(b===o?b.splice(p,b.length):b),s?s(null,o,b,l):Z.apply(o,b)})}function v(e){for(var t,i,n,a=e.length,s=y.relative[e[0].type],o=s||y.relative[" "],r=s?1:0,l=g(function(e){return e===t},o,!0),c=g(function(e){return ee(t,e)>-1},o,!0),d=[function(e,i,n){var a=!s&&(n||i!==B)||((t=i).nodeType?l(e,i,n):c(e,i,n));return t=null,a}];a>r;r++)if(i=y.relative[e[r].type])d=[g(p(d),i)];else{if(i=y.filter[e[r].type].apply(null,e[r].matches),i[j]){for(n=++r;a>n&&!y.relative[e[n].type];n++);return m(r>1&&p(d),r>1&&h(e.slice(0,r-1).concat({value:" "===e[r-2].type?"*":""})).replace(le,"$1"),i,n>r&&v(e.slice(r,n)),a>n&&v(e=e.slice(n)),a>n&&h(e))}d.push(i)}return p(d)}function b(e,i){var a=i.length>0,s=e.length>0,o=function(n,o,r,l,c){var d,u,h,g=0,p="0",f=n&&[],m=[],v=B,b=n||s&&y.find.TAG("*",c),k=F+=null==v?1:Math.random()||.1,_=b.length;for(c&&(B=o!==D&&o);p!==_&&null!=(d=b[p]);p++){if(s&&d){for(u=0;h=e[u++];)if(h(d,o,r)){l.push(d);break}c&&(F=k)}a&&((d=!h&&d)&&g--,n&&f.push(d))}if(g+=p,a&&p!==g){for(u=0;h=i[u++];)h(f,m,o,r);if(n){if(g>0)for(;p--;)f[p]||m[p]||(m[p]=J.call(l));m=w(m)}Z.apply(l,m),c&&!n&&m.length>0&&g+i.length>1&&t.uniqueSort(l)}return c&&(F=k,B=v),f};return a?n(o):o}var k,_,y,x,W,C,T,S,B,I,K,O,D,P,U,E,M,A,N,j="sizzle"+1*new Date,R=e.document,F=0,H=0,L=i(),z=i(),G=i(),V=function(e,t){return e===t&&(K=!0),0},$=1<<31,q={}.hasOwnProperty,Y=[],J=Y.pop,X=Y.push,Z=Y.push,Q=Y.slice,ee=function(e,t){for(var i=0,n=e.length;n>i;i++)if(e[i]===t)return i;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",ne="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ae=ne.replace("w","w#"),se="\\["+ie+"*("+ne+")(?:"+ie+"*([*^$|!~]?=)"+ie+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ae+"))|)"+ie+"*\\]",oe=":("+ne+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+se+")*)|.*)\\)|)",re=new RegExp(ie+"+","g"),le=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),ce=new RegExp("^"+ie+"*,"+ie+"*"),de=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),ue=new RegExp("="+ie+"*([^\\]'\"]*?)"+ie+"*\\]","g"),he=new RegExp(oe),ge=new RegExp("^"+ae+"$"),pe={ID:new RegExp("^#("+ne+")"),CLASS:new RegExp("^\\.("+ne+")"),TAG:new RegExp("^("+ne.replace("w","w*")+")"),ATTR:new RegExp("^"+se),PSEUDO:new RegExp("^"+oe),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,we=/^h\d$/i,me=/^[^{]+\{\s*\[native \w/,ve=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,ke=/'|\\/g,_e=new RegExp("\\\\([\\da-f]{1,6}"+ie+"?|("+ie+")|.)","ig"),ye=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)},xe=function(){O()};try{Z.apply(Y=Q.call(R.childNodes),R.childNodes),Y[R.childNodes.length].nodeType}catch(We){Z={apply:Y.length?function(e,t){X.apply(e,Q.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}_=t.support={},W=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},O=t.setDocument=function(e){var t,i,n=e?e.ownerDocument||e:R;return n!==D&&9===n.nodeType&&n.documentElement?(D=n,P=n.documentElement,i=n.defaultView,i&&i!==i.top&&(i.addEventListener?i.addEventListener("unload",xe,!1):i.attachEvent&&i.attachEvent("onunload",xe)),U=!W(n),_.attributes=a(function(e){return e.className="i",!e.getAttribute("className")}),_.getElementsByTagName=a(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),_.getElementsByClassName=me.test(n.getElementsByClassName),_.getById=a(function(e){return P.appendChild(e).id=j,!n.getElementsByName||!n.getElementsByName(j).length}),_.getById?(y.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&U){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},y.filter.ID=function(e){var t=e.replace(_e,ye);return function(e){return e.getAttribute("id")===t}}):(delete y.find.ID,y.filter.ID=function(e){var t=e.replace(_e,ye);return function(e){var i="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return i&&i.value===t}}),y.find.TAG=_.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):_.qsa?t.querySelectorAll(e):void 0}:function(e,t){var i,n=[],a=0,s=t.getElementsByTagName(e);if("*"===e){for(;i=s[a++];)1===i.nodeType&&n.push(i);return n}return s},y.find.CLASS=_.getElementsByClassName&&function(e,t){return U?t.getElementsByClassName(e):void 0},M=[],E=[],(_.qsa=me.test(n.querySelectorAll))&&(a(function(e){P.appendChild(e).innerHTML="<a id='"+j+"'></a><select id='"+j+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&E.push("[*^$]="+ie+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||E.push("\\["+ie+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+j+"-]").length||E.push("~="),e.querySelectorAll(":checked").length||E.push(":checked"),e.querySelectorAll("a#"+j+"+*").length||E.push(".#.+[+~]")}),a(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&E.push("name"+ie+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||E.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),E.push(",.*:")})),(_.matchesSelector=me.test(A=P.matches||P.webkitMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector||P.msMatchesSelector))&&a(function(e){_.disconnectedMatch=A.call(e,"div"),A.call(e,"[s!='']:x"),M.push("!=",oe)}),E=E.length&&new RegExp(E.join("|")),M=M.length&&new RegExp(M.join("|")),t=me.test(P.compareDocumentPosition),N=t||me.test(P.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return K=!0,0;var i=!e.compareDocumentPosition-!t.compareDocumentPosition;return i?i:(i=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&i||!_.sortDetached&&t.compareDocumentPosition(e)===i?e===n||e.ownerDocument===R&&N(R,e)?-1:t===n||t.ownerDocument===R&&N(R,t)?1:I?ee(I,e)-ee(I,t):0:4&i?-1:1)}:function(e,t){if(e===t)return K=!0,0;var i,a=0,s=e.parentNode,r=t.parentNode,l=[e],c=[t];if(!s||!r)return e===n?-1:t===n?1:s?-1:r?1:I?ee(I,e)-ee(I,t):0;if(s===r)return o(e,t);for(i=e;i=i.parentNode;)l.unshift(i);for(i=t;i=i.parentNode;)c.unshift(i);for(;l[a]===c[a];)a++;return a?o(l[a],c[a]):l[a]===R?-1:c[a]===R?1:0},n):D},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==D&&O(e),i=i.replace(ue,"='$1']"),!(!_.matchesSelector||!U||M&&M.test(i)||E&&E.test(i)))try{var n=A.call(e,i);if(n||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(a){}return t(i,D,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==D&&O(e),N(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==D&&O(e);var i=y.attrHandle[t.toLowerCase()],n=i&&q.call(y.attrHandle,t.toLowerCase())?i(e,t,!U):void 0;return void 0!==n?n:_.attributes||!U?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,a=0;if(K=!_.detectDuplicates,I=!_.sortStable&&e.slice(0),e.sort(V),K){for(;t=e[a++];)t===e[a]&&(n=i.push(a));for(;n--;)e.splice(i[n],1)}return I=null,e},x=t.getText=function(e){var t,i="",n=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=x(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[n++];)i+=x(t);return i},y=t.selectors={cacheLength:50,createPseudo:n,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(_e,ye),e[3]=(e[3]||e[4]||e[5]||"").replace(_e,ye),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[6]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":i&&he.test(i)&&(t=C(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(_e,ye).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=L[e+" "];return t||(t=new RegExp("(^|"+ie+")"+e+"("+ie+"|$)"))&&L(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(a){var s=t.attr(a,e);return null==s?"!="===i:!i||(s+="","="===i?s===n:"!="===i?s!==n:"^="===i?n&&0===s.indexOf(n):"*="===i?n&&s.indexOf(n)>-1:"$="===i?n&&s.slice(-n.length)===n:"~="===i?(" "+s.replace(re," ")+" ").indexOf(n)>-1:"|="===i&&(s===n||s.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,i,n,a){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),r="of-type"===t;return 1===n&&0===a?function(e){return!!e.parentNode}:function(t,i,l){var c,d,u,h,g,p,f=s!==o?"nextSibling":"previousSibling",w=t.parentNode,m=r&&t.nodeName.toLowerCase(),v=!l&&!r;if(w){if(s){for(;f;){for(u=t;u=u[f];)if(r?u.nodeName.toLowerCase()===m:1===u.nodeType)return!1;p=f="only"===e&&!p&&"nextSibling"}return!0}if(p=[o?w.firstChild:w.lastChild],o&&v){for(d=w[j]||(w[j]={}),c=d[e]||[],g=c[0]===F&&c[1],h=c[0]===F&&c[2],u=g&&w.childNodes[g];u=++g&&u&&u[f]||(h=g=0)||p.pop();)if(1===u.nodeType&&++h&&u===t){d[e]=[F,g,h];break}}else if(v&&(c=(t[j]||(t[j]={}))[e])&&c[0]===F)h=c[1];else for(;(u=++g&&u&&u[f]||(h=g=0)||p.pop())&&((r?u.nodeName.toLowerCase()!==m:1!==u.nodeType)||!++h||(v&&((u[j]||(u[j]={}))[e]=[F,h]),u!==t)););return h-=a,h===n||h%n===0&&h/n>=0}}},PSEUDO:function(e,i){var a,s=y.pseudos[e]||y.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return s[j]?s(i):s.length>1?(a=[e,e,"",i],y.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,a=s(e,i),o=a.length;o--;)n=ee(e,a[o]),e[n]=!(t[n]=a[o])}):function(e){return s(e,0,a)}):s}},pseudos:{not:n(function(e){var t=[],i=[],a=T(e.replace(le,"$1"));return a[j]?n(function(e,t,i,n){for(var s,o=a(e,null,n,[]),r=e.length;r--;)(s=o[r])&&(e[r]=!(t[r]=s))}):function(e,n,s){return t[0]=e,a(t,null,s,i),t[0]=null,!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return e=e.replace(_e,ye),function(t){return(t.textContent||t.innerText||x(t)).indexOf(e)>-1}}),lang:n(function(e){return ge.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(_e,ye).toLowerCase(),function(t){var i;do if(i=U?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return i=i.toLowerCase(),i===e||0===i.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===P},focus:function(e){return e===D.activeElement&&(!D.hasFocus||D.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!y.pseudos.empty(e)},header:function(e){return we.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c(function(){return[0]}),last:c(function(e,t){return[t-1]}),eq:c(function(e,t,i){return[0>i?i+t:i]}),even:c(function(e,t){for(var i=0;t>i;i+=2)e.push(i);return e}),odd:c(function(e,t){for(var i=1;t>i;i+=2)e.push(i);return e}),lt:c(function(e,t,i){for(var n=0>i?i+t:i;--n>=0;)e.push(n);return e}),gt:c(function(e,t,i){for(var n=0>i?i+t:i;++n<t;)e.push(n);return e})}},y.pseudos.nth=y.pseudos.eq;for(k in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[k]=r(k);for(k in{submit:!0,reset:!0})y.pseudos[k]=l(k);return u.prototype=y.filters=y.pseudos,y.setFilters=new u,C=t.tokenize=function(e,i){var n,a,s,o,r,l,c,d=z[e+" "];if(d)return i?0:d.slice(0);for(r=e,l=[],c=y.preFilter;r;){(!n||(a=ce.exec(r)))&&(a&&(r=r.slice(a[0].length)||r),l.push(s=[])),n=!1,(a=de.exec(r))&&(n=a.shift(),s.push({value:n,type:a[0].replace(le," ")}),r=r.slice(n.length));for(o in y.filter)!(a=pe[o].exec(r))||c[o]&&!(a=c[o](a))||(n=a.shift(),s.push({value:n,type:o,matches:a}),r=r.slice(n.length));if(!n)break}return i?r.length:r?t.error(e):z(e,l).slice(0)},T=t.compile=function(e,t){var i,n=[],a=[],s=G[e+" "];if(!s){for(t||(t=C(e)),i=t.length;i--;)s=v(t[i]),s[j]?n.push(s):a.push(s);s=G(e,b(a,n)),s.selector=e}return s},S=t.select=function(e,t,i,n){var a,s,o,r,l,c="function"==typeof e&&e,u=!n&&C(e=c.selector||e);if(i=i||[],1===u.length){if(s=u[0]=u[0].slice(0),s.length>2&&"ID"===(o=s[0]).type&&_.getById&&9===t.nodeType&&U&&y.relative[s[1].type]){if(t=(y.find.ID(o.matches[0].replace(_e,ye),t)||[])[0],!t)return i;c&&(t=t.parentNode),e=e.slice(s.shift().value.length)}for(a=pe.needsContext.test(e)?0:s.length;a--&&(o=s[a],!y.relative[r=o.type]);)if((l=y.find[r])&&(n=l(o.matches[0].replace(_e,ye),be.test(s[0].type)&&d(t.parentNode)||t))){if(s.splice(a,1),e=n.length&&h(s),!e)return Z.apply(i,n),i;break}}return(c||T(e,u))(n,t,!U,i,be.test(e)&&d(t.parentNode)||t),i},_.sortStable=j.split("").sort(V).join("")===j,_.detectDuplicates=!!K,O(),_.sortDetached=a(function(e){return 1&e.compareDocumentPosition(D.createElement("div"))}),a(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||s("type|href|height|width",function(e,t,i){return i?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),_.attributes&&a(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||s("value",function(e,t,i){return i||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),a(function(e){return null==e.getAttribute("disabled")})||s(te,function(e,t,i){var n;return i?void 0:e[t]===!0?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(e);Q.find=ae,Q.expr=ae.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=ae.uniqueSort,Q.text=ae.getText,Q.isXMLDoc=ae.isXML,
Q.contains=ae.contains;var se=Q.expr.match.needsContext,oe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,re=/^.[^:#\[\.,]*$/;Q.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?Q.find.matchesSelector(n,e)?[n]:[]:Q.find.matches(e,Q.grep(t,function(e){return 1===e.nodeType}))},Q.fn.extend({find:function(e){var t,i=this.length,n=[],a=this;if("string"!=typeof e)return this.pushStack(Q(e).filter(function(){for(t=0;i>t;t++)if(Q.contains(a[t],this))return!0}));for(t=0;i>t;t++)Q.find(e,a[t],n);return n=this.pushStack(i>1?Q.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},filter:function(e){return this.pushStack(n(this,e||[],!1))},not:function(e){return this.pushStack(n(this,e||[],!0))},is:function(e){return!!n(this,"string"==typeof e&&se.test(e)?Q(e):e||[],!1).length}});var le,ce=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,de=Q.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(i="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ce.exec(e),!i||!i[1]&&t)return!t||t.jws?(t||le).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof Q?t[0]:t,Q.merge(this,Q.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:X,!0)),oe.test(i[1])&&Q.isPlainObject(t))for(i in t)Q.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}return n=X.getElementById(i[2]),n&&n.parentNode&&(this.length=1,this[0]=n),this.context=X,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Q.isFunction(e)?"undefined"!=typeof le.ready?le.ready(e):e(Q):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))};de.prototype=Q.fn,le=Q(X);var ue=/^(?:parents|prev(?:Until|All))/,he={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(e,t,i){for(var n=[],a=void 0!==i;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&Q(e).is(i))break;n.push(e)}return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),Q.fn.extend({has:function(e){var t=Q(e,this),i=t.length;return this.filter(function(){for(var e=0;i>e;e++)if(Q.contains(this,t[e]))return!0})},closest:function(e,t){for(var i,n=0,a=this.length,s=[],o=se.test(e)||"string"!=typeof e?Q(e,t||this.context):0;a>n;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&Q.find.matchesSelector(i,e))){s.push(i);break}return this.pushStack(s.length>1?Q.unique(s):s)},index:function(e){return e?"string"==typeof e?V.call(Q(e),this[0]):V.call(this,e.jws?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Q.unique(Q.merge(this.get(),Q(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,i){return Q.dir(e,"parentNode",i)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,i){return Q.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return Q.dir(e,"previousSibling",i)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(i,n){var a=Q.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(a=Q.filter(n,a)),this.length>1&&(he[e]||Q.unique(a),ue.test(e)&&a.reverse()),this.pushStack(a)}});var ge=/\S+/g,pe={};Q.Callbacks=function(e){e="string"==typeof e?pe[e]||s(e):Q.extend({},e);var t,i,n,a,o,r,l=[],c=!e.once&&[],d=function(s){for(t=e.memory&&s,i=!0,r=a||0,a=0,o=l.length,n=!0;l&&o>r;r++)if(l[r].apply(s[0],s[1])===!1&&e.stopOnFalse){t=!1;break}n=!1,l&&(c?c.length&&d(c.shift()):t?l=[]:u.disable())},u={add:function(){if(l){var i=l.length;!function s(t){Q.each(t,function(t,i){var n=Q.type(i);"function"===n?e.unique&&u.has(i)||l.push(i):i&&i.length&&"string"!==n&&s(i)})}(arguments),n?o=l.length:t&&(a=i,d(t))}return this},remove:function(){return l&&Q.each(arguments,function(e,t){for(var i;(i=Q.inArray(t,l,i))>-1;)l.splice(i,1),n&&(o>=i&&o--,r>=i&&r--)}),this},has:function(e){return e?Q.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=c=t=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,t||u.disable(),this},locked:function(){return!c},fireWith:function(e,t){return!l||i&&!c||(t=t||[],t=[e,t.slice?t.slice():t],n?c.push(t):d(t)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!i}};return u},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(i){Q.each(t,function(t,s){var o=Q.isFunction(e[t])&&e[t];a[s[1]](function(){var e=o&&o.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[s[0]+"With"](this===n?i.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,n):n}},a={};return n.pipe=n.then,Q.each(t,function(e,s){var o=s[2],r=s[3];n[s[1]]=o.add,r&&o.add(function(){i=r},t[1^e][2].disable,t[2][2].lock),a[s[0]]=function(){return a[s[0]+"With"](this===a?n:this,arguments),this},a[s[0]+"With"]=o.fireWith}),n.promise(a),e&&e.call(a,a),a},when:function(e){var t,i,n,a=0,s=L.call(arguments),o=s.length,r=1!==o||e&&Q.isFunction(e.promise)?o:0,l=1===r?e:Q.Deferred(),c=function(e,i,n){return function(a){i[e]=this,n[e]=arguments.length>1?L.call(arguments):a,n===t?l.notifyWith(i,n):--r||l.resolveWith(i,n)}};if(o>1)for(t=new Array(o),i=new Array(o),n=new Array(o);o>a;a++)s[a]&&Q.isFunction(s[a].promise)?s[a].promise().done(c(a,n,s)).fail(l.reject).progress(c(a,i,t)):--r;return r||l.resolveWith(n,s),l.promise()}});var fe;Q.fn.ready=function(e){return Q.ready.promise().done(e),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){(e===!0?--Q.readyWait:Q.isReady)||(Q.isReady=!0,e!==!0&&--Q.readyWait>0||(fe.resolveWith(X,[Q]),Q.fn.triggerHandler&&(Q(X).triggerHandler("ready"),Q(X).off("ready"))))}}),Q.ready.promise=function(t){return fe||(fe=Q.Deferred(),"complete"===X.readyState?setTimeout(Q.ready):(X.addEventListener("DOMContentLoaded",o,!1),e.addEventListener("load",o,!1))),fe.promise(t)},Q.ready.promise();var we=Q.access=function(e,t,i,n,a,s,o){var r=0,l=e.length,c=null==i;if("object"===Q.type(i)){a=!0;for(r in i)Q.access(e,t,r,i[r],!0,s,o)}else if(void 0!==n&&(a=!0,Q.isFunction(n)||(o=!0),c&&(o?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(Q(e),i)})),t))for(;l>r;r++)t(e[r],i,o?n:n.call(e[r],r,t(e[r],i)));return a?e:c?t.call(e):l?t(e[0],i):s};Q.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},r.uid=1,r.accepts=Q.acceptData,r.prototype={key:function(e){if(!r.accepts(e))return 0;var t={},i=e[this.expando];if(!i){i=r.uid++;try{t[this.expando]={value:i},Object.defineProperties(e,t)}catch(n){t[this.expando]=i,Q.extend(e,t)}}return this.cache[i]||(this.cache[i]={}),i},set:function(e,t,i){var n,a=this.key(e),s=this.cache[a];if("string"==typeof t)s[t]=i;else if(Q.isEmptyObject(s))Q.extend(this.cache[a],t);else for(n in t)s[n]=t[n];return s},get:function(e,t){var i=this.cache[this.key(e)];return void 0===t?i:i[t]},access:function(e,t,i){var n;return void 0===t||t&&"string"==typeof t&&void 0===i?(n=this.get(e,t),void 0!==n?n:this.get(e,Q.camelCase(t))):(this.set(e,t,i),void 0!==i?i:t)},remove:function(e,t){var i,n,a,s=this.key(e),o=this.cache[s];if(void 0===t)this.cache[s]={};else{Q.isArray(t)?n=t.concat(t.map(Q.camelCase)):(a=Q.camelCase(t),t in o?n=[t,a]:(n=a,n=n in o?[n]:n.match(ge)||[])),i=n.length;for(;i--;)delete o[n[i]]}},hasData:function(e){return!Q.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var me=new r,ve=new r,be=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ke=/([A-Z])/g;Q.extend({hasData:function(e){return ve.hasData(e)||me.hasData(e)},data:function(e,t,i){return ve.access(e,t,i)},removeData:function(e,t){ve.remove(e,t)},_data:function(e,t,i){return me.access(e,t,i)},_removeData:function(e,t){me.remove(e,t)}}),Q.fn.extend({data:function(e,t){var i,n,a,s=this[0],o=s&&s.attributes;if(void 0===e){if(this.length&&(a=ve.get(s),1===s.nodeType&&!me.get(s,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&(n=o[i].name,0===n.indexOf("data-")&&(n=Q.camelCase(n.slice(5)),l(s,n,a[n])));me.set(s,"hasDataAttrs",!0)}return a}return"object"==typeof e?this.each(function(){ve.set(this,e)}):we(this,function(t){var i,n=Q.camelCase(e);if(s&&void 0===t){if(i=ve.get(s,e),void 0!==i)return i;if(i=ve.get(s,n),void 0!==i)return i;if(i=l(s,n,void 0),void 0!==i)return i}else this.each(function(){var i=ve.get(this,n);ve.set(this,n,t),-1!==e.indexOf("-")&&void 0!==i&&ve.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){ve.remove(this,e)})}}),Q.extend({queue:function(e,t,i){var n;return e?(t=(t||"fx")+"queue",n=me.get(e,t),i&&(!n||Q.isArray(i)?n=me.access(e,t,Q.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(e,t){t=t||"fx";var i=Q.queue(e,t),n=i.length,a=i.shift(),s=Q._queueHooks(e,t),o=function(){Q.dequeue(e,t)};"inprogress"===a&&(a=i.shift(),n--),a&&("fx"===t&&i.unshift("inprogress"),delete s.stop,a.call(e,o,s)),!n&&s&&s.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return me.get(e,i)||me.access(e,i,{empty:Q.Callbacks("once memory").add(function(){me.remove(e,[t+"queue",i])})})}}),Q.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?Q.queue(this[0],e):void 0===t?this:this.each(function(){var i=Q.queue(this,e,t);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,a=Q.Deferred(),s=this,o=this.length,r=function(){--n||a.resolveWith(s,[s])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)i=me.get(s[o],e+"queueHooks"),i&&i.empty&&(n++,i.empty.add(r));return r(),a.promise(t)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ye=["Top","Right","Bottom","Left"],xe=function(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)},We=/^(?:checkbox|radio)$/i;!function(){var e=X.createDocumentFragment(),t=e.appendChild(X.createElement("div")),i=X.createElement("input");i.setAttribute("type","radio"),i.setAttribute("checked","checked"),i.setAttribute("name","t"),t.appendChild(i),J.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",J.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var Ce="undefined";J.focusinBubbles="onfocusin"in e;var Te=/^key/,Se=/^(?:mouse|pointer|contextmenu)|click/,Be=/^(?:focusinfocus|focusoutblur)$/,Ie=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(e,t,i,n,a){var s,o,r,l,c,d,u,h,g,p,f,w=me.get(e);if(w)for(i.handler&&(s=i,i=s.handler,a=s.selector),i.guid||(i.guid=Q.guid++),(l=w.events)||(l=w.events={}),(o=w.handle)||(o=w.handle=function(t){return typeof Q!==Ce&&Q.event.triggered!==t.type?Q.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(ge)||[""],c=t.length;c--;)r=Ie.exec(t[c])||[],g=f=r[1],p=(r[2]||"").split(".").sort(),g&&(u=Q.event.special[g]||{},g=(a?u.delegateType:u.bindType)||g,u=Q.event.special[g]||{},d=Q.extend({type:g,origType:f,data:n,handler:i,guid:i.guid,selector:a,needsContext:a&&Q.expr.match.needsContext.test(a),namespace:p.join(".")},s),(h=l[g])||(h=l[g]=[],h.delegateCount=0,u.setup&&u.setup.call(e,n,p,o)!==!1||e.addEventListener&&e.addEventListener(g,o,!1)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=i.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),Q.event.global[g]=!0)},remove:function(e,t,i,n,a){var s,o,r,l,c,d,u,h,g,p,f,w=me.hasData(e)&&me.get(e);if(w&&(l=w.events)){for(t=(t||"").match(ge)||[""],c=t.length;c--;)if(r=Ie.exec(t[c])||[],g=f=r[1],p=(r[2]||"").split(".").sort(),g){for(u=Q.event.special[g]||{},g=(n?u.delegateType:u.bindType)||g,h=l[g]||[],r=r[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;s--;)d=h[s],!a&&f!==d.origType||i&&i.guid!==d.guid||r&&!r.test(d.namespace)||n&&n!==d.selector&&("**"!==n||!d.selector)||(h.splice(s,1),d.selector&&h.delegateCount--,u.remove&&u.remove.call(e,d));o&&!h.length&&(u.teardown&&u.teardown.call(e,p,w.handle)!==!1||Q.removeEvent(e,g,w.handle),delete l[g])}else for(g in l)Q.event.remove(e,g+t[c],i,n,!0);Q.isEmptyObject(l)&&(delete w.handle,me.remove(e,"events"))}},trigger:function(t,i,n,a){var s,o,r,l,c,d,u,h=[n||X],g=Y.call(t,"type")?t.type:t,p=Y.call(t,"namespace")?t.namespace.split("."):[];if(o=r=n=n||X,3!==n.nodeType&&8!==n.nodeType&&!Be.test(g+Q.event.triggered)&&(g.indexOf(".")>=0&&(p=g.split("."),g=p.shift(),p.sort()),c=g.indexOf(":")<0&&"on"+g,t=t[Q.expando]?t:new Q.Event(g,"object"==typeof t&&t),t.isTrigger=a?2:3,t.namespace=p.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=n),i=null==i?[t]:Q.makeArray(i,[t]),u=Q.event.special[g]||{},a||!u.trigger||u.trigger.apply(n,i)!==!1)){if(!a&&!u.noBubble&&!Q.isWindow(n)){for(l=u.delegateType||g,Be.test(l+g)||(o=o.parentNode);o;o=o.parentNode)h.push(o),r=o;r===(n.ownerDocument||X)&&h.push(r.defaultView||r.parentWindow||e)}for(s=0;(o=h[s++])&&!t.isPropagationStopped();)t.type=s>1?l:u.bindType||g,d=(me.get(o,"events")||{})[t.type]&&me.get(o,"handle"),d&&d.apply(o,i),d=c&&o[c],d&&d.apply&&Q.acceptData(o)&&(t.result=d.apply(o,i),t.result===!1&&t.preventDefault());return t.type=g,a||t.isDefaultPrevented()||u._default&&u._default.apply(h.pop(),i)!==!1||!Q.acceptData(n)||c&&Q.isFunction(n[g])&&!Q.isWindow(n)&&(r=n[c],r&&(n[c]=null),Q.event.triggered=g,n[g](),Q.event.triggered=void 0,r&&(n[c]=r)),t.result}},dispatch:function(e){e=Q.event.fix(e);var t,i,n,a,s,o=[],r=L.call(arguments),l=(me.get(this,"events")||{})[e.type]||[],c=Q.event.special[e.type]||{};if(r[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){for(o=Q.event.handlers.call(this,e,l),t=0;(a=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,i=0;(s=a.handlers[i++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,n=((Q.event.special[s.origType]||{}).handle||s.handler).apply(a.elem,r),void 0!==n&&(e.result=n)===!1&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,a,s,o=[],r=t.delegateCount,l=e.target;if(r&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(n=[],i=0;r>i;i++)s=t[i],a=s.selector+" ",void 0===n[a]&&(n[a]=s.needsContext?Q(a,this).index(l)>=0:Q.find(a,this,null,[l]).length),n[a]&&n.push(s);n.length&&o.push({elem:l,handlers:n})}return r<t.length&&o.push({elem:this,handlers:t.slice(r)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,a,s=t.button;return null==e.pageX&&null!=t.clientX&&(i=e.target.ownerDocument||X,n=i.documentElement,a=i.body,e.pageX=t.clientX+(n&&n.scrollLeft||a&&a.scrollLeft||0)-(n&&n.clientLeft||a&&a.clientLeft||0),e.pageY=t.clientY+(n&&n.scrollTop||a&&a.scrollTop||0)-(n&&n.clientTop||a&&a.clientTop||0)),e.which||void 0===s||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,i,n,a=e.type,s=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=Se.test(a)?this.mouseHooks:Te.test(a)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,e=new Q.Event(s),t=n.length;t--;)i=n[t],e[i]=s[i];return e.target||(e.target=X),3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==u()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Q.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Q.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var a=Q.extend(new Q.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?Q.event.trigger(a,null,t):Q.event.dispatch.call(t,a),a.isDefaultPrevented()&&i.preventDefault()}},Q.removeEvent=function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)},Q.Event=function(e,t){return this instanceof Q.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?c:d):this.type=e,t&&Q.extend(this,t),this.timeStamp=e&&e.timeStamp||Q.now(),void(this[Q.expando]=!0)):new Q.Event(e,t)},Q.Event.prototype={isDefaultPrevented:d,isPropagationStopped:d,isImmediatePropagationStopped:d,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=c,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=c,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=c,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,a=e.relatedTarget,s=e.handleObj;return(!a||a!==n&&!Q.contains(n,a))&&(e.type=s.origType,i=s.handler.apply(this,arguments),e.type=t),i}}}),J.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){var n=this.ownerDocument||this,a=me.access(n,t);a||n.addEventListener(e,i,!0),me.access(n,t,(a||0)+1)},teardown:function(){var n=this.ownerDocument||this,a=me.access(n,t)-1;a?me.access(n,t,a):(n.removeEventListener(e,i,!0),me.remove(n,t))}}}),Q.fn.extend({on:function(e,t,i,n,a){var s,o;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(o in e)this.on(o,t,i,e[o],a);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),n===!1)n=d;else if(!n)return this;return 1===a&&(s=n,n=function(e){return Q().off(e),s.apply(this,arguments)},n.guid=s.guid||(s.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,a;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,Q(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(a in e)this.off(a,t,e[a]);return this}return(t===!1||"function"==typeof t)&&(i=t,t=void 0),i===!1&&(i=d),this.each(function(){Q.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];return i?Q.event.trigger(e,t,i,!0):void 0}});var Ke=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Oe=/<([\w:]+)/,De=/<|&#?\w+;/,Pe=/<(?:script|style|link)/i,Ue=/checked\s*(?:[^=]|=\s*.checked.)/i,Ee=/^$|\/(?:java|ecma)script/i,Me=/^true\/(.*)/,Ae=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ne={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ne.optgroup=Ne.option,Ne.tbody=Ne.tfoot=Ne.colgroup=Ne.caption=Ne.thead,Ne.th=Ne.td,Q.extend({clone:function(e,t,i){var n,a,s,o,r=e.cloneNode(!0),l=Q.contains(e.ownerDocument,e);if(!(J.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(o=m(r),s=m(e),n=0,a=s.length;a>n;n++)v(s[n],o[n]);if(t)if(i)for(s=s||m(e),o=o||m(r),n=0,a=s.length;a>n;n++)w(s[n],o[n]);else w(e,r);return o=m(r,"script"),o.length>0&&f(o,!l&&m(e,"script")),r},buildFragment:function(e,t,i,n){for(var a,s,o,r,l,c,d=t.createDocumentFragment(),u=[],h=0,g=e.length;g>h;h++)if(a=e[h],a||0===a)if("object"===Q.type(a))Q.merge(u,a.nodeType?[a]:a);else if(De.test(a)){for(s=s||d.appendChild(t.createElement("div")),o=(Oe.exec(a)||["",""])[1].toLowerCase(),r=Ne[o]||Ne._default,s.innerHTML=r[1]+a.replace(Ke,"<$1></$2>")+r[2],c=r[0];c--;)s=s.lastChild;Q.merge(u,s.childNodes),s=d.firstChild,s.textContent=""}else u.push(t.createTextNode(a));for(d.textContent="",h=0;a=u[h++];)if((!n||-1===Q.inArray(a,n))&&(l=Q.contains(a.ownerDocument,a),s=m(d.appendChild(a),"script"),l&&f(s),i))for(c=0;a=s[c++];)Ee.test(a.type||"")&&i.push(a);return d},cleanData:function(e){for(var t,i,n,a,s=Q.event.special,o=0;void 0!==(i=e[o]);o++){if(Q.acceptData(i)&&(a=i[me.expando],a&&(t=me.cache[a]))){if(t.events)for(n in t.events)s[n]?Q.event.remove(i,n):Q.removeEvent(i,n,t.handle);me.cache[a]&&delete me.cache[a]}delete ve.cache[i[ve.expando]]}}}),Q.fn.extend({text:function(e){return we(this,function(e){return void 0===e?Q.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?Q.filter(e,this):this,a=0;null!=(i=n[a]);a++)t||1!==i.nodeType||Q.cleanData(m(i)),i.parentNode&&(t&&Q.contains(i.ownerDocument,i)&&f(m(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Q.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return we(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Pe.test(e)&&!Ne[(Oe.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Ke,"<$1></$2>");try{for(;n>i;i++)t=this[i]||{},1===t.nodeType&&(Q.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(a){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Q.cleanData(m(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=z.apply([],e);var i,n,a,s,o,r,l=0,c=this.length,d=this,u=c-1,h=e[0],f=Q.isFunction(h);if(f||c>1&&"string"==typeof h&&!J.checkClone&&Ue.test(h))return this.each(function(i){var n=d.eq(i);f&&(e[0]=h.call(this,i,n.html())),n.domManip(e,t)});if(c&&(i=Q.buildFragment(e,this[0].ownerDocument,!1,this),n=i.firstChild,1===i.childNodes.length&&(i=n),n)){for(a=Q.map(m(i,"script"),g),s=a.length;c>l;l++)o=i,l!==u&&(o=Q.clone(o,!0,!0),s&&Q.merge(a,m(o,"script"))),t.call(this[l],o,l);if(s)for(r=a[a.length-1].ownerDocument,Q.map(a,p),l=0;s>l;l++)o=a[l],Ee.test(o.type||"")&&!me.access(o,"globalEval")&&Q.contains(r,o)&&(o.src?Q._evalUrl&&Q._evalUrl(o.src):Q.globalEval(o.textContent.replace(Ae,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(e){for(var i,n=[],a=Q(e),s=a.length-1,o=0;s>=o;o++)i=o===s?this:this.clone(!0),Q(a[o])[t](i),G.apply(n,i.get());return this.pushStack(n)}});var je,Re={},Fe=/^margin/,He=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),Le=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",a.appendChild(s);var t=e.getComputedStyle(o,null);i="1%"!==t.top,n="4px"===t.width,a.removeChild(s)}var i,n,a=X.documentElement,s=X.createElement("div"),o=X.createElement("div");o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",J.clearCloneStyle="content-box"===o.style.backgroundClip,s.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",s.appendChild(o),e.getComputedStyle&&Q.extend(J,{pixelPosition:function(){return t(),i},boxSizingReliable:function(){return null==n&&t(),n},reliableMarginRight:function(){var t,i=o.appendChild(X.createElement("div"));return i.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",i.style.marginRight=i.style.width="0",o.style.width="1px",a.appendChild(s),t=!parseFloat(e.getComputedStyle(i,null).marginRight),a.removeChild(s),o.removeChild(i),t}}))}(),Q.swap=function(e,t,i,n){var a,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];a=i.apply(e,n||[]);for(s in t)e.style[s]=o[s];return a};var ze=/^(none|table(?!-c[ea]).+)/,Ge=new RegExp("^("+_e+")(.*)$","i"),Ve=new RegExp("^([+-])=("+_e+")","i"),$e={position:"absolute",visibility:"hidden",display:"block"},qe={letterSpacing:"0",fontWeight:"400"},Ye=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=_(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,s,o,r=Q.camelCase(t),l=e.style;return t=Q.cssProps[r]||(Q.cssProps[r]=x(l,r)),o=Q.cssHooks[t]||Q.cssHooks[r],void 0===i?o&&"get"in o&&void 0!==(a=o.get(e,!1,n))?a:l[t]:(s=typeof i,"string"===s&&(a=Ve.exec(i))&&(i=(a[1]+1)*a[2]+parseFloat(Q.css(e,t)),s="number"),void(null!=i&&i===i&&("number"!==s||Q.cssNumber[r]||(i+="px"),J.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),o&&"set"in o&&void 0===(i=o.set(e,i,n))||(l[t]=i))))}},css:function(e,t,i,n){var a,s,o,r=Q.camelCase(t);return t=Q.cssProps[r]||(Q.cssProps[r]=x(e.style,r)),o=Q.cssHooks[t]||Q.cssHooks[r],o&&"get"in o&&(a=o.get(e,!0,i)),void 0===a&&(a=_(e,t,n)),"normal"===a&&t in qe&&(a=qe[t]),""===i||i?(s=parseFloat(a),i===!0||Q.isNumeric(s)?s||0:a):a}}),Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,i,n){return i?ze.test(Q.css(e,"display"))&&0===e.offsetWidth?Q.swap(e,$e,function(){return T(e,t,n)}):T(e,t,n):void 0},set:function(e,i,n){var a=n&&Le(e);return W(e,i,n?C(e,t,n,"border-box"===Q.css(e,"boxSizing",!1,a),a):0)}}}),Q.cssHooks.marginRight=y(J.reliableMarginRight,function(e,t){return t?Q.swap(e,{display:"inline-block"},_,[e,"marginRight"]):void 0}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(i){for(var n=0,a={},s="string"==typeof i?i.split(" "):[i];4>n;n++)a[e+ye[n]+t]=s[n]||s[n-2]||s[0];return a}},Fe.test(e)||(Q.cssHooks[e+t].set=W)}),Q.fn.extend({css:function(e,t){return we(this,function(e,t,i){var n,a,s={},o=0;if(Q.isArray(t)){for(n=Le(e),a=t.length;a>o;o++)s[t[o]]=Q.css(e,t[o],!1,n);return s}return void 0!==i?Q.style(e,t,i):Q.css(e,t)},e,t,arguments.length>1)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){xe(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=B,B.prototype={constructor:B,init:function(e,t,i,n,a,s){this.elem=e,this.prop=i,this.easing=a||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=s||(Q.cssNumber[i]?"":"px")},cur:function(){var e=B.propHooks[this.prop];return e&&e.get?e.get(this):B.propHooks._default.get(this)},run:function(e){var t,i=B.propHooks[this.prop];return this.options.duration?this.pos=t=Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):B.propHooks._default.set(this),this}},B.prototype.init.prototype=B.prototype,B.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},B.propHooks.scrollTop=B.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.fx=B.prototype.init,Q.fx.step={};var Je,Xe,Ze=/^(?:toggle|show|hide)$/,Qe=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),et=/queueHooks$/,tt=[D],it={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),a=Qe.exec(t),s=a&&a[3]||(Q.cssNumber[e]?"":"px"),o=(Q.cssNumber[e]||"px"!==s&&+n)&&Qe.exec(Q.css(i.elem,e)),r=1,l=20;if(o&&o[3]!==s){s=s||o[3],a=a||[],o=+n||1;do r=r||".5",o/=r,Q.style(i.elem,e,o+s);while(r!==(r=i.cur()/n)&&1!==r&&--l)}return a&&(o=i.start=+o||+n||0,i.unit=s,i.end=a[1]?o+(a[1]+1)*a[2]:+a[2]),i}]};Q.Animation=Q.extend(U,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,a=e.length;a>n;n++)i=e[n],it[i]=it[i]||[],it[i].unshift(t)},prefilter:function(e,t){t?tt.unshift(e):tt.push(e)}}),Q.speed=function(e,t,i){var n=e&&"object"==typeof e?Q.extend({},e):{complete:i||!i&&t||Q.isFunction(e)&&e,duration:e,easing:i&&t||t&&!Q.isFunction(t)&&t};return n.duration=Q.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in Q.fx.speeds?Q.fx.speeds[n.duration]:Q.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){Q.isFunction(n.old)&&n.old.call(this),n.queue&&Q.dequeue(this,n.queue)},n},Q.fn.extend({fadeTo:function(e,t,i,n){return this.filter(xe).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var a=Q.isEmptyObject(e),s=Q.speed(t,i,n),o=function(){var t=U(this,Q.extend({},e),s);(a||me.get(this,"finish"))&&t.stop(!0)};return o.finish=o,a||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,a=null!=e&&e+"queueHooks",s=Q.timers,o=me.get(this);if(a)o[a]&&o[a].stop&&n(o[a]);else for(a in o)o[a]&&o[a].stop&&et.test(a)&&n(o[a]);
for(a=s.length;a--;)s[a].elem!==this||null!=e&&s[a].queue!==e||(s[a].anim.stop(i),t=!1,s.splice(a,1));(t||!i)&&Q.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,i=me.get(this),n=i[e+"queue"],a=i[e+"queueHooks"],s=Q.timers,o=n?n.length:0;for(i.finish=!0,Q.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),Q.each(["toggle","show","hide"],function(e,t){var i=Q.fn[t];Q.fn[t]=function(e,n,a){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(K(t,!0),e,n,a)}}),Q.each({slideDown:K("show"),slideUp:K("hide"),slideToggle:K("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),Q.timers=[],Q.fx.tick=function(){var e,t=0,i=Q.timers;for(Je=Q.now();t<i.length;t++)e=i[t],e()||i[t]!==e||i.splice(t--,1);i.length||Q.fx.stop(),Je=void 0},Q.fx.timer=function(e){Q.timers.push(e),e()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){Xe||(Xe=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(Xe),Xe=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e=X.createElement("input"),t=X.createElement("select"),i=t.appendChild(X.createElement("option"));e.type="checkbox",J.checkOn=""!==e.value,J.optSelected=i.selected,t.disabled=!0,J.optDisabled=!i.disabled,e=X.createElement("input"),e.value="t",e.type="radio",J.radioValue="t"===e.value}();var nt,at,st=Q.expr.attrHandle;Q.fn.extend({attr:function(e,t){return we(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})}}),Q.extend({attr:function(e,t,i){var n,a,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return typeof e.getAttribute===Ce?Q.prop(e,t,i):(1===s&&Q.isXMLDoc(e)||(t=t.toLowerCase(),n=Q.attrHooks[t]||(Q.expr.match.bool.test(t)?at:nt)),void 0===i?n&&"get"in n&&null!==(a=n.get(e,t))?a:(a=Q.find.attr(e,t),null==a?void 0:a):null!==i?n&&"set"in n&&void 0!==(a=n.set(e,i,t))?a:(e.setAttribute(t,i+""),i):void Q.removeAttr(e,t))},removeAttr:function(e,t){var i,n,a=0,s=t&&t.match(ge);if(s&&1===e.nodeType)for(;i=s[a++];)n=Q.propFix[i]||i,Q.expr.match.bool.test(i)&&(e[n]=!1),e.removeAttribute(i)},attrHooks:{type:{set:function(e,t){if(!J.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),at={set:function(e,t,i){return t===!1?Q.removeAttr(e,i):e.setAttribute(i,i),i}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(e,t){var i=st[t]||Q.find.attr;st[t]=function(e,t,n){var a,s;return n||(s=st[t],st[t]=a,a=null!=i(e,t,n)?t.toLowerCase():null,st[t]=s),a}});var ot=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(e,t){return we(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Q.propFix[e]||e]})}}),Q.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,i){var n,a,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!Q.isXMLDoc(e),s&&(t=Q.propFix[t]||t,a=Q.propHooks[t]),void 0!==i?a&&"set"in a&&void 0!==(n=a.set(e,i,t))?n:e[t]=i:a&&"get"in a&&null!==(n=a.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||ot.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),J.optSelected||(Q.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var rt=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(e){var t,i,n,a,s,o,r="string"==typeof e&&e,l=0,c=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(ge)||[];c>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(rt," "):" ")){for(s=0;a=t[s++];)n.indexOf(" "+a+" ")<0&&(n+=a+" ");o=Q.trim(n),i.className!==o&&(i.className=o)}return this},removeClass:function(e){var t,i,n,a,s,o,r=0===arguments.length||"string"==typeof e&&e,l=0,c=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(r)for(t=(e||"").match(ge)||[];c>l;l++)if(i=this[l],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(rt," "):"")){for(s=0;a=t[s++];)for(;n.indexOf(" "+a+" ")>=0;)n=n.replace(" "+a+" "," ");o=e?Q.trim(n):"",i.className!==o&&(i.className=o)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):this.each(Q.isFunction(e)?function(i){Q(this).toggleClass(e.call(this,i,this.className,t),t)}:function(){if("string"===i)for(var t,n=0,a=Q(this),s=e.match(ge)||[];t=s[n++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else(i===Ce||"boolean"===i)&&(this.className&&me.set(this,"__className__",this.className),this.className=this.className||e===!1?"":me.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(rt," ").indexOf(t)>=0)return!0;return!1}});var lt=/\r/g;Q.fn.extend({val:function(e){var t,i,n,a=this[0];return arguments.length?(n=Q.isFunction(e),this.each(function(i){var a;1===this.nodeType&&(a=n?e.call(this,i,Q(this).val()):e,null==a?a="":"number"==typeof a?a+="":Q.isArray(a)&&(a=Q.map(a,function(e){return null==e?"":e+""})),t=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))})):a?(t=Q.valHooks[a.type]||Q.valHooks[a.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(i=t.get(a,"value"))?i:(i=a.value,"string"==typeof i?i.replace(lt,""):null==i?"":i)):void 0}}),Q.extend({valHooks:{option:{get:function(e){var t=Q.find.attr(e,"value");return null!=t?t:Q.trim(Q.text(e))}},select:{get:function(e){for(var t,i,n=e.options,a=e.selectedIndex,s="select-one"===e.type||0>a,o=s?null:[],r=s?a+1:n.length,l=0>a?r:s?a:0;r>l;l++)if(i=n[l],!(!i.selected&&l!==a||(J.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&Q.nodeName(i.parentNode,"optgroup"))){if(t=Q(i).val(),s)return t;o.push(t)}return o},set:function(e,t){for(var i,n,a=e.options,s=Q.makeArray(t),o=a.length;o--;)n=a[o],(n.selected=Q.inArray(n.value,s)>=0)&&(i=!0);return i||(e.selectedIndex=-1),s}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(e,t){return Q.isArray(t)?e.checked=Q.inArray(Q(e).val(),t)>=0:void 0}},J.checkOn||(Q.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),Q.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var ct=Q.now(),dt=/\?/;Q.parseJSON=function(e){return JSON.parse(e+"")},Q.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{i=new DOMParser,t=i.parseFromString(e,"text/xml")}catch(n){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Q.error("Invalid XML: "+e),t};var ut=/#.*$/,ht=/([?&])_=[^&]*/,gt=/^(.*?):[ \t]*([^\r\n]*)$/gm,pt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,ft=/^(?:GET|HEAD)$/,wt=/^\/\//,mt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,vt={},bt={},kt="*/".concat("*"),_t=e.location.href,yt=mt.exec(_t.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_t,type:"GET",isLocal:pt.test(yt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":kt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?A(A(e,Q.ajaxSettings),t):A(Q.ajaxSettings,e)},ajaxPrefilter:E(vt),ajaxTransport:E(bt),ajax:function(e,t){function i(e,t,i,o){var l,d,m,v,k,y=t;2!==b&&(b=2,r&&clearTimeout(r),n=void 0,s=o||"",_.readyState=e>0?4:0,l=e>=200&&300>e||304===e,i&&(v=N(u,_,i)),v=j(u,v,_,l),l?(u.ifModified&&(k=_.getResponseHeader("Last-Modified"),k&&(Q.lastModified[a]=k),k=_.getResponseHeader("etag"),k&&(Q.etag[a]=k)),204===e||"HEAD"===u.type?y="nocontent":304===e?y="notmodified":(y=v.state,d=v.data,m=v.error,l=!m)):(m=y,(e||!y)&&(y="error",0>e&&(e=0))),_.status=e,_.statusText=(t||y)+"",l?p.resolveWith(h,[d,y,_]):p.rejectWith(h,[_,y,m]),_.statusCode(w),w=void 0,c&&g.trigger(l?"ajaxSuccess":"ajaxError",[_,u,l?d:m]),f.fireWith(h,[_,y]),c&&(g.trigger("ajaxComplete",[_,u]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,a,s,o,r,l,c,d,u=Q.ajaxSetup({},t),h=u.context||u,g=u.context&&(h.nodeType||h.jws)?Q(h):Q.event,p=Q.Deferred(),f=Q.Callbacks("once memory"),w=u.statusCode||{},m={},v={},b=0,k="canceled",_={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!o)for(o={};t=gt.exec(s);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?s:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return b||(e=v[i]=v[i]||e,m[e]=t),this},overrideMimeType:function(e){return b||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)w[t]=[w[t],e[t]];else _.always(e[_.status]);return this},abort:function(e){var t=e||k;return n&&n.abort(t),i(0,t),this}};if(p.promise(_).complete=f.add,_.success=_.done,_.error=_.fail,u.url=((e||u.url||_t)+"").replace(ut,"").replace(wt,yt[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=Q.trim(u.dataType||"*").toLowerCase().match(ge)||[""],null==u.crossDomain&&(l=mt.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]===yt[1]&&l[2]===yt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(yt[3]||("http:"===yt[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=Q.param(u.data,u.traditional)),M(vt,u,t,_),2===b)return _;c=Q.event&&u.global,c&&0===Q.active++&&Q.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!ft.test(u.type),a=u.url,u.hasContent||(u.data&&(a=u.url+=(dt.test(a)?"&":"?")+u.data,delete u.data),u.cache===!1&&(u.url=ht.test(a)?a.replace(ht,"$1_="+ct++):a+(dt.test(a)?"&":"?")+"_="+ct++)),u.ifModified&&(Q.lastModified[a]&&_.setRequestHeader("If-Modified-Since",Q.lastModified[a]),Q.etag[a]&&_.setRequestHeader("If-None-Match",Q.etag[a])),(u.data&&u.hasContent&&u.contentType!==!1||t.contentType)&&_.setRequestHeader("Content-Type",u.contentType),_.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+kt+"; q=0.01":""):u.accepts["*"]);for(d in u.headers)_.setRequestHeader(d,u.headers[d]);if(u.beforeSend&&(u.beforeSend.call(h,_,u)===!1||2===b))return _.abort();k="abort";for(d in{success:1,error:1,complete:1})_[d](u[d]);if(n=M(bt,u,t,_)){_.readyState=1,c&&g.trigger("ajaxSend",[_,u]),u.async&&u.timeout>0&&(r=setTimeout(function(){_.abort("timeout")},u.timeout));try{b=1,n.send(m,i)}catch(y){if(!(2>b))throw y;i(-1,y)}}else i(-1,"No Transport");return _},getJSON:function(e,t,i){return Q.get(e,t,i,"json")},getScript:function(e,t){return Q.get(e,void 0,t,"script")}}),Q.each(["get","post"],function(e,t){Q[t]=function(e,i,n,a){return Q.isFunction(i)&&(a=a||n,n=i,i=void 0),Q.ajax({url:e,type:t,dataType:a,data:i,success:n})}}),Q._evalUrl=function(e){return Q.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Q.fn.extend({wrapAll:function(e){var t;return Q.isFunction(e)?this.each(function(t){Q(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Q(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Q.isFunction(e)?function(t){Q(this).wrapInner(e.call(this,t))}:function(){var t=Q(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(i){Q(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)};var xt=/%20/g,Wt=/\[\]$/,Ct=/\r?\n/g,Tt=/^(?:submit|button|image|reset|file)$/i,St=/^(?:input|select|textarea|keygen)/i;Q.param=function(e,t){var i,n=[],a=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jws&&!Q.isPlainObject(e))Q.each(e,function(){a(this.name,this.value)});else for(i in e)R(i,e[i],t,a);return n.join("&").replace(xt,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Q.prop(this,"elements");return e?Q.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Q(this).is(":disabled")&&St.test(this.nodeName)&&!Tt.test(e)&&(this.checked||!We.test(e))}).map(function(e,t){var i=Q(this).val();return null==i?null:Q.isArray(i)?Q.map(i,function(e){return{name:t.name,value:e.replace(Ct,"\r\n")}}):{name:t.name,value:i.replace(Ct,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var Bt=0,It={},Kt={0:200,1223:204},Ot=Q.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in It)It[e]()}),J.cors=!!Ot&&"withCredentials"in Ot,J.ajax=Ot=!!Ot,Q.ajaxTransport(function(e){var t;return J.cors||Ot&&!e.crossDomain?{send:function(i,n){var a,s=e.xhr(),o=++Bt;if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(a in i)s.setRequestHeader(a,i[a]);t=function(e){return function(){t&&(delete It[o],t=s.onload=s.onerror=null,"abort"===e?s.abort():"error"===e?n(s.status,s.statusText):n(Kt[s.status]||s.status,s.statusText,"string"==typeof s.responseText?{text:s.responseText}:void 0,s.getAllResponseHeaders()))}},s.onload=t(),s.onerror=t("error"),t=It[o]=t("abort");try{s.send(e.hasContent&&e.data||null)}catch(r){if(t)throw r}},abort:function(){t&&t()}}:void 0}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var t,i;return{send:function(n,a){t=Q("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",i=function(e){t.remove(),i=null,e&&a("error"===e.type?404:200,e.type)}),X.head.appendChild(t[0])},abort:function(){i&&i()}}}});var Dt=[],Pt=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Dt.pop()||Q.expando+"_"+ct++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(t,i,n){var a,s,o,r=t.jsonp!==!1&&(Pt.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Pt.test(t.data)&&"data");return r||"jsonp"===t.dataTypes[0]?(a=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(Pt,"$1"+a):t.jsonp!==!1&&(t.url+=(dt.test(t.url)?"&":"?")+t.jsonp+"="+a),t.converters["script json"]=function(){return o||Q.error(a+" was not called"),o[0]},t.dataTypes[0]="json",s=e[a],e[a]=function(){o=arguments},n.always(function(){e[a]=s,t[a]&&(t.jsonpCallback=i.jsonpCallback,Dt.push(a)),o&&Q.isFunction(s)&&s(o[0]),o=s=void 0}),"script"):void 0}),Q.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||X;var n=oe.exec(e),a=!i&&[];return n?[t.createElement(n[1])]:(n=Q.buildFragment([e],t,a),a&&a.length&&Q(a).remove(),Q.merge([],n.childNodes))};var Ut=Q.fn.load;Q.fn.load=function(e,t,i){if("string"!=typeof e&&Ut)return Ut.apply(this,arguments);var n,a,s,o=this,r=e.indexOf(" ");return r>=0&&(n=Q.trim(e.slice(r)),e=e.slice(0,r)),Q.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(a="POST"),o.length>0&&Q.ajax({url:e,type:a,dataType:"html",data:t}).done(function(e){s=arguments,o.html(n?Q("<div>").append(Q.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){o.each(i,s||[e.responseText,t,e])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length};var Et=e.document.documentElement;Q.offset={setOffset:function(e,t,i){var n,a,s,o,r,l,c,d=Q.css(e,"position"),u=Q(e),h={};"static"===d&&(e.style.position="relative"),r=u.offset(),s=Q.css(e,"top"),l=Q.css(e,"left"),c=("absolute"===d||"fixed"===d)&&(s+l).indexOf("auto")>-1,c?(n=u.position(),o=n.top,a=n.left):(o=parseFloat(s)||0,a=parseFloat(l)||0),Q.isFunction(t)&&(t=t.call(e,i,r)),null!=t.top&&(h.top=t.top-r.top+o),null!=t.left&&(h.left=t.left-r.left+a),"using"in t?t.using.call(e,h):u.css(h)}},Q.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var t,i,n=this[0],a={top:0,left:0},s=n&&n.ownerDocument;return s?(t=s.documentElement,Q.contains(t,n)?(typeof n.getBoundingClientRect!==Ce&&(a=n.getBoundingClientRect()),i=F(s),{top:a.top+i.pageYOffset-t.clientTop,left:a.left+i.pageXOffset-t.clientLeft}):a):void 0},position:function(){if(this[0]){var e,t,i=this[0],n={top:0,left:0};return"fixed"===Q.css(i,"position")?t=i.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Q.nodeName(e[0],"html")||(n=e.offset()),n.top+=Q.css(e[0],"borderTopWidth",!0),n.left+=Q.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-Q.css(i,"marginTop",!0),left:t.left-n.left-Q.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Et;e&&!Q.nodeName(e,"html")&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||Et})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n="pageYOffset"===i;Q.fn[t]=function(a){return we(this,function(t,a,s){var o=F(t);return void 0===s?o?o[i]:t[a]:void(o?o.scrollTo(n?e.pageXOffset:s,n?s:e.pageYOffset):t[a]=s)},t,a,arguments.length,null)}}),Q.each(["top","left"],function(e,t){Q.cssHooks[t]=y(J.pixelPosition,function(e,i){return i?(i=_(e,t),He.test(i)?Q(e).position()[t]+"px":i):void 0})}),Q.each({Height:"height",Width:"width"},function(e,t){Q.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){Q.fn[n]=function(n,a){var s=arguments.length&&(i||"boolean"!=typeof n),o=i||(n===!0||a===!0?"margin":"border");return we(this,function(t,i,n){var a;return Q.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===n?Q.css(t,i,o):Q.style(t,i,n,o)},t,s?n:void 0,s,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jws",[],function(){return Q});var Mt=e.jWS,At=e.$;return Q.noConflict=function(t){return e.$===Q&&(e.$=At),t&&e.jWS===Q&&(e.jWS=Mt),Q},typeof t===Ce&&(e.jWS=Q),Q}),function(e){void 0==e.fn.inputmask&&(e.inputmask={defaults:{placeholder:"_",optionalmarker:{start:"[",end:"]"},escapeChar:"\\",mask:null,oncomplete:e.noop,onincomplete:e.noop,oncleared:e.noop,repeat:0,greedy:!0,autoUnmask:!1,clearMaskOnLostFocus:!0,insertMode:!0,clearIncomplete:!1,aliases:{},onKeyUp:e.noop,onKeyDown:e.noop,showMaskOnHover:!0,numericInput:!1,radixPoint:".",definitions:{9:{validator:"[0-9]",cardinality:1},a:{validator:"[A-Za-z-]",cardinality:1},"*":{validator:"[A-Za-z-0-9]",cardinality:1}},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91},ignorables:[8,9,13,16,17,18,20,27,33,34,35,36,37,38,39,40,46,91,93,108]},val:e.fn.val},e.fn.inputmask=function(t,i){function n(e){var t=document.createElement("input"),e="on"+e,i=e in t;return i||(t.setAttribute(e,"return;"),i="function"==typeof t[e]),t=null,i}function a(t){var n=S.aliases[t];return!!n&&(n.alias&&a(n.alias),e.extend(!0,S,n),e.extend(!0,S,i),!0)}function s(){var t=!1,i=0;1==S.mask.length&&0==S.greedy&&(S.placeholder="");for(var n=e.map(S.mask.split(""),function(e,n){var a=[];if(e==S.escapeChar)t=!0;else if(e!=S.optionalmarker.start&&e!=S.optionalmarker.end||t){var s=S.definitions[e];if(s&&!t)for(var o=0;o<s.cardinality;o++)a.push(d(i+o));else a.push(e),t=!1;return i+=a.length,a}}),a=n.slice(),s=1;s<S.repeat&&S.greedy;s++)a=a.concat(n.slice());return a}function o(){var t=!1,i=!1,n=!1;return e.map(S.mask.split(""),function(e,a){var s=[];if(e==S.escapeChar)i=!0;else if(e!=S.optionalmarker.start||i){if(e!=S.optionalmarker.end||i){var o=S.definitions[e];if(o&&!i){for(var r=o.prevalidator,l=r?r.length:0,c=1;c<o.cardinality;c++){var d=l>=c?r[c-1]:[],u=d.validator,h=d.cardinality;s.push({fn:u?"string"==typeof u?new RegExp(u):new function(){this.test=u}:new RegExp("."),cardinality:h?h:1,optionality:t,newBlockMarker:1==t&&n,offset:0,casing:o.casing,def:e}),1==t&&(n=!1)}s.push({fn:o.validator?"string"==typeof o.validator?new RegExp(o.validator):new function(){this.test=o.validator}:new RegExp("."),cardinality:o.cardinality,optionality:t,newBlockMarker:n,offset:0,casing:o.casing,def:e})}else s.push({fn:null,cardinality:0,optionality:t,newBlockMarker:n,offset:0,casing:null,def:e}),i=!1;return n=!1,s}t=!1,n=!0}else t=!0,n=!0})}function r(e,t,i,n){if(e<0||e>=u())return!1;for(var a=c(e),s=t?1:0,o="",r=U[a].cardinality;r>s;r--)o+=f(i,a-(r-1));return t&&(o+=t),null!=U[a].fn&&U[a].fn.test(o,i,e,n,S)}function l(e){var t=c(e),i=U[t];return void 0!=i&&i.fn}function c(e){return e%U.length}function d(e){return S.placeholder.charAt(e%S.placeholder.length)}function u(){var e=P.length;return!S.greedy&&S.repeat>1&&(e+=P.length*(S.repeat-1)),e}function h(e,t){var i=u();if(t>=i)return i;for(var n=t;++n<i&&!l(n););return n}function g(e,t){var i=t;if(i<=0)return 0;for(;--i>0&&!l(i););return i}function p(e,t,i){var n=U[c(t)],a=i;if(void 0!=a)switch(n.casing){case"upper":a=i.toUpperCase();break;case"lower":a=i.toLowerCase()}e[t]=a}function f(e,t,i){return i&&(t=w(e,t)),e[t]}function w(e,t,i){var n;if(i)for(;t<0&&e.length<u();)for(n=P.length-1,t=P.length;void 0!==P[n];)e.unshift(P[n--]);else for(;void 0==e[t]&&e.length<u();)for(n=0;void 0!==P[n];)e.push(P[n++]);return t}function m(e,t,i){e._valueSet(t.join("")),void 0!=i&&(K?setTimeout(function(){C(e,i)},100):C(e,i))}function v(e,t,i){for(var n=t,a=u();n<i&&n<a;n++)p(e,n,f(P.slice(),n))}function b(e,t){var i=c(t);p(e,t,f(P,i))}function k(t,i,n,a){var s=e(t).data("inputmask").isRTL,o=y(t._valueGet(),s).split("");if(s){var g=u(),w=o.reverse();w.length=g;for(var k=0;k<g;k++){var _=c(g-(k+1));null==U[_].fn&&w[k]!=f(P,_)?(w.splice(k,0,f(P,_)),w.length=g):w[k]=w[k]||f(P,_)}o=w.reverse()}v(i,0,i.length),i.length=P.length;for(var x,W=-1,C=-1,g=u(),T=o.length,B=0==T?g:-1,k=0;k<T;k++)for(var I=C+1;I<g;I++){if(l(I)){var K=o[k];(x=r(I,K,i,!n))!==!1?(x!==!0&&(I=x.pos||I,K=x.c||K),p(i,I,K),W=C=I):(b(i,I),K==d(I)&&(C=I,B=I));break}if(b(i,I),W==C&&(W=I),C=I,o[k]==f(i,I))break}if(0==S.greedy)for(var O=y(i.join(""),s).split("");i.length!=O.length;)s?i.shift():i.pop();return n&&m(t,i),s?S.numericInput?e.inArray(S.radixPoint,i)!=-1&&a!==!0?e.inArray(S.radixPoint,i):h(i,g):h(i,B):h(i,W)}function _(e){var t=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];return e.replace(new RegExp("(\\"+t.join("|\\")+")","gim"),"\\$1")}function y(e,t){return t?e.replace(new RegExp("^("+_(P.join(""))+")*"),""):e.replace(new RegExp("("+_(P.join(""))+")*$"),"")}function x(t,i){k(t,i,!1);var n=i.slice();if(e(t).data("inputmask").isRTL)for(var a=0;a<=n.length-1;a++){var s=c(a);if(!U[s].optionality)break;if(d(a)!=i[a]&&l(a))break;n.splice(0,1)}else for(var a=n.length-1;a>=0;a--){var s=c(a);if(!U[s].optionality)break;if(d(a)!=i[a]&&l(a))break;n.pop()}m(t,n)}function W(t,i){var n=t[0];if(!U||i!==!0&&t.hasClass("hasDatepicker"))return n._valueGet();var a=P.slice();return k(n,a),e.map(a,function(e,t){return l(t)&&e!=f(P.slice(),t)?e:null}).join("")}function C(e,t,i){var n=e.jws&&e.length>0?e[0]:e;if("number"!=typeof t){var a=K?s:null,s=null;if(null==a){if(n.setSelectionRange)t=n.selectionStart,i=n.selectionEnd;else if(document.selection&&document.selection.createRange){var o=document.selection.createRange();t=0-o.duplicate().moveStart("character",-1e5),i=t+o.text.length}a={begin:t,end:i}}return a}if(i="number"==typeof i?i:t,0==S.insertMode&&t==i&&i++,n.setSelectionRange)n.setSelectionRange(t,i);else if(n.createTextRange){var o=n.createTextRange();o.collapse(!0),o.moveEnd("character",i),o.moveStart("character",t),o.select()}n.focus(),K&&i!=n.selectionEnd&&(s={begin:t,end:i})}function T(t){function i(e){for(var t=!0,i=e._valueGet(),n=i.length,a=0;a<n;a++)if(l(a)&&i.charAt(a)==d(a)){t=!1;break}return t}function n(t){var i=e._data(t).events;e.each(i,function(i,n){e(t).bind(i+".inputmask",function(e){if(this.readOnly||this.disabled)return e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault(),!1});for(var a=n[n.length-1],s=n.length-1;s>0;s--)n[s]=n[s-1];n[0]=a})}function a(t){var i;Object.getOwnPropertyDescriptor&&(i=Object.getOwnPropertyDescriptor(t,"value")),i&&i.get?t._valueGet||(t._valueGet=i.get,t._valueSet=i.set,Object.defineProperty(t,"value",{get:function(){var t=e(this),i=e(this).data("inputmask");return i&&i.autoUnmask?t.inputmask("unmaskedvalue"):this._valueGet()!=i._buffer.join("")?this._valueGet():""},set:function(t){this._valueSet(t),e(this).triggerHandler("setvalue.inputmask")}})):document.__lookupGetter__&&t.__lookupGetter__("value")?t._valueGet||(t._valueGet=t.__lookupGetter__("value"),t._valueSet=t.__lookupSetter__("value"),t.__defineGetter__("value",function(){var t=e(this),i=e(this).data("inputmask");return i&&i.autoUnmask?t.inputmask("unmaskedvalue"):this._valueGet()!=i._buffer.join("")?this._valueGet():""}),t.__defineSetter__("value",function(t){this._valueSet(t),e(this).triggerHandler("setvalue.inputmask")})):(t._valueGet||(t._valueGet=function(){return this.value},t._valueSet=function(e){this.value=e}),1!=e.fn.val.inputmaskpatch&&(e.fn.val=function(){if(0==arguments.length){var t=e(this);if(t.data("inputmask")){if(t.data("inputmask").autoUnmask)return t.inputmask("unmaskedvalue");var i=e.inputmask.val.apply(t);return i!=t.data("inputmask")._buffer.join("")?i:""}return e.inputmask.val.apply(t)}var n=arguments;return this.each(function(){var t=e(this),i=e.inputmask.val.apply(t,n);return t.data("inputmask")&&t.triggerHandler("setvalue.inputmask"),i})},e.extend(e.fn.val,{inputmaskpatch:!0})))}function s(e,t,i){for(;!l(e)&&e-1>=0;)e--;for(var n=e;n<t&&n<u();n++)if(l(n)){b(E,n);var a=h(E,n),s=f(E,a);if(s!=d(a)){if(a<u()&&r(n,s,E,!0)!==!1&&U[c(n)].def==U[c(a)].def)p(E,n,f(E,a)),b(E,a);else if(l(n))break}else if(void 0==i)break}else b(E,n);return void 0!=i&&p(E,F?t:g(E,t),i),E=y(E.join(""),F).split(""),0==E.length&&(E=P.slice()),e}function o(e,t,i,n){for(var a=e;a<=t&&a<u();a++)if(l(a)){var s=f(E,a);if(p(E,a,i),s!=d(a)){var o=h(E,a);if(!(o<u()))break;if(r(o,s,E,!0)!==!1&&U[c(a)].def==U[c(o)].def)i=s;else{if(l(o))break;i=s}}else if(n!==!0)break}else b(E,a);var g=E.length;return E=y(E.join(""),F).split(""),0==E.length&&(E=P.slice()),t-(g-E.length)}function _(t){A=!1;var i=this,n=t.keyCode,a=C(i);if(S.numericInput){var r=i._valueGet(),l=r.indexOf(S.radixPoint);l!=-1&&(F=a.begin<=l||a.end<=l)}if(n==S.keyCode.BACKSPACE||n==S.keyCode.DELETE||I&&127==n){var c=u();if(0==a.begin&&a.end==c)E=P.slice(),m(i,E),C(i,k(i,E,!1));else if(a.end-a.begin>1||a.end-a.begin==1&&S.insertMode)v(E,a.begin,a.end),m(i,E,F?k(i,E,!1):a.begin);else{var g=a.begin-(n==S.keyCode.DELETE?0:1);g<R&&n==S.keyCode.DELETE&&(g=R),g>=R&&(S.numericInput&&S.greedy&&n==S.keyCode.DELETE&&E[g]==S.radixPoint&&(g=h(E,g),F=!1),F?(g=o(R,g,d(g),!0),g=S.numericInput&&S.greedy&&n==S.keyCode.BACKSPACE&&E[g+1]==S.radixPoint?g+1:h(E,g)):g=s(g,c),m(i,E,g))}return i._valueGet()==P.join("")&&e(i).trigger("cleared"),!1}if(n==S.keyCode.END||n==S.keyCode.PAGE_DOWN)return setTimeout(function(){var e=k(i,E,!1,!0);S.insertMode||e!=u()||t.shiftKey||e--,C(i,t.shiftKey?a.begin:e,e)},0),!1;if(n==S.keyCode.HOME||n==S.keyCode.PAGE_UP)return C(i,0,t.shiftKey?a.begin:0),!1;if(n==S.keyCode.ESCAPE)return i._valueSet(M),C(i,0,k(i,E)),!1;if(n==S.keyCode.INSERT)return S.insertMode=!S.insertMode,C(i,S.insertMode||a.begin!=u()?a.begin:a.begin-1),!1;if(t.ctrlKey&&88==n)setTimeout(function(){C(i,k(i,E,!0))},0);else if(!S.insertMode){if(n==S.keyCode.RIGHT){var p=a.begin==a.end?a.end+1:a.end;return p=p<u()?p:a.end,C(i,t.shiftKey?a.begin:p,t.shiftKey?p+1:p),!1}if(n==S.keyCode.LEFT){var p=a.begin-1;return p=p>0?p:0,C(i,p,t.shiftKey?a.end:p),!1}}S.onKeyDown.call(this,t,S),N=e.inArray(n,S.ignorables)!=-1}function W(t){if(A)return!1;A=!0;var n=this,a=e(n);t=t||window.event;var l=t.which||t.charCode||t.keyCode;if(S.numericInput&&l==S.radixPoint.charCodeAt(S.radixPoint.length-1)){var c=n._valueGet(),b=c.indexOf(S.radixPoint);C(n,h(E,b!=-1?b:u()))}if(t.ctrlKey||t.altKey||t.metaKey||N)return!0;if(l){a.trigger("input");var k=C(n),_=String.fromCharCode(l),y=u();if(v(E,k.begin,k.end),F){var x,W=S.numericInput?k.end:g(E,k.end);if((x=r(W==y||f(E,W)==S.radixPoint?g(E,W):W,_,E,!1))!==!1){x!==!0&&(W=x.pos||k,_=x.c||_);var T=R;if(1==S.insertMode){if(1==S.greedy)for(var B=E.slice();f(B,T,!0)!=d(T)&&T<=W;)T=T==y?y+1:h(E,T);if(!(T<=W&&(S.greedy||E.length<y)))return!1;if(E[R]!=d(R)&&E.length<y){var I=w(E,-1,F);0!=k.end&&(W+=I),y=E.length}s(T,S.numericInput?g(E,W):W,_)}else p(E,S.numericInput?g(E,W):W,_);m(n,E,S.numericInput&&0==W?h(E,W):W),setTimeout(function(){i(n)&&a.trigger("complete")},0)}else K&&m(n,E,k.begin)}else{var x,W=h(E,k.begin-1);if(w(E,W,F),(x=r(W,_,E,!1))!==!1){if(x!==!0&&(W=x.pos||W,_=x.c||_),1==S.insertMode){for(var O=u(),B=E.slice();f(B,O,!0)!=d(O)&&O>=W;)O=0==O?-1:g(E,O);if(!(O>=W))return!1;o(W,E.length,_)}else p(E,W,_);var D=h(E,W);m(n,E,D),setTimeout(function(){i(n)&&a.trigger("complete")},0)}else K&&m(n,E,k.begin)}return!1}}function T(t){var i=e(this),n=this,a=t.keyCode;S.onKeyUp.call(this,t,S),a==S.keyCode.TAB&&i.hasClass("focus.inputmask")&&0==n._valueGet().length&&(E=P.slice(),m(n,E),F||C(n,0),M=n._valueGet())}var O=e(t);if(O.is(":input")){S.greedy=S.greedy?S.greedy:0==S.repeat;var D=O.prop("maxLength");u()>D&&D>-1&&(D<P.length&&(P.length=D),0==S.greedy&&(S.repeat=Math.round(D/P.length))),
O.prop("maxLength",2*u()),O.data("inputmask",{tests:U,_buffer:P,greedy:S.greedy,repeat:S.repeat,autoUnmask:S.autoUnmask,definitions:S.definitions,isRTL:!1}),a(t);var E=P.slice(),M=t._valueGet(),A=!1,N=!1,j=-1,R=h(E,-1),F=(g(E,u()),!1);if("rtl"==t.dir||S.numericInput){t.dir="ltr",O.css("text-align","right"),O.removeAttr("dir");var H=O.data("inputmask");H.isRTL=!0,O.data("inputmask",H),F=!0}O.unbind(".inputmask"),O.removeClass("focus.inputmask"),O.bind("mouseenter.inputmask",function(){var t=e(this),i=this;if(!t.hasClass("focus.inputmask")&&S.showMaskOnHover){var n=i._valueGet().length;n<E.length&&(0==n&&(E=P.slice()),m(i,E))}}).bind("blur.inputmask",function(){var t=e(this),n=this,a=n._valueGet();t.removeClass("focus.inputmask"),a!=M&&t.change(),S.clearMaskOnLostFocus&&(a==P.join("")?n._valueSet(""):x(n,E)),i(n)||(t.trigger("incomplete"),S.clearIncomplete&&(S.clearMaskOnLostFocus?n._valueSet(""):(E=P.slice(),m(n,E))))}).bind("focus.inputmask",function(){var t=e(this),i=this;if(!t.hasClass("focus.inputmask")&&!S.showMaskOnHover){var n=i._valueGet().length;n<E.length&&(0==n&&(E=P.slice()),C(i,k(i,E,!0)))}t.addClass("focus.inputmask"),M=i._valueGet()}).bind("mouseleave.inputmask",function(){var t=e(this),i=this;S.clearMaskOnLostFocus&&(t.hasClass("focus.inputmask")||(i._valueGet()==P.join("")||""==i._valueGet()?i._valueSet(""):x(i,E)))}).bind("click.inputmask",function(){var e=this;setTimeout(function(){var t=C(e);if(t.begin==t.end){var i=t.begin;j=k(e,E,!1),F?C(e,i>j&&(r(i,E[i],E,!0)!==!1||!l(i))?i:j):C(e,i<j&&(r(i,E[i],E,!0)!==!1||!l(i))?i:j)}},0)}).bind("dblclick.inputmask",function(){var e=this;setTimeout(function(){C(e,0,j)},0)}).bind("keydown.inputmask",_).bind("keypress.inputmask",W).bind("keyup.inputmask",T).bind(B+".inputmask, dragdrop.inputmask, drop.inputmask",function(){var e=this;setTimeout(function(){C(e,k(e,E,!0))},0)}).bind("setvalue.inputmask",function(){var e=this;M=e._valueGet(),k(e,E,!0),e._valueGet()==P.join("")&&e._valueSet("")}).bind("complete.inputmask",S.oncomplete).bind("incomplete.inputmask",S.onincomplete).bind("cleared.inputmask",S.oncleared),j=k(t,E,!0);var L;try{L=document.activeElement}catch(z){}L===t?(O.addClass("focus.inputmask"),C(t,j)):S.clearMaskOnLostFocus&&(t._valueGet()==P.join("")?t._valueSet(""):x(t,E)),n(t)}}var S=e.extend(!0,{},e.inputmask.defaults,i),B=n("paste")?"paste":"input",I=null!=navigator.userAgent.match(/iphone/i),K=null!=navigator.userAgent.match(/android.*mobile safari.*/i);if(K){var O=navigator.userAgent.match(/mobile safari.*/i),D=parseInt(new RegExp(/[0-9]+/).exec(O));K=D<=533}if("string"==typeof t)switch(t){case"mask":var P=s(),U=o();return this.each(function(){T(this)});case"unmaskedvalue":var U=this.data("inputmask").tests,P=this.data("inputmask")._buffer;return S.greedy=this.data("inputmask").greedy,S.repeat=this.data("inputmask").repeat,S.definitions=this.data("inputmask").definitions,W(this);case"remove":var U,P;return this.each(function(){var t=e(this),i=this;setTimeout(function(){if(t.data("inputmask")){U=t.data("inputmask").tests,P=t.data("inputmask")._buffer,S.greedy=t.data("inputmask").greedy,S.repeat=t.data("inputmask").repeat,S.definitions=t.data("inputmask").definitions,i._valueSet(W(t,!0)),t.removeData("inputmask"),t.unbind(".inputmask"),t.removeClass("focus.inputmask");var e;Object.getOwnPropertyDescriptor&&(e=Object.getOwnPropertyDescriptor(i,"value")),e&&e.get?i._valueGet&&Object.defineProperty(i,"value",{get:i._valueGet,set:i._valueSet}):document.__lookupGetter__&&i.__lookupGetter__("value")&&i._valueGet&&(i.__defineGetter__("value",i._valueGet),i.__defineSetter__("value",i._valueSet)),delete i._valueGet,delete i._valueSet}},0)});case"getemptymask":return this.data("inputmask")?this.data("inputmask")._buffer.join(""):"";case"hasMaskedValue":return!!this.data("inputmask")&&!this.data("inputmask").autoUnmask;default:a(t)||(S.mask=t);var P=s(),U=o();return this.each(function(){T(this)})}if("object"==typeof t){S=e.extend(!0,{},e.inputmask.defaults,t),a(S.alias);var P=s(),U=o();return this.each(function(){T(this)})}})}(jWS),function(e){function t(t){return l?t.data("events"):e._data(t[0]).events}function i(e,i,n){var a=t(e),s=a[i];if(!l){var o=n?s.splice(s.delegateCount-1,1)[0]:s.pop();return void s.splice(n?0:s.delegateCount||0,0,o)}n?a.live.unshift(a.live.pop()):s.unshift(s.pop())}function n(t,n,a){var s=n.split(/\s+/);t.each(function(){for(var t=0;s.length>t;++t){var n=e.trim(s[t]).match(/[^\.]+/i)[0];i(e(this),n,a)}})}function a(t){e.fn[t+"First"]=function(){var i=e.makeArray(arguments),a=i.shift();return a&&(e.fn[t].apply(this,arguments),n(this,a)),this}}var s=e.fn.jws.split("."),o=parseInt(s[0]),r=parseInt(s[1]),l=1>o||1==o&&7>r;a("bind"),a("one"),e.fn.delegateFirst=function(){var t=e.makeArray(arguments),i=t[1];return i&&(t.splice(0,2),e.fn.delegate.apply(this,arguments),n(this,i,!0)),this},e.fn.liveFirst=function(){var t=e.makeArray(arguments);return t.unshift(this.selector),e.fn.delegateFirst.apply(e(document),t),this},l||(e.fn.onFirst=function(t,i){var a=e(this),s="string"==typeof i;if(e.fn.on.apply(a,arguments),"object"==typeof t)for(type in t)t.hasOwnProperty(type)&&n(a,type,s);else"string"==typeof t&&n(a,t,s);return a})}(jWS),function(e){e.masksLoad=function(t){var i;return e.ajax({url:t,async:!1,dataType:"json",success:function(e){i=e}}),i},e.masksSort=function(t,i,n,a){return t.sort(function(t,s){for(var o=0,r=0;o<t[a].length&&r<s[a].length;){var l=t[a].charAt(o),c=s[a].charAt(r);if(n.test(l))if(n.test(c)){if(e.inArray(l,i)!=-1&&e.inArray(c,i)==-1)return 1;if(e.inArray(l,i)==-1&&e.inArray(c,i)!=-1)return-1;if(e.inArray(l,i)==-1&&e.inArray(c,i)==-1&&l!=c)return l<c?-1:1;o++,r++}else r++;else o++}for(;o<t[a].length||r<s[a].length;)if(o<t[a].length&&!n.test(t[a].charAt(o)))o++;else if(r<s[a].length&&!n.test(s[a].charAt(r)))r++;else{if(o<t[a].length)return 1;if(r<s[a].length)return-1}return 0}),t},e.fn.inputmasks=function(t,i){var n=function(e,t){if("number"!=typeof e){if(this.setSelectionRange)e=this.selectionStart,t=this.selectionEnd;else if(document.selection&&document.selection.createRange){var i=document.selection.createRange();e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length}return{begin:e,end:t}}if(t="number"==typeof t?t:e,this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e),i.select()}},a=Object.keys||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var i in e)t[t.length]=i;return t};t=e.extend(!0,{onMaskChange:e.noop},t);var s={};for(var o in t.inputmask.definitions){var r=t.inputmask.definitions[o].validator;switch(typeof r){case"string":s[o]=new RegExp(r);break;case"object":"test"in t.definitions[o].validator&&(s[o]=r);break;case"function":s[o]={test:r}}}t.inputmask.definitions[t.replace]={validator:t.match.source,cardinality:1};var l=null!=navigator.userAgent.match(/iphone/i),c=!1,d=e.extend(!0,{},e.inputmask.defaults,t.inputmask).placeholder,u=e.extend(!0,{},e.inputmask.defaults,t.inputmask).insertMode,h=function(e){for(var i="",n=0;n<e.length;n++){var o=e.charAt(n);if(o==d)break;t.match.test(o)&&(i+=o)}for(var r in t.list){var l=t.list[r][t.listKey],c=!0;if("string"!=typeof l)return!1;for(var u=0,h=0;u<i.length&&h<l.length;){var g=l.charAt(h),p=i.charAt(u);if(t.match.test(g)||g in s){if(!(g in s&&s[g].test(p)||p==g)){c=!1;break}u++,h++}else h++}if(c&&u==i.length){var f=l.substr(h).search(t.match)==-1;l=l.replace(new RegExp([t.match.source].concat(a(s)).join("|"),"g"),t.replace);var w=l.substr(h).search(t.replace)==-1;return{mask:l,obj:t.list[r],determined:f,completed:w}}}return!1},g=function(e,i,n){if(!e)return 0;for(var a=0,s=0;a<n.begin;a++)e.charAt(a)==t.replace&&s++;for(var o=0;a<n.end;a++)e.charAt(a)==t.replace&&o++;for(a=0;a<i.length&&(s>0||i.charAt(a)!=t.replace);a++)i.charAt(a)==t.replace&&s--;for(s=a;a<i.length&&o>0;a++)i.charAt(a)==t.replace&&o--;return o=a,{begin:s,end:o}},p=function(){e(this).unbind("keypress.inputmask",b).unbind("input.inputmask",x).unbind("paste.inputmask",x).unbind("dragdrop.inputmask",x).unbind("drop.inputmask",x).unbind("keydown.inputmask",v).unbind("setvalue.inputmask",_).unbind("blur.inputmask",k)},f=function(){p.call(this),e(this).bindFirst("keypress.inputmask",b).bindFirst("input.inputmask",x).bindFirst("paste.inputmask",x).bindFirst("dragdrop.inputmask",x).bindFirst("drop.inputmask",x).bindFirst("keydown.inputmask",v).bindFirst("setvalue.inputmask",_).bind("blur.inputmask",k)},w=function(i,a){if(i&&(a||i.mask!=c.mask)){var s;a||(s=g(c.mask,i.mask,n.call(this))),a&&(this._valueSet?this._valueSet(a):this.value=a),e(this).inputmask(i.mask,e.extend(!0,t.inputmask,{insertMode:u})),a||n.call(this,s.begin,s.end)}return c=i,t.onMaskChange.call(this,i.obj,i.determined),!0},m=function(t,i,n){var a=h(i);return!(!a||a.obj!=c.obj||a.determined!=c.determined)||(a&&(p.call(this),n?(w.call(this,a),e(this).trigger(t)):(e(this).trigger(t),w.call(this,a)),f.call(this)),t.stopImmediatePropagation(),!1)},v=function(e){e=e||window.event;var i=e.which||e.charCode||e.keyCode;if(8==i||46==i||l&&127==i){var a=this._valueGet(),s=n.call(this);if(s.begin==s.end||!u&&s.begin==s.end-1){var o=s.begin;do{46!=i&&o--;var r=a.charAt(o);a=a.substring(0,o)+a.substring(o+1)}while(o>0&&o<a.length&&r!=d&&!t.match.test(r))}else{var c=a.substring(0,s.begin)+a.substring(s.end);c.search(t.match)==-1&&(a=c)}return m.call(this,e,a,!1)}return 45==i&&(u=!u),!0},b=function(e){var t=this._valueGet();e=e||window.event;var i=e.which||e.charCode||e.keyCode,a=String.fromCharCode(i);return caretPos=n.call(this),t=t.substring(0,caretPos.begin)+a+t.substring(caretPos.end),m.call(this,e,t,!0)},k=function(e){var t=h(this._valueGet());return w.call(this,t),f.call(this),!0},_=function(e){return y.call(this),e.stopImmediatePropagation(),!0},y=function(){var e;e=this._valueGet?this._valueGet():this.value;for(var t=h(e);!t&&e.length>0;)e=e.substr(0,e.length-1),t=h(e);w.call(this,t,e),f.call(this)},x=function(e){var t=this;return setTimeout(function(){y.call(t)},0),e.stopImmediatePropagation(),!0};switch(i){case"isCompleted":var W=h(this[0]._valueGet&&this[0]._valueGet()||this[0].value);return W&&W.completed;default:return this.each(function(){y.call(this)}),this}}}(jWS),function(e){return e(jWS,window,document)}(function(e,t,i){"use strict";var n,a,s,o,r,l,c,d,u,h,g,p,f,w,m,v,b,k,_,y,x,W,C,T,S,B,I,K,O,D,P;C={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null},k="scrollbar",b="scroll",u="mousedown",h="mouseenter",g="mousemove",f="mousewheel",p="mouseup",v="resize",r="drag",l="enter",y="up",m="panedown",s="DOMMouseScroll",o="down",x="wheel",c="keydown",d="keyup",_="touchmove",n="Microsoft Internet Explorer"===t.navigator.appName&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject,a=null,I=t.requestAnimationFrame,W=t.cancelAnimationFrame,O=i.createElement("div").style,P=function(){var e,t,i,n,a,s;for(n=["t","webkitT","MozT","msT","OT"],e=a=0,s=n.length;a<s;e=++a)if(i=n[e],t=n[e]+"ransform",t in O)return n[e].substr(0,n[e].length-1);return!1}(),D=function(e){return P!==!1&&(""===P?e:P+e.charAt(0).toUpperCase()+e.substr(1))},K=D("transform"),S=K!==!1,T=function(){var e,t,n;return e=i.createElement("div"),t=e.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=b,t.top="-9999px",i.body.appendChild(e),n=e.offsetWidth-e.clientWidth,i.body.removeChild(e),n},B=function(){var e,i,n;return i=t.navigator.userAgent,!!(e=/(?=.+Mac OS X)(?=.+Firefox)/.test(i))&&(n=/Firefox\/\d{2}\./.exec(i),n&&(n=n[0].replace(/\D+/g,"")),e&&+n>23)},w=function(){function c(n,s){this.el=n,this.options=s,a||(a=T()),this.$el=e(this.el),this.doc=e(this.options.documentContext||i),this.win=e(this.options.windowContext||t),this.body=this.doc.find("body"),this.$content=this.$el.children("."+s.contentClass),this.$content.attr("tabindex",this.options.tabIndex||0),this.content=this.$content[0],this.previousPosition=0,this.options.iOSNativeScrolling&&null!=this.el.style.WebkitOverflowScrolling?this.nativeScrolling():this.generate(),this.createEvents(),this.addEvents(),this.reset()}return c.prototype.preventScrolling=function(e,t){if(this.isActive)if(e.type===s)(t===o&&e.originalEvent.detail>0||t===y&&e.originalEvent.detail<0)&&e.preventDefault();else if(e.type===f){if(!e.originalEvent||!e.originalEvent.wheelDelta)return;(t===o&&e.originalEvent.wheelDelta<0||t===y&&e.originalEvent.wheelDelta>0)&&e.preventDefault()}},c.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"}),this.iOSNativeScrolling=!0,this.isActive=!0},c.prototype.updateScrollValues=function(){var e,t;e=this.content,this.maxScrollTop=e.scrollHeight-e.clientHeight,this.prevScrollTop=this.contentScrollTop||0,this.contentScrollTop=e.scrollTop,t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same",this.previousPosition=this.contentScrollTop,"same"!==t&&this.$el.triggerHandler("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t}),this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=0===this.maxScrollTop?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},c.prototype.setOnScrollStyles=function(){var e;S?(e={},e[K]="translate(0, "+this.sliderTop+"px)"):e={top:this.sliderTop},I?(W&&this.scrollRAF&&W(this.scrollRAF),this.scrollRAF=I(function(t){return function(){return t.scrollRAF=null,t.slider.css(e)}}(this))):this.slider.css(e)},c.prototype.createEvents=function(){this.events={down:function(e){return function(t){return e.isBeingDragged=!0,e.offsetY=t.pageY-e.slider.offset().top,e.slider.is(t.target)||(e.offsetY=0),e.pane.addClass("active"),e.doc.bind(g,e.events[r]).bind(p,e.events[y]),e.body.bind(h,e.events[l]),!1}}(this),drag:function(e){return function(t){return e.sliderY=t.pageY-e.$el.offset().top-e.paneTop-(e.offsetY||.5*e.sliderHeight),e.scroll(),e.contentScrollTop>=e.maxScrollTop&&e.prevScrollTop!==e.maxScrollTop?e.$el.triggerHandler("scrollend"):0===e.contentScrollTop&&0!==e.prevScrollTop&&e.$el.triggerHandler("scrolltop"),!1}}(this),up:function(e){return function(t){return e.isBeingDragged=!1,e.pane.removeClass("active"),e.doc.unbind(g,e.events[r]).unbind(p,e.events[y]),e.body.unbind(h,e.events[l]),!1}}(this),resize:function(e){return function(t){e.reset()}}(this),panedown:function(e){return function(t){return e.sliderY=(t.offsetY||t.originalEvent.layerY)-.5*e.sliderHeight,e.scroll(),e.events.down(t),!1}}(this),scroll:function(e){return function(t){e.updateScrollValues(),e.isBeingDragged||(e.iOSNativeScrolling||(e.sliderY=e.sliderTop,e.setOnScrollStyles()),null!=t&&(e.contentScrollTop>=e.maxScrollTop?(e.options.preventPageScrolling&&e.preventScrolling(t,o),e.prevScrollTop!==e.maxScrollTop&&e.$el.triggerHandler("scrollend")):0===e.contentScrollTop&&(e.options.preventPageScrolling&&e.preventScrolling(t,y),0!==e.prevScrollTop&&e.$el.triggerHandler("scrolltop"))))}}(this),wheel:function(e){return function(t){var i;if(null!=t)return i=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail,i&&(e.sliderY+=-i/3),e.scroll(),!1}}(this),enter:function(e){return function(t){var i;if(e.isBeingDragged)return 1!==(t.buttons||t.which)?(i=e.events)[y].apply(i,arguments):void 0}}(this)}},c.prototype.addEvents=function(){var e;this.removeEvents(),e=this.events,this.options.disableResize||this.win.bind(v,e[v]),this.iOSNativeScrolling||(this.slider.bind(u,e[o]),this.pane.bind(u,e[m]).bind(""+f+" "+s,e[x])),this.$content.bind(""+b+" "+f+" "+s+" "+_,e[b])},c.prototype.removeEvents=function(){var e;e=this.events,this.win.unbind(v,e[v]),this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind()),this.$content.unbind(""+b+" "+f+" "+s+" "+_,e[b])},c.prototype.generate=function(){var e,i,n,s,o,r,l;return s=this.options,r=s.paneClass,l=s.sliderClass,e=s.contentClass,(o=this.$el.children("."+r)).length||o.children("."+l).length||this.$el.append('<div class="'+r+'"><div class="'+l+'" /></div>'),this.pane=this.$el.children("."+r),this.slider=this.pane.find("."+l),0===a&&B()?(n=t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),i={right:-14,paddingRight:+n+14}):a&&(i={right:-a},this.$el.addClass("has-scrollbar")),null!=i&&this.$content.css(i),this},c.prototype.restore=function(){this.stopped=!1,this.iOSNativeScrolling||this.pane.show(),this.addEvents()},c.prototype.reset=function(){var e,t,i,s,o,r,l,c,d,u,h,g;return this.iOSNativeScrolling?void(this.contentHeight=this.content.scrollHeight):(this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),e=this.content,s=e.style,o=s.overflowY,n&&this.$content.css({height:this.$content.height()}),t=e.scrollHeight+a,u=parseInt(this.$el.css("max-height"),10),u>0&&(this.$el.height(""),this.$el.height(e.scrollHeight>u?u:e.scrollHeight)),l=this.pane.outerHeight(!1),d=parseInt(this.pane.css("top"),10),r=parseInt(this.pane.css("bottom"),10),c=l+d+r,g=Math.round(c/t*c),g<this.options.sliderMinHeight?g=this.options.sliderMinHeight:null!=this.options.sliderMaxHeight&&g>this.options.sliderMaxHeight&&(g=this.options.sliderMaxHeight),o===b&&s.overflowX!==b&&(g+=a),this.maxSliderTop=c-g,this.contentHeight=t,this.paneHeight=l,this.paneOuterHeight=c,this.sliderHeight=g,this.paneTop=d,this.slider.height(g),this.events.scroll(),this.pane.show(),this.isActive=!0,e.scrollHeight===e.clientHeight||this.pane.outerHeight(!0)>=e.scrollHeight&&o!==b?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===e.scrollHeight&&o===b?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),i=this.$content.css("position"),"static"!==i&&"relative"!==i||(h=parseInt(this.$content.css("right"),10),h&&this.$content.css({right:"",marginRight:h})),this)},c.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this},c.prototype.scrollBottom=function(e){if(this.isActive)return this.$content.scrollTop(this.contentHeight-this.$content.height()-e).triggerHandler(f),this.stop().restore(),this},c.prototype.scrollTop=function(e){if(this.isActive)return this.$content.scrollTop(+e).triggerHandler(f),this.stop().restore(),this},c.prototype.scrollTo=function(e){if(this.isActive)return this.scrollTop(this.$el.find(e).get(0).offsetTop),this},c.prototype.stop=function(){return W&&this.scrollRAF&&(W(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},c.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),n&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},c.prototype.flash=function(){if(!this.iOSNativeScrolling&&this.isActive)return this.reset(),this.pane.addClass("flashed"),setTimeout(function(e){return function(){e.pane.removeClass("flashed")}}(this),this.options.flashDelay),this},c}(),e.fn.nanoScroller=function(t){return this.each(function(){var i,n;if((n=this.nanoscroller)||(i=e.extend({},C,t),this.nanoscroller=n=new w(this,i)),t&&"object"==typeof t){if(e.extend(n.options,t),null!=t.scrollBottom)return n.scrollBottom(t.scrollBottom);if(null!=t.scrollTop)return n.scrollTop(t.scrollTop);if(t.scrollTo)return n.scrollTo(t.scrollTo);if("bottom"===t.scroll)return n.scrollBottom(0);if("top"===t.scroll)return n.scrollTop(0);if(t.scroll&&t.scroll instanceof e)return n.scrollTo(t.scroll);if(t.stop)return n.stop();if(t.destroy)return n.destroy();if(t.flash)return n.flash()}return n.reset()})},e.fn.nanoScroller.Constructor=w}),wsUtil=function(e){return{specialChars:function(t){return e("<div></div>").html(t).text()},giveGetParams:function(){aGetStr=location.search||"",aGetStr=aGetStr.replace("?","");var t={},i=aGetStr.split("&");return 0===i.length?t:(e.each(i,function(e,i){i&&(n=i.split("="),2===n.length&&(t[n[0]]=n[1]))}),t)},setCookie:function(e,t,i,n,a,s){if(!e||!t)return!1;n||(n="/");var o=e+"="+encodeURIComponent(t);return i&&(o+="; expires="+i.toGMTString()),n&&(o+="; path="+n),a&&(o+="; domain="+a),s&&(o+="; secure"),document.cookie=o,!0},getCookie:function(e){var t="(?:; )?"+e+"=([^;]*);?",i=new RegExp(t);return!!i.test(document.cookie)&&decodeURIComponent(RegExp.$1)},deleteCookie:function(e,t,i){return t||(t="/"),this.setCookie(e,"0",new Date(0),t,i),!0},isLocalStorageNameSupported:function(){var e="test_localstorage";try{return window.localStorage.setItem(e,1),window.localStorage.removeItem(e),!0}catch(t){return this.log("localStorage "),!1}},setStorage:function(e,t){if(this.isLocalStorageNameSupported())localStorage.setItem(e,t);else{var i=new Date;i.setFullYear(i.getFullYear()+2),this.setCookie(e,t,i)}},getStorage:function(e){return this.isLocalStorageNameSupported()?localStorage.getItem(e):this.getCookie(e)},deleteStorage:function(e){this.isLocalStorageNameSupported()?localStorage.removeItem(e):this.deleteCookie(e)},checkStorageTime:function(t){if(0!=t.length){var i=(new Date).getTime();e.each(t,function(e,t){var n=wsUtil.getStorage(t)?wsUtil.getStorage(t):0;0!=n&&n<i&&wsUtil.deleteStorage(t)})}},doEnding:function(e,t,i,n){return e=""+e,e.charAt(e.length-2)&&1==e.charAt(e.length-2)?n:1==e.charAt(e.length-1)?t:e.charAt(e.length-1)>1&&e.charAt(e.length-1)<5?i:n},array2json:function(e){var t=[],i="[object Array]"===Object.prototype.toString.apply(e);for(var n in e){var a=e[n];if("object"==typeof a)i?t.push(this.array2json(a)):t[n]=this.array2json(a);else{var s="";i||(s='"'+n+'":'),s+="number"==typeof a?a:a===!1?"false":a===!0?"true":'"'+a+'"',t.push(s)}}var o=t.join(",");return i?"["+o+"]":"{"+o+"}"},getRandomArbitrary:function(e,t){return Math.round(Math.random()*(t-e)+e)},initTimeouts:function(){this.hasOwnProperty("_timeouts")&&this._timeouts.length>0&&this.deleteAllTimeouts(),this._timeouts=[]},setTimeout:function(e,t,i){this._timeouts.hasOwnProperty(e)&&this.deleteTimeout(e),this._timeouts[e]=setTimeout(t,i)},getTimeout:function(e){return this._timeouts[e]},deleteTimeout:function(e){"undefined"!=typeof this._timeouts[e]&&(clearTimeout(this._timeouts[e]),delete this._timeouts[e])},deleteAllTimeouts:function(){for(var e in this._timeouts)this._timeouts.hasOwnProperty(e)&&this.deleteTimeout(e)},initIntervals:function(){this.hasOwnProperty("_intervals")&&this._intervals.length>0&&this.deleteAllIntervals(),this._intervals=[]},setInterval:function(e,t,i){this._intervals.hasOwnProperty(e)&&this.deleteInterval(e),this._intervals[e]=setInterval(t,i)},getInterval:function(e){return this._intervals[e]},deleteInterval:function(e){"undefined"!=typeof this._intervals[e]&&(clearInterval(this._intervals[e]),delete this._intervals[e])},deleteAllIntervals:function(){for(var e in this._intervals)this._intervals.hasOwnProperty(e)&&this.deleteInterval(e)},setCaretPosition:function(e,t,i){var n=e.jws&&e.length>0?e[0]:e;if("number"==typeof t){if(i="number"==typeof i?i:t,n.setSelectionRange)navigator.userAgent.search(/Edge/)===-1&&n.setSelectionRange(t,i);else if(n.createTextRange){var a=n.createTextRange();a.collapse(!0),a.moveEnd("character",i),a.moveStart("character",t),a.select()}n.focus()}else if(n.setSelectionRange)t=n.selectionStart,i=n.selectionEnd;else if(document.selection&&document.selection.createRange){var a=document.selection.createRange();t=0-a.duplicate().moveStart("character",-1e5),i=t+a.text.length}},getRoistatPromo:function(){var t=this.getCookie("roistat_visit");return t||e(".roistat-promo").length&&(t=parseInt(e(".roistat-promo").text())),t},getAdvertiseId:function(){return this.getCookie("adv_uid")},getCalltrackingId:function(){return this.getCookie("cbk_calltracking.ru_id")},getLPGeneratorId:function(){return this.getCookie("cbk_lpgenerator_id")},sendYaMetrika:function(e){for(var t in window)if("string"==typeof t&&t.match(/yaCounter\d+/)&&"undefined"!=typeof window[t]&&window[t].reachGoal)try{window[t].reachGoal(e)}catch(i){}},sendMailCounter:function(t){if("undefined"!=typeof _tmr)try{var i=/mail.ru\/counter\?id=(\d+)/i,n=e("html").html().match(i);"undefined"!=typeof _tmr&&n[1]&&_tmr.push({id:n[1],type:"reachGoal",goal:t})}catch(a){}},sendGoal:function(t,i,n,a){e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),wsUtil.sendYaMetrika(t),wsUtil.sendMailCounter(i),"undefined"!=typeof _gaq&&_gaq.push(["_trackEvent",n,i,(WBK.settings.visitorName?WBK.settings.visitorName:"")+" "+(WBK.settings.visitorPhone?WBK.settings.visitorPhone:"")]),"undefined"!=typeof ga&&"function"==typeof ga&&ga("send","event",n,i,(WBK.settings.visitorName?WBK.settings.visitorName:"")+" "+(WBK.settings.visitorPhone?WBK.settings.visitorPhone:"")),"undefined"!=typeof dataLayer&&(dataLayer.push({event:"GAEvent",eventCategory:n,eventAction:i}),dataLayer.push({event:i})),a&&"undefined"!=typeof yaglametrika&&"undefined"!=typeof yaglaservice&&yaglametrika.id&&yaglaservice("wbkNewLead")},log:function(e){console.log("%c "+e+" ","background: #222; color: #bada55")},validateEmail:function(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return t.test(e)},getGoogleClientId:function(){var e="";return"undefined"!=typeof ga&&"function"==typeof ga&&"undefined"!=typeof ga.getAll&&"function"==typeof ga.getAll&&ga.getAll().length&&(e=ga.getAll()[0].get("clientId")),e},humanizeNumber:function(e,t){if("undefined"==typeof t&&(t="&nbsp;"),0==e)return 0;if(!e)return"";var i=e.toString(),n="",a=0;","!=i.charAt(i.length-2)&&"."!=i.charAt(i.length-2)||(a=2),","!=i.charAt(i.length-3)&&"."!=i.charAt(i.length-3)||(a=3),","!=i.charAt(i.length-4)&&"."!=i.charAt(i.length-4)||(a=4);for(var s=0,o=i.length-a;s<o;s++)n=n+((o-s)%3==0&&0!=s?t:"")+i.charAt(s);for(s=i.length-a,o=i.length;s<o;s++)n+=i.charAt(s);return n}}}(jWS),wsInvader=function(e){var t,i,n,a,s;return{settings:{},templates:{},widget:{},init:function(o){t=this,i=this.settings,n=this.templates,a=this.widget,e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),s=WBK.checkDebug(),t.loader(o)},loader:function(e){var n=e.Data.invader;if("tablet"===WBK.settings.device){if(parseInt(n.hide_tablet))return void(s&&t.log("   "));if("go_callback"==n.widget.action||!WBK.settings.killerId)return void(s&&t.log("  killerId"))}t.setDefaultText(),t.setDefaultSettings(),t.setTemplate(),WBK.settings.invaderId=parseInt(e.Settings.invaderId),n.widget.text_hello&&(i.hello=n.widget.text_hello),n.widget.manager_name&&(i.name=n.widget.manager_name),n.widget.text_message&&(i.message=n.widget.text_message),n.widget.text_action_view&&(i.action=n.widget.text_action_view),e.Settings.serviceDomain&&(i.partnerLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=invader&utm_term=",WBK.settings.thisIsCallbackKILLER&&(i.partnerLink="http://cb-killer.ru/invader/?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=invader&utm_term=")),n.partnerLink&&(i.partnerLink=n.partnerLink),n.click_type&&(i.clickType=n.click_type),n.widget.img&&(i.avatar=n.widget.img),n.paused_seconds&&(i.pausedSeconds=parseInt(n.paused_seconds)),n.repeat_show_time&&(i.repeatShowTime=parseInt(n.repeat_show_time)),n.repeat_show_type&&(i.repeatShowType=n.repeat_show_type),n.repeat_show_time_after&&(i.repeatShowTimeAfter=parseInt(n.repeat_show_time_after)),n.repeat_show_type_after&&(i.repeatShowTypeAfter=n.repeat_show_type_after),n.show_enter&&(i.showEnter=n.show_enter),n.show_finish&&(i.showFinish=n.show_finish),n.show_scroll_value&&(i.showScrollValue=parseInt(n.show_scroll_value)),n.widget.action&&(i.actionType=n.widget.action),n.widget.action_value&&(i.actionValue=n.widget.action_value),n.widget.callback_show&&(i.callbackShow=parseInt(n.widget.callback_show)),n.widget.url_open_type&&(i.openThisWindow=n.widget.url_open_type),n.sound&&(i.sound=parseInt(n.sound)),n.position&&(i.position=n.position),n.position_value&&(i.positionValue=parseInt(n.position_value)),n.color_background&&(i.colorBackground=n.color_background),n.color_background_text&&(i.colorBackgroundText=n.color_background_text),WBK.addStyles(".cbk-support-new-message{background-color: "+i.colorBackground+" !important;}.invader_view .load_info, .cbk-support-new-message-typing, .cbk-support-new-message-close, .cbk-support-new-message-name, .cbk-support-new-message-text, .cbk-support-new-message-text a, .cbk-support-new-message-copyright a, .cbk-support-new-message-copyright a:hover{color:  "+i.colorBackgroundText+" !important;}"),t.start()},setDefaultText:function(){var t={partnerLinkText:"  <span class='invader-service-name'></span>"};e.extend(!0,i,t)},setDefaultSettings:function(){var t={avatar:!1,apperanceTimeout:1,pausedSeconds:!1,repeatShowTime:!1,repeatShowType:!1,repeatShowTimeAfter:!1,repeatShowTypeAfter:!1,showEnter:!1,showFinish:"after_show",showScrollValue:0,name:" ",hello:"!",message:"      .   ",action:"     []",actionType:!1,actionValue:!1,callbackShow:2,openThisWindow:!1,sound:!1,position:"left",pinvaderPositionValue:1,partnerLink:!1,clickType:"body",colorBackground:"rgba(58, 58, 58, 1)",colorBackgroundText:"rgba(255, 255, 255, 1)"};e.extend(!0,i,t)},setTemplate:function(){n='<div class="cbk-support-new-message"><div class="cbk-support-new-message-avatar"></div><div class="cbk-support-new-message-close"></div><div class="cbk-support-new-message-name"></div><div class="cbk-support-new-message-copyright"><a href="#" class="cbk-support-new-message-copyright-url" target="_blank" data-widget="invader">'+i.partnerLinkText+"</a></div></div>"},start:function(){a.window=e(n).hide().find(".cbk-support-new-message-close").click(function(e){return t.sendEvents("close",i.actionType,i.actionValue),t.closeWidget(),t.sendGoal("close"),e.preventDefault(),!1}).end().appendTo("body"),i.avatar?a.window.find(".cbk-support-new-message-avatar").html(e("<img/>").attr("src",WBK.settings.serverUrl+"/uploaded/invaders/"+WBK.settings.invaderId+"/"+i.avatar)):(a.window.find(".cbk-support-new-message-avatar").remove(),a.window.addClass("cbk-support-new-message-no-avatar"));var s="body";"body"==i.clickType?s=".cbk-support-new-message, .cbk-support-new-message a":(s=".cbk-support-new-message a",a.window.css("cursor","auto")),e("body").on("click",s,function(n){if(!e(n.target).hasClass("cbk-support-new-message-copyright-url")&&!e(n.target).hasClass("invader-service-name")){var a=new Date;switch(i.actionType){case"go_callback":a.setMinutes(a.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onsm",a),wsKiller.showWindow("sm");break;case"go_generator":wsGenerator.showWidget("invader");break;case"go_chat":wsChat.showWidget();break;case"go_url":"true"==i.openThisWindow?window.location.href=wsUtil.specialChars(i.actionValue):window.open(wsUtil.specialChars(i.actionValue),"_blank");break;case"go_javascript":case"go_other_widget":window.top.eval(i.actionValue)}return t.sendEvents("click",i.actionType,i.actionValue),t.sendGoal("click"),t.closeWidget(),n.preventDefault(),!1}}),a.window.find(".cbk-support-new-message-name").html(i.name),e(".cbk-support-new-message-copyright-url").attr("href",i.partnerLink),e("body").on("click",".cbk-support-new-message-copyright-url",function(t){
WBK.sendAdvertLinkStat(e(this).data("widget"),e(this).attr("href"),e(this).text(),WBK.settings.invaderId)}),a.window.find("span.invader-service-name").html(WBK.settings.servicename),"left"==i.position?a.window.css({left:i.positionValue+"%",right:"inherit"}):a.window.css({right:i.positionValue+"%",left:"inherit"}),t.initTimer()},sendEvents:function(t,i,n){var a=WBK.settings.serverUrl+"/api?action=invaderEvent&callback=?";e.getJSON(a,{event:t,widget:i,value:parseInt(n)?parseInt(n):0,invaderId:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderStatId,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId},function(e){if("undefined"!=typeof e.Data.id){if("click"===t)switch(i){case"go_callback":WBK.settings.invaderCallbackStatId=e.Data.id;break;case"go_generator":WBK.settings.invaderGeneratorStatId=e.Data.id}"show"===t&&(WBK.settings.invaderStatId=e.Data.id)}})},closeWidget:function(){WBK.animateFastOnce(a.window,"cbk-fadeOutDown",function(){a.window.hide()}),WBK.settings.windowInvaderOpened=!1;var e=new Date;"minutes"==i.repeatShowType?e.setMinutes(e.getMinutes()+parseInt(i.repeatShowTime)):"days"==i.repeatShowType&&e.setDate(e.getDate()+parseInt(i.repeatShowTime)),wsUtil.setCookie("WhiteInvader_closed_"+WBK.settings.invaderId,!0,e)},initTimer:function(){var n=1;"paused"==i.showEnter&&(n=i.pausedSeconds),"scroll"==i.showEnter&&(n=1),"behavioral"==i.showEnter&&(n=wsUtil.getRandomArbitrary(3,27)),wsUtil.setInterval("WidgetInvaderTimeout",function(){if("scroll"==i.showEnter){var n=e(window).scrollTop(),a=e(document).height()-e(window).height(),s=n/a*100;if(s<i.showScrollValue)return}WBK.settings.windowInvaderOpened||WBK.settings.windowGeneratorOpened||WBK.settings.windowOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||wsUtil.getCookie("WhiteInvader_closed_"+WBK.settings.invaderId)||("go_callback"==i.actionType?(wsKiller.checkWorkTime(),1==i.callbackShow?t.showWidget():3!=i.callbackShow||wsKiller.settings.killerWorking?wsKiller.settings.killerWorking&&t.showWidget():t.showWidget()):t.showWidget())},1e3*n)},showWidget:function(){WBK.settings.windowInvaderOpened=!0,t.sendEvents("show",i.actionType,i.actionValue),"after_show"==i.showFinish&&t.setShowCookie(),a.window.find(".cbk-support-new-message-text").remove(),a.window.find(".cbk-support-new-message-typing").remove(),a.window.find(".cbk-support-new-message-copyright").before(e("<div>").addClass("cbk-support-new-message-text").html(i.hello)),a.window.show(),i.sound&&WBK.Sound("invader");var n="  ...";22480!=WBK.settings.siteId&&30957!=WBK.settings.siteId||(n=" typing ..."),WBK.animateFastOnce(a.window,"cbk-fadeInUp"),a.window.find(".cbk-support-new-message-copyright").before(e("<div>").addClass("cbk-support-new-message-typing").html(i.name+n).hide().fadeIn()),wsUtil.setTimeout("supportMessageOnTimer",function(){a.window.find(".cbk-support-new-message-typing").fadeOut(function(){e(this).remove(),a.window.find(".cbk-support-new-message-copyright").before(e("<div>").addClass("cbk-support-new-message-text").html(i.message)),wsUtil.setTimeout("supportMessageOnTimer",function(){a.window.find(".cbk-support-new-message-copyright").before(e("<div>").addClass("cbk-support-new-message-typing").html(i.name+n).hide().fadeIn()),wsUtil.setTimeout("supportMessageOnTimer",function(){a.window.find(".cbk-support-new-message-typing").fadeOut(function(){e(this).remove(),a.window.find(".cbk-support-new-message-copyright").before(e("<div>").addClass("cbk-support-new-message-text").html(i.action))}),"before_messages"==i.showFinish&&t.setShowCookie(),wsUtil.setTimeout("supportMessageOnTimer",function(){WBK.settings.hideCopyright||a.window.find(".cbk-support-new-message-copyright").show(400)},1e3)},50*i.action.length)},1e3)})},75*i.message.length)},setShowCookie:function(){if(!wsUtil.getCookie("WhiteInvader_closed_"+WBK.settings.invaderId)){var e=new Date;"minutes"==i.repeatShowTypeAfter?e.setMinutes(e.getMinutes()+parseInt(i.repeatShowTime)):"days"==i.repeatShowTypeAfter&&e.setDate(e.getDate()+parseInt(i.repeatShowTime)),wsUtil.setCookie("WhiteInvader_closed_"+WBK.settings.invaderId,!0,e)}},sendGoal:function(e){var t,i,n="Invader";switch(e){case"click":t="INV_CLICK",i="ClickInvader";break;case"close":t="INV_CANCEL",i="CancelInvader"}wsUtil.sendGoal(t,i,n)},log:function(e){wsUtil.log("INVADER : "+e)}}}(jWS),wsGenerator=function(e){var t,i,n,a,s;return{settings:{},templates:{},widget:{},init:function(o){t=this,i=this.settings,n=this.templates,a=this.widget,s=WBK.checkDebug(),e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),t.loader(o)},loader:function(e){var n=e.Data.generator;return"tablet"===WBK.settings.device&&parseInt(n.hide_tablet)?void(s&&t.log("   ")):(t.setDefaultSettings(),WBK.settings.generatorId=e.Settings.generatorId,i.langText=n.lang_text,void 0!=n.text_general&&(i.langText.text_general=t.decorateUrl(n.text_general)),void 0!=n.text_sub&&(i.langText.text_sub=t.decorateUrl(n.text_sub)),void 0!=n.text_success&&(i.langText.text_success=t.decorateUrl(n.text_success)),void 0!=n.text_counter_title&&(i.langText.text_counter_title=n.text_counter_title),void 0!=n.btn_success_text&&(i.langText.btn_success_text=n.btn_success_text),void 0!=n.btn_cancel_text&&(i.langText.btn_cancel_text=n.btn_cancel_text),void 0!=n.email_agreement_text&&(i.langText.email_agreement_text=n.email_agreement_text),n.text_general_color_background&&(i.textGeneralColorBackground=n.text_general_color_background),n.text_general_color_text&&(i.textGeneralColorText=n.text_general_color_text),n.btn_success_color&&(i.btnSuccessColor=n.btn_success_color),n.btn_cancel_color&&(i.btnCancelColor=n.btn_cancel_color),n.counter_time&&(i.counterTime=n.counter_time),n.date_end&&(i.dateEnd=n.date_end),n.date_end_time&&(i.dateEndTime=n.date_end_time),n.date_end_weekday&&(i.dateEndWeekday=parseInt(n.date_end_weekday)),n.date_hours&&(i.dateHours=n.date_hours),n.date_hours_type&&(i.dateHoursType=n.date_hours_type),n.get_email&&(i.getEmail=n.get_email),n.get_name&&(i.getName=n.get_name),n.get_phone&&(i.getPhone=n.get_phone),n.img_background&&(i.imgBackground=parseInt(n.img_background)),n.img_background_service&&(i.imgBackgroundService=parseInt(n.img_background_service)),n.paused_seconds&&(i.pausedSeconds=n.paused_seconds),n.repeat_show_time&&(i.repeatShowTime=n.repeat_show_time),n.repeat_show_type&&(i.repeatShowType=n.repeat_show_type),n.show_enter&&(i.showEnter=n.show_enter),n.show_scroll_value&&(i.showScrollValue=parseInt(n.show_scroll_value)),n.show_behavioral_value&&(i.showBehavioralValue=parseInt(n.show_behavioral_value)),n.send_action&&(i.sendAction=n.send_action),n.send_action_url&&(i.sendActionUrl=n.send_action_url),n.show_exit&&(i.showExit=n.show_exit),n.timer_enable&&(i.timerEnable=parseInt(n.timer_enable)),n.auto_call&&(i.autoCall=parseInt(n.auto_call)),n.auto_call_text&&(i.autoCallText=n.auto_call_text),n.auto_call_deffered&&(i.autoCallDeffered=parseInt(n.auto_call_deffered)),n.auto_call_deffered_delay&&(i.autoCallDefferedDelay=parseInt(n.auto_call_deffered_delay)),n.ispayed&&(i.isPayed=n.ispayed),n.hasMoneyForLead&&(i.hasMoneyForLead=n.hasMoneyForLead),n.close_click_bgr&&(i.closeClickBgr=parseInt(n.close_click_bgr)),n.counter_bgr_color&&(i.counterBgrColor=n.counter_bgr_color),n.counter_number_color&&(i.counterNumberColor=n.counter_number_color),n.container_shadow&&(i.containerShadow=n.container_shadow),e.Settings.serviceDomain&&(i.partnerLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=generator&utm_term=",WBK.settings.thisIsCallbackKILLER&&(i.partnerLink="http://cb-killer.ru/generator/?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=generator&utm_term=")),n.partnerLink&&(i.partnerLink=n.partnerLink),n.format_general_text&&(i.textGeneralFormat=n.format_general_text),n.position_gorizontal_general_text&&(i.textGeneralPositionGorizontal=n.position_gorizontal_general_text),n.position_vertical_general_text&&(i.textGeneralPositionVertical=n.position_vertical_general_text),n.font_family_general_text&&(i.textGeneralFontFamily=n.font_family_general_text),n.font_size_general_text&&(i.textGeneralFontSize=parseInt(n.font_size_general_text)),n.email_service&&(i.emailService=n.email_service),n.email_agreement&&(i.emailAgreement=parseInt(n.email_agreement)),n.no_show_timeout&&(i.noShowTimeout=parseInt(n.no_show_timeout)),n.hide_background_site&&(i.hideBackgroundSite=parseInt(n.hide_background_site)),t.setTemplate(),void t.start())},start:function(){var t=this;if(a.window=e(n.window).hide().appendTo("body"),a.windowbgr=e(n.windowBgr).hide().click(function(e){return i.closeClickBgr&&t.closeWidget(),e.preventDefault(),!1}).appendTo("body"),2==i.hideBackgroundSite&&a.windowbgr.addClass("cbk-window-bgr-transparent"),e(".white-saas-generator-copyright-url").attr("href",i.partnerLink),WBK.settings.visitorPhone&&e(".white-saas-generator-userphone").val(WBK.settings.visitorPhone),WBK.settings.visitorEmail&&e(".white-saas-generator-useremail").val(WBK.settings.visitorEmail),WBK.settings.visitorName&&e(".white-saas-generator-username").val(WBK.settings.visitorName),WBK.settings.hideCopyright?e(".white-saas-generator-copyright-url").remove():e("body").on("click",".white-saas-generator-copyright-url",function(t){WBK.sendAdvertLinkStat(e(this).data("widget"),e(this).attr("href"),e(this).text(),WBK.settings.generatorId)}),parseInt(i.showExit)&&e("body").mouseleave(function(n){var a={x:n.pageX,y:n.pageY-e(document).scrollTop()};if(a.y<=10&&!(i.noShow||WBK.settings.windowOpened||WBK.settings.chatWindowOpened||wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||WBK.settings.called)){WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide());var s=new Date;s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_show_"+WBK.settings.generatorId,"onexit",s),t.showWidget("exit")}}),i.langText.text_general||a.window.find(".white-saas-generator-text-general-span").hide(),a.window.find(".white-saas-generator-text-general-span").html(i.langText.text_general),a.window.find(".white-saas-generator-text-sub").html(i.langText.text_sub),a.window.find(".white-saas-generator-success-text").html(i.langText.text_success),"off"!=i.emailService&&i.emailAgreement||a.window.find(".white-saas-generator-label-agreement").hide(),i.imgBackgroundService){var s=new Date;a.window.find(".white-saas-generator-image").attr("src",WBK.settings.staticServerUrl+"/uploaded/callback_generators/"+WBK.settings.serviceid+"/logo.png?"+s.getTime())}if("scroll"==i.showEnter&&e(window).on("scroll.white-saas-generator",function(){var n=e(window).scrollTop(),a=e(document).height()-e(window).height(),s=n/a*100;!(i.showScrollValue<=s)||i.noShow||WBK.settings.windowGeneratorOpened||WBK.settings.windowOpened||WBK.settings.windowInvaderOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||WBK.settings.called||t.showWidget("auto")}),i.isPayed){if(a.window.find(".white-saas-generator-btn-success").text(i.langText.btn_success_text),a.window.find(".white-saas-generator-btn-cancel").text(i.langText.btn_cancel_text),i.imgBackground){var s=new Date;a.window.find(".white-saas-generator-image").attr("src",WBK.settings.staticServerUrl+"/uploaded/generators/"+WBK.settings.generatorId+"/logo.png?"+s.getTime())}if(i.textGeneralColorBackground&&a.window.find(".white-saas-generator-text-general-span").css("background-color",i.textGeneralColorBackground),i.textGeneralColorText&&a.window.find(".white-saas-generator-text-general-span").css("color",i.textGeneralColorText),i.btnSuccessColor&&(a.window.find(".white-saas-generator-btn-success").css("background-color",i.btnSuccessColor),a.window.find(".white-saas-generator-btn-yes").css("background-color",i.btnSuccessColor)),i.btnCancelColor&&a.window.find(".white-saas-generator-btn-cancel").css("background-color",i.btnCancelColor),i.counterBgrColor&&a.window.find(".white-saas-generator-block-min, .white-saas-generator-counter-dz-block").css("background-color",i.counterBgrColor),i.counterNumberColor&&a.window.find(".white-saas-generator-counter-number").css("color",i.counterNumberColor),i.containerShadow)switch(i.containerShadow){case"none":a.window.css("box-shadow","none");break;case"easy":a.window.css("box-shadow","0 3px 12px rgba(0, 0, 0, 0.15)");break;case"heavy":a.window.css("box-shadow","0 3px 12px rgba(0, 0, 0, 0.45)")}i.textGeneralFormat&&a.window.find(".white-saas-generator-text-general").css("text-align",i.textGeneralFormat),i.textGeneralPositionGorizontal&&a.window.find(".white-saas-generator-text-general").css("left",i.textGeneralPositionGorizontal+"px"),i.textGeneralPositionVertical&&a.window.find(".white-saas-generator-text-general").css("top",i.textGeneralPositionVertical+"px"),i.textGeneralFontFamily&&WBK.addStyles(".white-saas-generator-text-general-span {font-family: "+i.textGeneralFontFamily+"!important;}"),i.textGeneralFontSize&&a.window.find(".white-saas-generator-text-general-span ").css("font-size",i.textGeneralFontSize+"px"),0==i.timerEnable&&a.window.find(".white-saas-generator-counter").hide(),"hide"==i.getName&&a.window.find(".white-saas-generator-username").hide(),"hide"==i.getPhone&&a.window.find(".white-saas-generator-userphone").hide(),"hide"==i.getEmail&&a.window.find(".white-saas-generator-useremail").hide()}else i.getPhone="yes",a.window.find(".white-saas-generator-username").hide(),i.getName="hide",a.window.find(".white-saas-generator-useremail").hide(),i.getEmail="hide";if(a.window.find(".white-saas-generator-btn-cancel").click(function(e){return e.preventDefault(),t.closeWidget(),!1}),WBK.settings.phoneMasks){var o=e.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),r={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:o,listKey:"mask",onMaskChange:function(){e(this).attr("placeholder",e(this).inputmask("getemptymask"))}};e(".white-saas-generator-userphone").inputmasks(r),e(".cbk-phone-checker").inputmasks(r)}a.window.find(".white-saas-generator-btn-success").on("click",function(e){e.preventDefault(),t.sendLead()}),a.window.find(".white-saas-generator-btn-yes").on("click",function(e){e.preventDefault(),t.hideWidget()}),i.timerEnable&&t.initCountDown(),t.initTimer(),"#showgenerator"===window.top.location.hash&&t.showWidget("url"),e.fn._frameCheck()&&"undefined"==typeof WBK||e("body").on("click",'a[href="#showgenerator"], a[href="'+window.top.location.origin+'#showgenerator"], a[href="'+window.top.location.origin+'/#showgenerator"]',function(e){return t.showWidget("url"),e.preventDefault(),!1})},initTimer:function(){if("disabled"!=i.showEnter&&"scroll"!=i.showEnter){var e=1;if("paused"==i.showEnter&&(e=i.pausedSeconds),"behavioral"==i.showEnter){var n=3,a=27;i.showBehavioralValue&&(n+=i.showBehavioralValue,a+=i.showBehavioralValue),e=wsUtil.getRandomArbitrary(n,a)}wsUtil.setInterval("WidgetGeneratorTimer",function(){i.noShow||WBK.settings.windowGeneratorOpened||WBK.settings.windowOpened||WBK.settings.windowInvaderOpened||WBK.settings.chatWindowOpened||(wsUtil.deleteInterval("WidgetGeneratorTimer"),wsUtil.getCookie("WhiteGenerator_closed_"+WBK.settings.generatorId)||wsUtil.getCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId)||WBK.settings.called||t.showWidget("auto"))},1e3*e)}},initCountDown:function(){var n=new Date;n=t.getDate(n);var a=wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counter");if(a=!(!a||"false"==a)&&JSON.parse(a),"fixed"==i.counterTime)if(a&&a.counterTime==i.counterTime&&a.dateHours==i.dateHours&&a.dateHoursType==i.dateHoursType&&wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEnd"))n=new Date(wsUtil.getCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEnd"));else{wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_countEnd",n,n);var a={dateHours:i.dateHours,dateHoursType:i.dateHoursType,counterTime:"fixed"};wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counter",JSON.stringify(a),n)}else{a&&(a.counterTime=i.counterTime);var s=new Date;s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_"+WBK.settings.generatorId+"_counter",JSON.stringify(a),s)}i.endTime=n,wsUtil.setInterval("WidgetGeneratorCountDown",function(){var n,a,s,o,r,l=86400,c=3600,d=60;n=Math.floor((i.endTime-new Date)/1e3),n<0?(i.noShowTimeout&&(i.noShow=1),t.stopCountDown(),a="00",s="00",o="00",r="00"):(a=Math.floor(n/l),n-=a*l,s=Math.floor(n/c),n-=s*c,o=Math.floor(n/d),n-=o*d,r=n);var u=i.counterTypeInTimer;a>0?i.counterTypeInTimer=1:i.counterTypeInTimer=0,u!=i.counterTypeInTimer&&(1==i.counterTypeInTimer?(e(".white-saas-generator-counter-number-hours").next().text(i.langText.text_counter_days),e(".white-saas-generator-counter-number-minutes").next().text(i.langText.text_counter_hours),e(".white-saas-generator-counter-number-seconds").next().text(i.langText.text_counter_minutes)):(e(".white-saas-generator-counter-number-hours").next().text(i.langText.text_counter_hours),e(".white-saas-generator-counter-number-minutes").next().text(i.langText.text_counter_minutes),e(".white-saas-generator-counter-number-seconds").next().text(i.langText.text_counter_seconds))),1==i.counterTypeInTimer&&(r=o,o=s,s=a),t.updateGeneratorDigits(s,".white-saas-generator-counter-number-hours"),t.updateGeneratorDigits(o,".white-saas-generator-counter-number-minutes"),t.updateGeneratorDigits(r,".white-saas-generator-counter-number-seconds")},1e3)},stopCountDown:function(){wsUtil.deleteInterval("WidgetGeneratorCountDown")},updateGeneratorDigits:function(e,t){var i=Math.floor(e/10)%10+"",n=e%10+"",s=i+n;a.window.find(t).text(s)},getDate:function(e){switch(i.counterTime){case"fixed":"hours"==i.dateHoursType?e.setHours(e.getHours()+parseInt(i.dateHours)):"minutes"==i.dateHoursType&&e.setMinutes(e.getMinutes()+parseInt(i.dateHours));break;case"todate":var t=i.dateEnd.split("."),n=i.dateEndTime.split(":");e=new Date(parseInt(t[2]),parseInt(t[1])-1,parseInt(t[0]),n[0],n[1]);break;case"toweekday":var a,s=(new Date).getDay(),o=parseInt(i.dateEndWeekday);a=s<o?o-s:s==o?7:7-o,e=new Date(new Date(e).setHours(0,0,0,0)),e=e.setDate(e.getDate()+a)}return e},decorateUrl:function(e){return e=e.replace(/\[(.+?)\|(.+?)\]/gi,"<a href='$1' target='_blank'>$2</a>")},sendLead:function(){if(!i.sendingLead){i.sendingLead=!0;var n,s,o,r,l;n=e(".white-saas-generator-username").val(),s=e(".white-saas-generator-useremail").val(),o=e(".white-saas-generator-userphone").val(),r=e(".white-saas-generator-userphone").attr("placeholder"),l=e(".white-saas-generator-email-agreement").is(":checked")?1:0,o=WBK.checkPhone(o),e(".white-saas-generator-userphone-error, .white-saas-generator-username-error, .white-saas-generator-useremail-error").addClass("white-saas-generator-error-hidden");var c="";if("yes"==i.getName&&""==n&&(c=".white-saas-generator-username-error"),"yes"==i.getPhone&&""==o&&(c?c+=", .white-saas-generator-userphone-error":c=".white-saas-generator-userphone-error"),"yes"!=i.getEmail||""!=s&&wsUtil.validateEmail(s)||(c?c+=", .white-saas-generator-useremail-error":c=".white-saas-generator-useremail-error"),c)return a.window.find(c).removeClass("white-saas-generator-error-hidden"),void(i.sendingLead=!1);var d=WBK.settings.serverUrl+"/api?action=genLeadAdd&callback=?";jWS.getJSON(d,{code:WBK.settings.whiteSaasCode,name:n,email:s,phone:o,visitId:WBK.settings.visitId,generatorId:WBK.settings.generatorId,generatorStatId:WBK.settings.generatorStatId,phoneMask:r,emailAgreement:l,url:"string"==typeof document.URL?document.URL:"",visitorId:WBK.settings.visitorId,invader_id:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderGeneratorStatId,instinct_id:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctGeneratorStatId,roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId()},function(n){if(1==n.Success){var s=new Date;if(s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("WhiteGenerator_success_closed_"+WBK.settings.generatorId,!0,s),"undefined"!=typeof n.Data.leadId&&(WBK.settings.genLeadId=n.Data.leadId,o&&i.autoCall&&WBK.settings.callbackEnabled&&i.isPayed&&i.hasMoneyForLead)){wsKiller.settings.callingGenerator=!0;var r=new Date;r.setMinutes(r.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","ongen",r),WBK.settings.phoneMask=e(".white-saas-generator-userphone").attr("placeholder"),wsKiller.newCall(o,!1,i.autoCallDeffered,i.autoCallDefferedDelay)}t.sendGoal("lead"),"go_url"==i.sendAction&&i.sendActionUrl?window.location.href=i.sendActionUrl:(a.window.find(".white-saas-generator-right-block").children().hide(),a.window.find(".white-saas-generator-success").show()),i.sendingLead=!1}})}},hideWidget:function(){WBK.settings.windowGeneratorOpened=!1,a.windowbgr.hide(),a.window.hide(),WBK.settings.callbackEnabled&&1!=wsKiller.settings.hideBtn&&wsKiller.settings.btnShow&&wsKiller.widget.btn.show(),WBK.settings.chatBtnOpened&&wsChat.widget.btn.show(),WBK.settings.invaderGeneratorStatId=!1},showWidget:function(i){WBK.settings.windowGeneratorOpened=!0;var n=window.innerHeight/2-a.window.height()/2;n<0&&(n=0),n=(n<0?0:n)+a.window.scrollTop(),a.window.css("top",n+"px"),WBK.settings.callbackEnabled&&wsKiller.widget.btn.hide(),WBK.settings.chatBtnOpened&&wsChat.widget.btn.hide(),WBK.settings.chatInvitationOpened&&wsChat.hideInvitation(),WBK.settings.windowOpened||(a.windowbgr.show(),a.window.show(),WBK.setPhoneInputFocusForm(e(".white-saas-generator-userphone"))),t.sendEvents("show",i)},closeWidget:function(){var e=new Date;"minutes"==i.repeatShowType?e.setMinutes(e.getMinutes()+parseInt(i.repeatShowTime)):"days"==i.repeatShowType&&e.setDate(e.getDate()+parseInt(i.repeatShowTime)),wsUtil.setCookie("WhiteGenerator_closed_"+WBK.settings.generatorId,!0,e),t.hideWidget(),t.sendEvents("close"),t.sendGoal("close")},sendEvents:function(t,i){var n=WBK.settings.serverUrl+"/api?action=genEvent&callback=?";e.getJSON(n,{event:t,openType:i,invaderId:"invader"==i&&WBK.settings.invaderId,instinctId:"instinct"==i&&WBK.settings.instinctId,generatorStatId:WBK.settings.generatorStatId,generatorId:WBK.settings.generatorId,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId},function(e){"undefined"!=typeof e.Data.genStatId&&("show"===t?WBK.settings.generatorStatId=e.Data.genStatId:WBK.settings.generatorStatId=!1)})},sendGoal:function(e){var t,i,n=!1,a="Generator";switch(e){case"lead":t="GEN_LEAD",i="NewLead",n=!0;break;case"close":t="GEN_CANCEL",i="CancelLead"}wsUtil.sendGoal(t,i,a,n)},setDefaultSettings:function(){var t={firstApperance:3,reapperance:60,textGeneralColorBackground:!1,textGeneralColorText:!1,btnSuccessColor:!1,btnCancelColor:!1,counterTime:!1,counterTypeInTimer:0,dateEnd:!1,dateEndTime:!1,dateEndWeekday:!1,dateHours:!1,getEmail:!1,getName:!1,getPhone:!1,imgBackground:0,imgBackgrouundService:0,pausedSeconds:!1,repeatShowTime:!1,repeatShowType:!1,showEnter:!1,showScrollValue:0,showBehavioralValue:0,sendAction:!1,sendActionUrl:!1,showExit:!1,timerEnable:!1,autoCall:0,autoCallText:"0",autoCallDeffered:0,autoCallDefferedDelay:0,isPayed:!1,hasMoneyForLead:!1,closeClickBgr:0,counterBgrColor:!1,counterNumberColor:!1,leadId:!1,partnerLink:!1,textGeneralFormat:!1,textGeneralPositionGorizontal:!1,textGeneralPositionVertical:!1,textGeneralFontFamily:!1,textGeneralFontSize:!1,emailService:"off",emailAgreement:0,langText:{},noShowTimeout:0,noShow:0,containerShadow:!1,sendingLead:!1,hideTablet:!1,hideBackgroundSite:1};e.extend(!0,i,t)},setTemplate:function(){n={windowBgr:'<div class="cbk-window-bgr"></div>',window:'<div class="white-saas-generator"><div class="white-saas-generator-container"><div class="white-saas-generator-left-block"><img class="white-saas-generator-image" src="//saas-support.com/widget/img/background.jpg"><div class="white-saas-generator-text-general"><span class="white-saas-generator-text-general-span">'+i.langText.text_general+'</span></div></div><div class="white-saas-generator-right-block"><div class="white-saas-generator-success"><span class="white-saas-generator-success-text">'+i.langText.text_success+'</span><div class="white-saas-generator-buttons"><a href="#" class="white-saas-generator-btn-yes">'+i.langText.text_btn_yes+'</a></div></div><div class="white-saas-generator-text-sub">'+i.langText.text_sub+'</div><div class="white-saas-generator-counter"><div class="white-saas-generator-counter-title">'+i.langText.text_counter_title+'</div><div class="white-saas-generator-counter-clock"><div class="white-saas-generator-counter-dig"><div class="white-saas-generator-counter-block"><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div></div><div class="white-saas-generator-counter-number white-saas-generator-counter-number-hours">00</div><div class="white-saas-generator-counter-name">'+i.langText.text_counter_hours+'</div></div><div class="white-saas-generator-counter-dz"><div class="white-saas-generator-counter-dz-block"></div><div class="white-saas-generator-counter-dz-block"></div></div><div class="white-saas-generator-counter-dig"><div class="white-saas-generator-counter-block"><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div></div><div class="white-saas-generator-counter-number white-saas-generator-counter-number-minutes">00</div><div class="white-saas-generator-counter-name">'+i.langText.text_counter_minutes+'</div></div><div class="white-saas-generator-counter-dz"><div class="white-saas-generator-counter-dz-block"></div><div class="white-saas-generator-counter-dz-block"></div></div><div class="white-saas-generator-counter-dig"><div class="white-saas-generator-counter-block"><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div><div class="white-saas-generator-block-min"></div></div><div class="white-saas-generator-counter-number white-saas-generator-counter-number-seconds">00</div><div class="white-saas-generator-counter-name">'+i.langText.text_counter_seconds+'</div></div></div></div><div class="white-saas-generator-group"><input type="text" class="white-saas-generator-group-input white-saas-generator-username" placeholder="'+i.langText.text_placeholder_username+'"><small class="white-saas-generator-username-error white-saas-generator-error-hidden">'+i.langText.error_name+'</small></div><div class="white-saas-generator-group"><input type="text" class="white-saas-generator-group-input white-saas-generator-userphone" placeholder="'+i.langText.text_placeholder_userphone+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/><small class="white-saas-generator-userphone-error white-saas-generator-error-hidden">'+i.langText.error_phone+'</small></div><div class="white-saas-generator-group"><input type="email" class="white-saas-generator-group-input white-saas-generator-useremail" placeholder="name@example.com"><small class="white-saas-generator-useremail-error white-saas-generator-error-hidden">'+i.langText.error_email+'</small></div><div class="white-saas-generator-group"><label class="white-saas-generator-label-agreement"><input type="checkbox" class="white-saas-generator-email-agreement" checked><span class="white-saas-generator-email-agreement-text">'+i.langText.email_agreement_text+'</span></label></div><div class="white-saas-generator-buttons"><a href="javascript:void(0)" class="white-saas-generator-btn-success">'+i.langText.btn_success_text+'</a><a href="javascript:void(0)" class="white-saas-generator-btn-cancel">'+i.langText.btn_cancel_text+'</a></div><div class="white-saas-generator-copyright"><a href="#" class="white-saas-generator-copyright-url" target="_blank" data-widget="generator">'+i.langText.text_link+"</a></div></div></div></div>"}},log:function(e){wsUtil.log("GENERATOR : "+e)}}}(jWS),wsChat=function(e){var t,i,n,a,s;return{settings:{},templates:{},widget:{},init:function(o){t=this,i=this.settings,n=this.templates,a=this.widget,e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),s=WBK.checkDebug(),t.loader(o)},loader:function(n){var a=n.Data.chat;if(t.setSettings(a),!parseInt(i.hide_mobile)||"pc"===WBK.settings.device){if(WBK.settings.chatEnabled=!0,WBK.settings.chatWidgetId=parseInt(n.Settings.chatWidgetId),WBK.settings.chatId=!!a.chatId&&parseInt(a.chatId),i.all_operators=a.users?a.users:{},i.chat_operators=a.chatUsers?a.chatUsers:{},i.free_chat_widget=parseInt(i.free_chat_widget),i.free_chat_widget&&s&&t.log("  "),parseInt(i.always_online)&&!i.free_chat_widget&&e.each(i.all_operators,function(e,t){i.all_operators[e].status=1}),i.chat_is_online=t.operatorsIsOnline(),i.partnerLink||(i.partnerLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=chat&utm_term=",WBK.settings.thisIsCallbackKILLER&&(i.partnerLink="http://cb-killer.ru/chat/?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=chat&utm_term=")),i.widget_logo=parseInt(a.img_logo),i.img_robot_logo=parseInt(a.img_robot_logo),i.img_robot_logo_service=parseInt(a.img_robot_logo_service),i.chat_widget_logo=WBK.settings.staticServerUrl+"/widget/img/chat_robot.png",i.chat_widget_logo_robot=i.chat_widget_logo,i.img_robot_logo_service){var o=new Date;i.chat_widget_logo_robot=WBK.settings.staticServerUrl+"/uploaded/chat_widgets_service/"+WBK.settings.serviceid+"/logo_robot.png?"+o.getTime()}if(i.img_robot_logo){var o=new Date;i.chat_widget_logo_robot=WBK.settings.staticServerUrl+"/uploaded/chat_widgets/"+WBK.settings.chatWidgetId+"/logo_robot.png?"+o.getTime()}if(i.widget_logo){var o=new Date;i.chat_widget_logo=WBK.settings.staticServerUrl+"/uploaded/chat_widgets/"+WBK.settings.chatWidgetId+"/logo.png?"+o.getTime()}switch(i.btn_corner_class="",i.corner_type){case"smooth":i.btn_corner_class="ws-chat-btn-mini-round";break;case"flat":i.btn_corner_class="";break;case"round":i.btn_corner_class="ws-chat-btn-round"}t.updateUser(),t.setTemplate(),t.initWidget()}},initWidget:function(){WBK.loadFont(),WBK.addStyles(".ws-chat-message-manager .ws-chat-message, .ws-chat-message-robot .ws-chat-message, .ws-chat-message-manager:before, .ws-chat-message-robot:before{background-color: "+i.color_background_message_operator+" !important;}.ws-chat-message-user .ws-chat-message, .ws-chat-message-user:before{background-color: "+i.color_background_message_user+" !important;}.ws-chat-message-manager .ws-chat-message-source, .ws-chat-message-manager .ws-chat-message-date, .ws-chat-message-robot .ws-chat-message-source, .ws-chat-message-robot .ws-chat-message-date{color: "+i.color_text_message_operator+" !important;}.ws-chat-message-user .ws-chat-message-source, .ws-chat-message-user .ws-chat-message-date{color: "+i.color_text_message_user+" !important;}.ws-chat .ws-chat-invitation-container{background-color: "+i.color_background_invitation+" !important;}.ws-chat .ws-chat-invitation-text{background-color: "+i.color_background_invitation_message+" !important;}.ws-chat .ws-chat-invitation-body-text:before{background-color: "+i.color_background_invitation_message+" !important;}.ws-chat .ws-chat-invitation-input{background-color: "+i.color_background_invitation_input+" !important;}.ws-chat .ws-chat-invitation-name{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-position{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-container .ws-icon-close{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-typing{color: "+i.color_text_invitation+" !important;}.ws-chat .ws-chat-invitation-container .ws-chat-invitation-body .ws-chat-invitation-body-el .ws-chat-invitation-text{color: "+i.color_text_invitation_message+" !important;}"),
a.container=e(n),a.window=a.container.find(".ws-chat-container").hide(),a.btn=a.container.find(".ws-chat-btn-container").hide(),a.btn_el=a.container.find(".ws-chat-btn-el-container"),a.invitation=a.container.find(".ws-chat-invitation-container").hide(),a.container.appendTo("body");var o=i.text_button_online;"pc"!=WBK.settings.device?(a.container.addClass("ws-chat-mobile"),o=i.mobile_text_button_online,WBK.addStyles(".ws-chat .ws-chat-btn-container{background: "+i.mobile_color_background_button+"!important;}.ws-chat .ws-chat-btn-container .ws-btn-title{color: "+i.mobile_color_background_button_text+"!important;}")):(a.btn.addClass(i.btn_corner_class),WBK.addStyles(".ws-chat .ws-chat-btn-container{background: "+i.color_background_button+"!important;}.ws-chat .ws-chat-btn-container .ws-btn-title{color: "+i.color_background_button_text+"!important;}")),a.btn.find(".ws-btn-title").html(o),i.widget_logo&&(a.window.addClass("ws-chat-logo-yes"),a.btn.addClass("ws-chat-btn-logo-yes")),(i.img_robot_logo||i.img_robot_logo_service)&&a.window.addClass("ws-chat-logo-robot-yes");var r=wsUtil.getCookie("WidgetChat_sound_"+WBK.settings.chatWidgetId);if(r?(i.sound=r,"off"==i.sound?(a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_on),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")):(a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_off),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-off").addClass("ws-icon-sound-on"))):"off"==i.sound&&(a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_on),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")),WBK.settings.hideCopyright?e(".ws-chat-copyright").hide():e("body").on("click",".ws-chat-copyright-url",function(t){WBK.sendAdvertLinkStat(e(this).data("widget"),e(this).attr("href"),e(this).text(),WBK.settings.chatWidgetId)}),t.loadBtnEvents(),t.loadWindowEvents(),i.messages_quant_to_rate=0,i.chat_is_online)WBK.settings.chatId&&i.messages?(t.addOldMessages(),t.operatorsUpdate(),t.start()):(i.operators_array.length?t.showHelloMessageOperators():t.showHelloMessage(),i.is_first_message=!0,i.send_autoreply_first=!0),t.initRating(),t.checkRatingSettings();else{if("hide"==i.operator_offline_action)return void(s&&t.log("     "));t.showOffline()}t.initBtnPosition(),t.smilesInit(),"pc"!=WBK.settings.device||WBK.settings.chatId||"hide"==i.button_location||t.checkInvitation();var l;if(!e.fn._frameCheck()||"undefined"!=typeof WBK)try{l=window.top.location.hash}catch(c){}wsUtil.getCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId)&&wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId)&&i.chat_is_online?t.showWidget():"#showchat"===l?(t.initWindowPosition(),t.showWidget(),t.sendGoal("open")):(a.btn.show(),WBK.settings.chatBtnOpened=!0,wsUtil.getCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId)&&wsUtil.deleteCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId),t.initWindowPosition(),"hide"==i.button_location&&(a.btn.hide(),WBK.settings.chatBtnOpened=!1)),WBK.Sound("no_sound")},showBtn:function(){a.btn.show(),"horizontal"==i.button_location&&WBK.animateFastOnce(a.btn,"cbk-zoomIn"),WBK.settings.chatBtnOpened=!0},hideBtn:function(){a.btn.hide(),WBK.animateFastOnce(a.btn,"cbk-zoomOut"),WBK.settings.chatBtnOpened=!1},showWidget:function(){t.hideBtn(),WBK.settings.chatInvitationOpened&&t.hideInvitation(),WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide());var n=new Date;if(n.setMinutes(n.getMinutes()+1440),wsUtil.setCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId,!0,n),i.chat_is_online&&"pc"==WBK.settings.device&&wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId)){var s=JSON.parse(wsUtil.getCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId));a.window.css({top:s.top,left:s.left,width:s.width,height:s.height})}if("pc"!=WBK.settings.device&&(i.scroll_left=e(window).scrollLeft(),i.scroll_top=e(window).scrollTop(),e("meta[name=viewport]").length?(a.window.data("oldViewport",e("meta[name=viewport]").attr("content")),e("meta[name=viewport]").remove()):a.window.data("noViewport",1),e("head").append(e("<meta>").attr("name","viewport").attr("content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")),e("body").addClass("cbk-body-mobile")),a.window.show(),"pc"==WBK.settings.device&&WBK.animateFastOnce(a.window,"cbk-zoomIn"),WBK.settings.chatWindowOpened=!0,i.chat_is_online&&"pc"==WBK.settings.device&&a.window.find(".ws-textarea").focus(),i.chatId&&i.chat_created){var o=(new Date).getTime();t.sendNode(JSON.stringify(""),o,"open_window")}else{var r=wsUtil.getStorage("WidgetChat_last_shown_invitation_id");if(!WBK.settings.chatInvitationShown&&r){WBK.settings.chatInvitationShown=!0;var l=!1;if(e.each(i.invitations,function(e,t){i.invitations[e].id==r&&(l=e)}),l&&(i.invitation_operator_id=t.getOperatorIdForInvitation(l),i.invitations[l]=t.formatInvitation(i.invitations[l]),i.chat_is_online&&parseInt(i.invitations[l].invitation_always))){var c=i.invitation_operator_id.split("_");i.invitation_show_data={user_id:c[0],employee_id:c[1],invitation_id:i.invitations[l].id,hello_text:i.invitations[l].hello_text,text1:i.invitations[l].text1,text2:i.invitations[l].text2};var s={hash:!1,message:"",date:"",user:i.invitation_operator_id,is_read:!0,message_type:"text",type:"manager",scroll:!1};a.window.find(".ws-chat-robot-hello, .ws-chat-manager-hello, .ws-chat-message-block").remove(),i.invitations[l].hello_text&&(s.message={text:i.invitations[l].hello_text},t.addMessage(s)),i.invitations[l].text1&&(s.message={text:i.invitations[l].text1},s.date="",t.addMessage(s)),i.invitations[l].text2&&(s.message={text:i.invitations[l].text2},s.date="",t.addMessage(s))}}}a.window.find(".ws-chat-body").nanoScroller({scroll:"bottom",contentClass:"ws-chat-body-content",paneClass:"ws-chat-body-pane",sliderClass:"ws-chat-body-slider ",preventPageScrolling:!0}),a.window.find(".ws-textarea-group").nanoScroller({scroll:"bottom",contentClass:"ws-textarea",paneClass:"ws-textarea-pane",sliderClass:"ws-textarea-slider ",preventPageScrolling:!0})},hideWidget:function(){a.window.hide(),WBK.animateFastOnce(a.window,"cbk-zoomOut"),WBK.settings.chatWindowOpened=!1;var n=new Date;if(n.setMinutes(n.getMinutes()+144e3),wsUtil.deleteCookie("WidgetChat_opened_"+WBK.settings.chatWidgetId),"pc"!=WBK.settings.device&&(a.window.data("noViewport")?(a.window.data("noViewport",0),e("meta[name=viewport]").attr("content","")):e("meta[name=viewport]").attr("content",a.window.data("oldViewport")),e("body").removeClass("cbk-body-mobile"),e(window).scrollTop(i.scroll_top),e(window).scrollLeft(i.scroll_left)),"hide"!=i.button_location&&t.showBtn(),i.chat_created){var s=(new Date).getTime();t.sendNode(JSON.stringify(""),s,"close_window")}if(!i.chat_is_online){var o=a.window.find(".ws-chat-body-offline");o.children().not(".ws-hide").show(),o.find(".ws-chat-offline-text-success").hide(),wsUtil.deleteTimeout("chatOfflineHide")}},checkInvitation:function(){if(!i.invitations||i.free_chat_widget)return void(s&&t.log("    "));s&&t.log(" ");for(var n=0;n<i.invitations.length;n++)if(wsUtil.getCookie("WidgetChat_invitation_"+i.invitations[n].id))s&&t.log("  "+i.invitations[n].id+"   ");else if(i.invitations[n].rules.length){var a=0,o=0,r=0,l=1,c=[],d=decodeURIComponent(window.location.toString());d||(d=window.location.toString()),e.each(i.invitations[n].rules,function(e,n){switch(n.name){case"rule_url":switch(parseInt(n.type)){case 0:d.indexOf(n.value)+1?o++:a++;break;case 1:d.indexOf(n.value)+1==0?o++:a++;break;case 2:d==n.value?o++:a++;break;case 3:var s=new RegExp(n.value,"gi");s.test(d)?o++:a++}break;case"rule_time":c.push(parseInt(n.value)),r++;break;case"rule_time_site":var l=wsUtil.getCookie("WhiteCallback_timeAll")?parseInt(wsUtil.getCookie("WhiteCallback_timeAll")):1,u=parseInt(n.value)-l;c.push(u>1?u:1),r++;break;case"rule_time_close_chat":var h=t.getTimeClosedChat();h?(h=(new Date).setTime(h),h=parseInt(n.value)-((new Date).getTime()-h)/1e3,c.push(h>1?h:1)):c.push(1),r++;break;case"rule_operator":i.chat_is_online?"offline"==n.value?a++:o++:"online"==n.value?a++:o++;break;case"rule_visit_count":var g=WBK.getVisitCount();switch(parseInt(n.type)){case 0:parseInt(n.value)==g?o++:a++;break;case 1:parseInt(n.value)<g?o++:a++;break;case 2:parseInt(n.value)>g?o++:a++}break;case"rule_page_show_count":var p=WBK.getPageShowCount();switch(parseInt(n.type)){case 0:parseInt(n.value)==p?o++:a++;break;case 1:parseInt(n.value)<p?o++:a++;break;case 2:parseInt(n.value)>p?o++:a++}}}),a&&s&&t.log("      "+i.invitations[n].id),"all"==i.invitations[n].check&&0==a&&(s&&t.log("      "+i.invitations[n].id),c.length>0&&(l=Math.max.apply(null,c)),s&&t.log("  : "+l),t.showInvitation(n,l)),"one"==i.invitations[n].check&&(o>0||r>0)&&(s&&t.log(" 1     "+i.invitations[n].id),o>0?l=1:c.length>0&&(l=Math.min.apply(null,c)),s&&t.log("  : "+l),t.showInvitation(n,l))}else t.showInvitation(n,1)},hideInvitation:function(){WBK.settings.chatInvitationOpened=!1,a.invitation.hide()},getOperatorIdForInvitation:function(e){var t=!1,n=wsUtil.getStorage("WidgetChat_invitation_operator_id"),a=i.operators_id;return i.chat_is_online&&(a=i.operators_online_id),n&&(i.all_operators.hasOwnProperty(n)||(n=!1)),"operator"==i.invitations[e].operator_type?(t=i.invitations[e].operator_id,i.all_operators.hasOwnProperty(t)||(t=n?n:a[wsUtil.getRandomArbitrary(0,a.length-1)])):t=n?n:a[wsUtil.getRandomArbitrary(0,a.length-1)],wsUtil.setStorage("WidgetChat_invitation_operator_id",t),t},showInvitation:function(n,s){WBK.settings.chatId||WBK.settings.chatWindowOpened||i.show_one_invitation||wsUtil.setInterval("invitationShow_"+n,function(){if(!(WBK.settings.chatInvitationOpened||WBK.settings.windowGeneratorOpened||WBK.settings.windowInvaderOpened||WBK.settings.windowOpened||WBK.settings.chatId||WBK.settings.chatWindowOpened||i.show_one_invitation)){wsUtil.setStorage("WidgetChat_last_shown_invitation_id",i.invitations[n].id),WBK.settings.chatInvitationOpened=!0,WBK.settings.chatInvitationShown=!0,i.show_one_invitation=!0;for(var s=0;s<i.invitations.length;s++)wsUtil.deleteInterval("invitationShow_"+s);var o=new Date;"minutes"==i.invitations[n].repeat_type?o.setMinutes(o.getMinutes()+parseInt(i.invitations[n].repeat_time)):"days"==i.invitations[n].repeat_type&&o.setDate(o.getDate()+parseInt(i.invitations[n].repeat_time)),wsUtil.setCookie("WidgetChat_invitation_"+i.invitations[n].id,"true",o),i.invitation_operator_id=t.getOperatorIdForInvitation(n);var r=i.invitation_operator_id;if(i.invitations[n]=t.formatInvitation(i.invitations[n]),i.chat_is_online){var l=r.split("_");i.invitation_show_data={user_id:l[0],employee_id:l[1],invitation_id:i.invitations[n].id,hello_text:i.invitations[n].hello_text,text1:i.invitations[n].text1,text2:i.invitations[n].text2};var c={hash:!1,message:"",date:"",user:r,is_read:!0,message_type:"text",type:"manager",scroll:!1};a.window.find(".ws-chat-robot-hello, .ws-chat-manager-hello, .ws-chat-message-block").remove(),i.invitations[n].hello_text&&(c.message={text:i.invitations[n].hello_text},t.addMessage(c)),i.invitations[n].text1&&(c.message={text:i.invitations[n].text1},c.date="",t.addMessage(c)),i.invitations[n].text2&&(c.message={text:i.invitations[n].text2},c.date="",t.addMessage(c))}if("open_chat"==i.invitations[n].action)return void t.showWidget();a.invitation.find(".ws-chat-invitation-logo").append('<img class="ws-chat-invitation-img" src="'+WBK.settings.staticServerUrl+i.users[r].img+'">');var d=i.users[r].name+(i.users[r].surname?" "+i.users[r].surname:""),u=i.users[r].profession?i.users[r].profession:"";a.invitation.find(".ws-chat-invitation-body-text").before('<div class="ws-chat-invitation-name">'+d+'</div><div class="ws-chat-invitation-position">'+u+"</div>"),a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text">'+i.invitations[n].hello_text+"</div>");var h=e('<div class="ws-chat-invitation-typing"><span class="ws-chat-typing-action"><i class="ws-icon-typing"></i></span><span class="ws-chat-invitation-typing-name">'+d+"</span> "+i.lang_text.typing+"...</div>");a.invitation.find(".ws-chat-invitation-body-text").append(h.fadeIn()),a.invitation.show(),WBK.animateFastOnce(a.invitation,"cbk-zoomIn"),wsUtil.setTimeout("invitationMessageTimer",function(){a.invitation.find(".ws-chat-invitation-typing").fadeOut(function(){i.invitations[n].text1&&(e(this).remove(),a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text">'+i.invitations[n].text1+"</div>")),wsUtil.setTimeout("invitationMessageTimer",function(){a.invitation.find(".ws-chat-invitation-body-text").append(h.fadeIn()),wsUtil.setTimeout("invitationMessageTimer",function(){a.invitation.find(".ws-chat-invitation-typing").fadeOut(function(){e(this).remove(),i.invitations[n].text2&&a.invitation.find(".ws-chat-invitation-body-text").append('<div class="ws-chat-invitation-text">'+i.invitations[n].text2+"</div>")})},110*wsUtil.specialChars(i.invitations[n].text2).length)},1e3)})},110*wsUtil.specialChars(i.invitations[n].text1).length)}},1e3*s)},formatInvitation:function(e){return e.hello_text=WBK.formatText(e.hello_text),e.text1=WBK.formatText(e.text1),e.text2=WBK.formatText(e.text2),i.geo_city&&(i.geo_city.name||(i.geo_city.name=i.geo_city.ip_city),e.hello_text=e.hello_text.replace(/\[geocity1\]/g,i.geo_city.name),e.hello_text=e.hello_text.replace(/\[geocity2\]/g,i.geo_city.name_rod),e.hello_text=e.hello_text.replace(/\[geocity3\]/g,i.geo_city.name_mes),e.text1=e.text1.replace(/\[geocity1\]/g,i.geo_city.name),e.text1=e.text1.replace(/\[geocity2\]/g,i.geo_city.name_rod),e.text1=e.text1.replace(/\[geocity3\]/g,i.geo_city.name_mes),e.text2=e.text2.replace(/\[geocity1\]/g,i.geo_city.name),e.text2=e.text2.replace(/\[geocity2\]/g,i.geo_city.name_rod),e.text2=e.text2.replace(/\[geocity3\]/g,i.geo_city.name_mes)),e},smilesInit:function(){for(var n=32,s=a.window.find(".ws-smile-container"),o=0,r=0;r<n;r++)s.append('<a class="ws-emoji-el" href="#"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" class="ws-emoji" style="background-position: 0px -'+o+'px;"></a>'),o+=17;a.window.find(".ws-emoji-el").on("click",function(n){n.preventDefault(),i.chat_is_online?(a.window.find(".ws-textarea").focus(),t.insertHTML(e(this).html())):a.window.find(".ws-offline-textarea").append(e(this).html()),a.window.find(".ws-textarea-send-btn").show()})},showOffline:function(){a.window.addClass("ws-chat-offline"),a.btn.find(".ws-chat-status-online").removeClass("ws-chat-status-online"),"pc"!=WBK.settings.device?a.btn.find(".ws-btn-title").html(i.mobile_text_button_offline):a.btn.find(".ws-btn-title").html(i.text_button_offline),a.window.find(".ws-chat-title").html(i.text_button_offline),a.window.find(".ws-chat-body").hide(),a.window.find(".ws-chat-footer").hide(),a.window.find(".ws-chat-status-online").removeClass("ws-chat-status-online"),a.window.find(".ws-chat-body-offline").show(),WBK.setPhoneInputFocusForm(e(".ws-offline-phone"))},sendOfflineMessage:function(){if(!i.offline_message_sending){i.offline_message_sending=!0;var n=a.window.find(".ws-chat-body-offline");n.find(".ws-offline-textarea").removeClass("ws-input-error"),n.find(".ws-offline-input").removeClass("ws-input-error");var s=n.find(".ws-offline-name").val(),o=n.find(".ws-offline-email").val(),r=n.find(".ws-offline-phone").val();r=WBK.checkPhone(r)?r:"";var l=n.find(".ws-offline-phone").attr("placeholder"),c=e(".ws-offline-email-agreement").is(":checked")?1:0,d=t.cleanMessage(n.find(".ws-offline-textarea")),u="";if("yes"==i.get_contact_offline_name&&""==s.trim()&&(u=".ws-offline-name"),"yes"==i.get_contact_offline_phone&&""==r.trim()&&(u?u+=", .ws-offline-phone":u=".ws-offline-phone"),"yes"!=i.get_contact_offline_email||""!=o.trim()&&wsUtil.validateEmail(o.trim())||(u?u+=", .ws-offline-email":u=".ws-offline-email"),"yes"==i.get_contact_offline_message&&""==d.trim()&&(u?u+=", .ws-offline-textarea":u=".ws-offline-textarea"),u)return void a.window.find(u).addClass("ws-input-error");var h=WBK.settings.serverUrl+"/api?action=chatOfflineMessage&callback=?";jWS.getJSON(h,{code:WBK.settings.whiteSaasCode,name:s.trim(),email:o.trim(),phone:r.trim(),message:d.trim(),emailAgreement:c,visitId:WBK.settings.visitId,chatWidgetId:WBK.settings.chatWidgetId,chatId:WBK.settings.chatId,url:"string"==typeof document.URL?document.URL:"",visitorId:WBK.settings.visitorId,phoneMask:l,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId()},function(e){if(1==e.Success){var n=a.window.find(".ws-chat-body-offline");n.children().not(".ws-hide").hide(),n.find(".ws-offline-textarea").text(""),n.find(".ws-chat-offline-text-success").show(),wsUtil.setTimeout("chatOfflineHide",function(){t.hideWidget()},3e3),i.offline_message_sending=!1}}),t.sendGoal("offline_message")}},showHelloMessage:function(){var e='<div class="ws-chat-manager-join ws-chat-robot-hello"><img src="'+i.chat_widget_logo_robot+'" alt="" class="ws-manager-img"><div class="ws-manager-event">'+i.hello_message+"</div></div>";a.window.find(".ws-chat-typing").before(e)},showHelloMessageOperators:function(){i.operators_array.sort(function(e,i){return e=t.formatTextToDate(e.connected_at),i=t.formatTextToDate(i.connected_at),e<i?1:e>i?-1:0});for(var e="",n=0;n<i.operators_array.length;n++){var s=i.operators_array[n].user_id+"_"+i.operators_array[n].employee_id,o=i.all_operators[s].name+(i.all_operators[s].surname?"<br>"+i.all_operators[s].surname:"");if(e+='<div class="ws-chat-manager-hello-el"><img src="'+WBK.settings.staticServerUrl+i.all_operators[s].img+'" class="ws-manager-hello-img"><div class="ws-manager-name">'+o+"</div></div>",2==n)break}var r='<div class="ws-chat-manager-join ws-chat-manager-hello"><div class="ws-chat-manager-hello-body">'+e+'</div><div class="ws-manager-event">'+i.hello_message+"</div></div>";a.window.find(".ws-chat-typing").before(r)},operatorsUpdate:function(e){var n="";if(e){var s=e.user_id+"_"+e.employee_id;i.all_operators.hasOwnProperty(s)&&(i.all_operators[s].status=e.status)}if(a.window.removeClass("ws-chat-ico-bottom"),a.window.find(".ws-chat-ico-container").empty(),i.chat_operators)for(var o in i.chat_operators)if(i.chat_operators.hasOwnProperty(o)&&"undefined"!=typeof i.all_operators[o]){var r=i.all_operators[o].name+(i.all_operators[o].surname?" "+i.all_operators[o].surname:"");parseInt(i.all_operators[o].status)&&(n+=n?", "+r:r),t.addIco(i.all_operators[o].user_id+"_"+i.all_operators[o].employee_id,i.all_operators[o].img,r,parseInt(i.all_operators[o].status))}n?a.window.find(".ws-chat-title").text(n):a.window.find(".ws-chat-title").text(i.text_button_online)},addIco:function(e,t,n,s){a.window.hasClass(".ws-chat-ico-bottom")||(a.window.addClass("ws-chat-ico-bottom"),a.window.offset().left<100?a.window.addClass("ws-chat-ico-bottom-right"):a.window.removeClass("ws-chat-ico-bottom-right"));var o="";s&&(o="ws-chat-status-online");var r='<div class="ws-chat-ico" id="ico_'+e+'" style="background-color: '+i.color_background_chat_header+';"><div class="ws-chat-logo" data-name="'+n+'"><i class="ws-icon-chat"></i><img src="'+WBK.settings.staticServerUrl+t+'" class="ws-chat-logo-img" title="'+n+'"><div class="ws-chat-status-round '+o+'"></div></div></div>';a.window.find(".ws-chat-ico-container").append(r)},updateIcoBottom:function(e){var t=a.window.find(".ws-chat-ico-container");t.find("#ico_"+e).appendTo(t)},addOldMessages:function(){for(var e=0;e<i.messages.length;e++)if(i.messages[e].message=JSON.parse(i.messages[e].message),"auto_reply"!=i.messages[e].type||i.messages[e].user_id)if("rating"!=i.messages[e].type){var n=i.messages[e].user_id?"manager":"user",a="manager"==n&&i.messages[e].user_id+"_"+i.messages[e].employee_id;t.addMessage({id:i.messages[e].id,hash:i.messages[e].hash,type:n,message:i.messages[e].message,date:i.messages[e].created_at,user:a,is_read:!!parseInt(i.messages[e].is_read),message_type:i.messages[e].type,scroll:!1}),parseInt(i.messages[e].is_read)||(i.unread_messages[i.messages[e].hash]={id:i.messages[e].id,hash:i.messages[e].hash}),"manager"==n&&(i.last_operator_data={user_id:i.messages[e].user_id,employee_id:i.messages[e].employee_id},i.send_autoreply=!0)}else t.addMessageRobot(i.messages[e]);else{var s={message:i.messages[e].message.text,type:"auto_reply"};t.addMessageRobot(s)}},addMessageRobot:function(e){if(e){var n="";switch(e.type){case"text":case"auto_reply":if(e.message=wsUtil.specialChars(e.message),e.auto_reply_get_contact){var s=i.autoreplies[e.auto_reply_index].text_btn?i.autoreplies[e.auto_reply_index].text_btn:i.lang_text.autoreply_link;e.message=e.message+'<br><div class="ws-chat-autoreply-link"><a data-index="'+e.auto_reply_index+'" class="ws-chat-autoreply-btn" href="#">'+s+"</a></div>";var o=new Date;o.setMinutes(o.getMinutes()+43200),wsUtil.setCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId,!0,o)}n='<div class="ws-chat-message-source">'+e.message+"</div>";break;case"preform":n='<div class="ws-chat-message-source">'+i.lang_text.preform_text+'</div><input class="ws-chat-message-input" placeholder="'+i.lang_text.form_name+'">';break;case"load":n='<div class="ws-chat-message-source">'+i.lang_text.loading+' ...</div><div class="ws-chat-progress"><div class="ws-chat-progress-bar"></div></div>';break;case"rating":t.hideRating();var r='<img class="ws-chat-message-rating-el ws-chat-message-rating-el-1" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-2" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-3" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-4" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""><img class="ws-chat-message-rating-el ws-chat-message-rating-el-5" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt="">';"smiles"==i.rate_chat_view&&(r='<img class="ws-chat-message-rating-el" src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt="">');var l="";switch(parseInt(e.message.rate)){case 1:l=i.lang_text.rate_text_1;break;case 2:l=i.lang_text.rate_text_2;break;case 3:l=i.lang_text.rate_text_3;break;case 4:l=i.lang_text.rate_text_4;break;case 5:l=i.lang_text.rate_text_5}n='<div class="ws-chat-message-source">'+i.lang_text.rate_result+'</div></div><div class="ws-chat-message"><div class="ws-chat-message-source"><div class="ws-chat-message-rating ws-chat-message-rating-'+i.rate_chat_view+" ws-chat-message-rating-rate-"+e.message.rate+'">'+r+"</div>"+l+"</div>"}var c='<div class="ws-chat-message-block ws-chat-message-robot"><div class="ws-chat-message-logo"><img class="ws-chat-message-logo-img" src="'+i.chat_widget_logo_robot+'"></div><div class="ws-chat-message-name"><span class="ws-chat-message-name-text" data-name="">'+i.robot_name+'</span></div><div class="ws-chat-message">'+n+"</div></div>";a.window.find(".ws-chat-typing").before(c),"load"==e.type&&a.window.find(".ws-chat-body-content .ws-chat-message-robot").last().find(".ws-chat-progress-bar").animate({width:"70%"},4e3),WBK.settings.chatWindowOpened&&t.scroll()}},sendGoal:function(e){if(!i.free_chat_widget){var t,n,a,s="ChatService",o=!1;switch(e){case"open":t="CHAT_SHOW_ON_BTN",n=a="ChatShowOnBtn",o=!0;break;case"first_message":t="CHAT_FIRST_MESSAGE",n=a="ChatFirstMessage",o=!0;break;case"offline_message":t="CHAT_OFFLINE_MESSAGE",n=a="ChatOfflineMessage",o=!0;break;case"visitor_introduced":t="CHAT_VISITOR_INTRODUCED",n=a="ChatVisitorIntroduced",o=!0;break;case"operator_connect":t="CHAT_OPERATOR_CONNECT",n=a="ChatOperatorConnect",o=!0}wsUtil.sendGoal(t,n,s,o)}},checkAutoReply:function(e,n){for(var a=0;a<i.autoreplies.length;a++)e==i.autoreplies[a].action&&t.startAutoReply(a,n)},stopAutoReply:function(e){wsUtil.deleteTimeout("chatTypingAutoreply");for(var t=0;t<i.autoreplies.length;t++)"all"==e?wsUtil.deleteTimeout("auto_reply_"+i.autoreplies[t].id):e==i.autoreplies[t].action&&wsUtil.deleteTimeout("auto_reply_"+i.autoreplies[t].id)},startAutoReply:function(e,n){wsUtil.setTimeout("auto_reply_"+i.autoreplies[e].id,function(){if("not_connected"==i.autoreplies[e].action&&!i.send_autoreply_first)return!1;var a={text:i.autoreplies[e].message};if("not_connected"==i.autoreplies[e].action){var s={message:i.autoreplies[e].message,type:"auto_reply",auto_reply_get_contact:parseInt(i.autoreplies[e].get_contact)&&!wsUtil.getCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId)?1:0,auto_reply_index:e};t.addMessageRobot(s);var o=(new Date).getTime();a&&t.sendNode(JSON.stringify(a),o,"auto_reply")}"not_answer_operator"==i.autoreplies[e].action&&(t.typing(n,50*i.autoreplies[e].message.length),wsUtil.setTimeout("chatTypingAutoreply",function(){var s={hash:!1,message:{text:i.autoreplies[e].message},date:"",user:n.user_id+"_"+n.employee_id,is_read:!0,message_type:"auto_reply",type:"manager",scroll:!0,auto_reply_get_contact:parseInt(i.autoreplies[e].get_contact)&&!wsUtil.getCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId)?1:0,auto_reply_index:e};t.addMessage(s),a.user_id=n.user_id,a.employee_id=n.employee_id;var o=(new Date).getTime();a&&t.sendNode(JSON.stringify(a),o,"auto_reply")},50*i.autoreplies[e].message.length))},1e3*parseInt(i.autoreplies[e].time))},initRating:function(){a.container.find(".ws-chat-rating-btns a").on("mouseenter.wbk_chat",function(){if("stars"==i.rate_chat_view)for(var t=e(this).data("value"),n=1;n<=t;n++)a.container.find("a.ws-chat-rating-el-"+n).addClass("ws-chat-rating-el-marked");else e(this).addClass("ws-chat-rating-el-marked")}).on("mouseleave.wbk_chat",function(){a.container.find("a.ws-chat-rating-el").removeClass("ws-chat-rating-el-marked")})},checkRatingSettings:function(){if(WBK.settings.chatId&&parseInt(i.rate_chat)&&!parseInt(i.chatRate)&&!this.ratingIsVisible()&&i.messages_quant_to_rate>=parseInt(i.rate_chat_messages_quant)){for(var n=1;n<=5;n++)e(new Image).attr("src",WBK.settings.staticServerUrl+"/widget/img/rating/24/smile_"+n+".png").load(function(){}),e(new Image).attr("src",WBK.settings.staticServerUrl+"/widget/img/rating/32/smile_"+n+".png").load(function(){});wsUtil.setTimeout("showRating",function(){t.showRating()},500),a.container.find(".ws-chat-rating-btns a").unbind("click").on("click",function(){i.chatRate=e(this).data("value"),t.hideRating(),t.send({message:{rate:e(this).data("value")},type:"rating",scroll:!0})})}},ratingIsVisible:function(){return a.container.hasClass("ws-chat-has-rating")},showRating:function(){a.container.addClass("ws-chat-has-rating"),WBK.animateFastOnce(a.container.find(".ws-chat-rating"),"cbk-fadeIn")},hideRating:function(){a.container.removeClass("ws-chat-has-rating")},sendNode:function(e,n,a){googleRegistrationIds=[];var s=0;if(i.chat_created){if(jWS.isEmptyObject(i.chat_operators))for(s in i.all_operators)i.all_operators[s].gcm_registration_id&&googleRegistrationIds.push(i.all_operators[s].gcm_registration_id);else for(s in i.chat_operators)i.chat_operators[s].gcm_registration_id&&googleRegistrationIds.push(i.chat_operators[s].gcm_registration_id);t.message(e,n,a,googleRegistrationIds)}else{for(s in i.all_operators)i.all_operators[s].gcm_registration_id&&googleRegistrationIds.push(i.all_operators[s].gcm_registration_id);i.invitation_show_data&&(e=JSON.parse(e),e.invitation=!0,e.invitation_data=i.invitation_show_data,i.invitation_show_data=!1,e=JSON.stringify(e)),t.create(e,n,a,googleRegistrationIds)}"auto_reply"!=a&&"open_window"!=a&&"close_window"!=a&&t.getAutoReply(),i.is_first_message=!1},getAutoReply:function(){!i.free_chat_widget&&i.autoreplies&&(jWS.isEmptyObject(i.chat_operators)?i.is_first_message&&t.checkAutoReply("not_connected"):i.last_operator_data&&i.send_autoreply&&(t.checkAutoReply("not_answer_operator",i.last_operator_data),i.send_autoreply=!1))},send:function(e){var n="",s=(new Date).getTime();if(n=JSON.stringify(e.message),"rating"==e.type?t.addMessageRobot(e):t.addMessage({hash:s,type:"user",message:e.message,date:!1,user:!1,is_read:!1,message_type:e.type,scroll:e.scroll}),i.is_first_message&&t.sendGoal("first_message"),i.is_first_message&&parseInt(i.get_contact))if(i.user_name||i.user_email||i.user_phone){var o=!1;"yes"==i.get_contact_name&&""==i.user_name&&(o=!0),"yes"==i.get_contact_email&&""==i.user_email&&(o=!0),"yes"==i.get_contact_phone&&""==i.user_phone&&(o=!0),o?(i.first_message={message:n,hash:s,type:e.type},t.getContactRobot()):(a.window.find(".ws-textarea").html(""),t.sendNode(n,s,e.type))}else i.first_message={message:n,hash:s,type:e.type},t.getContactRobot();else"rating"!=e.type&&a.window.find(".ws-textarea").html(""),t.sendNode(n,s,e.type);t.inputScroll()},getContactRobot:function(){t.addMessageRobot({type:"preform"}),"no"==i.get_contact_can_refuse?(a.window.find(".ws-textarea").html(i.lang_text.block_input).attr("contenteditable",!1),a.window.find(".ws-textarea-group").addClass("ws-textarea-group-hide")):(t.sendNode(i.first_message.message,i.first_message.hash,i.first_message.type),i.first_message=!1)},sendMessage:function(){var n=[];if(n=t.formatMessage(e(".ws-textarea"))){for(var s=0;s<n.length;s++)""!=n[s].message.text&&t.send({message:n[s].message,type:n[s].type,data:n[s].data,scroll:!0});i.is_first_message||a.window.find(".ws-textarea").html(""),this.checkRatingSettings()}},inputScroll:function(){a.window.find(".ws-textarea")[0].scrollHeight>92&&!i.input_scroll?i.input_scroll=!0:a.window.find(".ws-textarea")[0].scrollHeight<=92&&i.input_scroll&&(i.input_scroll=!1);var e=a.window.find(".ws-textarea").outerHeight();if(i.height_input!=e){var n=62;56==e?n=76:74==e?n=94:e>=92&&(n=112),a.window.find(".ws-chat-body").css("bottom",n),i.height_input=e,t.scroll()}a.window.find(".ws-textarea-group").nanoScroller(),a.window.find(".ws-textarea-group").nanoScroller({scrollBottom:0})},insertHTML:function(e){if(navigator.appName.indexOf("Internet Explorer")!=-1)if(document.selection){var t=document.selection.createRange();t.pasteHTML&&t.pasteHTML(e)}else{var t=document.getSelection().getRangeAt(0),i=document.createElement("span");t.surroundContents(i),i.innerHTML=e,t.collapse(!1)}else e&&document.execCommand("insertHtml",!1,e)},uploadFile:function(n){if(i.fileUploadedCount<5){var a,s=new FormData;switch(n){case"doc":a=e(".ws-file-doc-upload")[0].files[0];break;case"img":a=e(".ws-file-img-upload")[0].files[0],s.append("image_type","image")}if(!a)return;s.append(n,a),s.append("type",n),s.append("chat_id",WBK.settings.chatId),t.uploadFileServer(s,n)}},uploadFileServer:function(i,n){t.addMessageRobot({type:"load"}),e.ajax({type:"POST",url:WBK.settings.serverUrl+"/chat/api/?action=uploadFile",processData:!1,contentType:!1,crossDomain:!0,data:i,dataType:"json",success:function(i){switch(n){case"doc":e(".ws-file-doc-upload").val("");break;case"img":e(".ws-file-img-upload").val("")}a.window.find(".ws-chat-body-content .ws-chat-message-robot").last().find(".ws-chat-progress-bar").stop().animate({width:"100%"},500,function(){if(a.window.find(".ws-chat-body-content .ws-chat-message-robot").last().remove(),"success"===i.status)switch(n){case"doc":var e={message:{file_ico_url:"widget/img/"+i.ico+".png",file_name:i.original_name,file_name_upload:i.save_name,file_size:i.size,file_size_type:i.size_type},type:"attach_file",scroll:!0};t.addFileUploaded(e);break;case"img":var e={message:{img_url:WBK.settings.staticServerUrl+"/"+i.path,file_name:i.original_name,
file_name_upload:i.save_name,img_type:"uploaded"},type:"attach_image",scroll:!0};t.addFileUploaded(e)}else t.addMessageRobot({type:"text",message:i.message})})}})},addFileUploaded:function(e){e&&(i.fileUploaded[(new Date).getTime()]=e,t.updateFilesUploaded())},updateFilesUploaded:function(){var t=this;e(".ws-chat-uploaded-files").empty();var n=0;e.isEmptyObject(i.fileUploaded)||e.each(i.fileUploaded,function(t,i){var a,s,o="";switch(i.type){case"attach_image":o="img",a=i.message.img_url,s=WBK.settings.serverUrl+"/chat/download/?type=image&file="+i.message.file_name_upload+"&filename="+i.message.file_name;break;case"attach_file":o="file",a=WBK.settings.staticServerUrl+"/"+i.message.file_ico_url,s=WBK.settings.serverUrl+"/chat/download/?type=doc&file="+i.message.file_name_upload+"&filename="+i.message.file_name}var r='<div class="ws-chat-uploaded-el" data-index="'+t+'"><div class="ws-chat-uploaded-el-close"><i class="ws-icon-close"></i></div><a class="ws-chat-uploaded-url" href="'+s+'" target="_blank"><img class="ws-chat-uploaded-'+o+'" src="'+a+'"></a></div>';e(".ws-chat-uploaded-files").append(r),n++}),n>0?a.window.find(".ws-textarea-send-btn").show():""==e(".ws-textarea").html()&&a.window.find(".ws-textarea-send-btn").hide(),t.typingPositionUpdate(),i.fileUploadedCount=n},showPreform:function(t,n){void 0==n&&(n=!1),a.window.find(".ws-chat-body").hide(),a.window.find(".ws-chat-footer").hide(),a.window.find(".ws-preform-name").closest(".ws-preform-input-group").removeClass("ws-hide"),a.window.find(".ws-preform-email").closest(".ws-preform-input-group").removeClass("ws-hide"),a.window.find(".ws-preform-phone").closest(".ws-preform-input-group").removeClass("ws-hide");var s="hide",o="hide",r="hide";switch(t){case"preform":s=i.get_contact_name,r=i.get_contact_phone,o=i.get_contact_email;break;case"lead":s=i.autoreplies[n].get_name,r=i.autoreplies[n].get_phone,o=i.autoreplies[n].get_email}a.window.find(".ws-chat-preform-text").text(i.lang_text.preform_text),"hide"==s?a.window.find(".ws-preform-name").closest(".ws-preform-input-group").addClass("ws-hide"):a.window.find(".ws-preform-name").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(i.lang_text.form_name+'<span class="ws-input-required">'+("yes"==s?" *":"</span>")),"hide"==r?a.window.find(".ws-preform-phone").closest(".ws-preform-input-group").addClass("ws-hide"):a.window.find(".ws-preform-phone").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(i.lang_text.form_phone+'<span class="ws-input-required">'+("yes"==r?" *":"</span>")),"hide"==o?(a.window.find(".ws-preform-email").closest(".ws-preform-input-group").addClass("ws-hide"),a.window.find(".ws-preform-email-text").closest(".ws-preform-input-group").addClass("ws-hide")):(a.window.find(".ws-preform-email").closest(".ws-preform-input-group").find(".ws-preform-input-label").html(i.lang_text.form_email+'<span class="ws-input-required">'+("yes"==o?" *":"</span>")),"lead"==t&&a.window.find(".ws-preform-email-text").closest(".ws-preform-input-group").addClass("ws-hide")),"hide"!=o&&"off"!=i.email_service&&parseInt(i.email_agreement)||a.window.find(".ws-preform-label-agreement").closest(".ws-preform-input-group").addClass("ws-hide"),a.window.find(".ws-preform-btn-save").data("type",t).data("index",n),a.window.find(".ws-chat-body-preform").show(),WBK.setPhoneInputFocusForm(e(".ws-preform-phone")),"yes"==s&&""==e(".ws-preform-name").val().trim()?e(".ws-preform-name").focus():"yes"!=r||""!=e(".ws-preform-phone").val().trim()&&e(".ws-preform-phone").val().trim()!=WBK.settings.phoneBase?"yes"!=o||""!=e(".ws-preform-email").val().trim()&&wsUtil.validateEmail(e(".ws-preform-email").val().trim())?wsUtil.setCaretPosition(e(".ws-preform-name"),e(".ws-preform-name").val().length):e(".ws-preform-email").focus():e(".ws-preform-phone").focus()},hidePreform:function(){i.is_first_message&&i.first_message&&t.addMessageRobot({type:"preform"}),a.window.find(".ws-chat-body").show(),a.window.find(".ws-chat-footer").show(),a.window.find(".ws-chat-body-preform").hide(),t.scroll()},savePreform:function(n,s){void 0==n&&(n="preform"),void 0==s&&(s=!1);var o="hide",r="hide",l="hide";switch(n){case"preform":o=i.get_contact_name,l=i.get_contact_phone,r=i.get_contact_email;break;case"lead":t.stopAutoReply("all"),o=i.autoreplies[s].get_name,l=i.autoreplies[s].get_phone,r=i.autoreplies[s].get_email}a.window.find(".ws-preform-name, .ws-preform-phone, .ws-preform-email").removeClass("ws-input-error");var c=a.window.find(".ws-preform-name").val(),d=a.window.find(".ws-preform-phone").val();d=WBK.checkPhone(d)?d:"";var u=a.window.find(".ws-preform-email").val(),h=e(".ws-preform-email-agreement").is(":checked")?1:0,g=a.window.find(".ws-preform-phone").attr("placeholder"),p="";if("yes"==o&&""==c.trim()&&(p=".ws-preform-name"),"yes"==l&&""==d.trim()&&(p?p+=", .ws-preform-phone":p=".ws-preform-phone"),"yes"!=r||""!=u.trim()&&wsUtil.validateEmail(u.trim())||(p?p+=", .ws-preform-email":p=".ws-preform-email"),p)return void a.window.find(p).addClass("ws-input-error");"lead"==n&&e(".ws-chat-autoreply-link").remove(),c&&(WBK.settings.visitorName=c),u&&(WBK.settings.visitorEmail=u),d&&(WBK.settings.visitorPhone=d),t.updateUser();var f="";console.log(c),"preform"==n&&c?f=i.user_name+", "+i.lang_text.preform_text_success:"preform"==n?(f=i.lang_text.preform_text_success,f=f.charAt(0).toUpperCase()+f.substr(1)):"lead"==n&&c?f=i.user_name+", "+i.lang_text.preform_lead_text_success:"lead"==n&&(f=i.lang_text.preform_lead_text_success,f=f.charAt(0).toUpperCase()+f.substr(1)),console.log(f),t.addMessageRobot({type:"text",message:f}),i.is_first_message&&i.first_message&&(t.sendNode(i.first_message.message,i.first_message.hash,i.first_message.type),i.first_message=!1,a.window.find(".ws-textarea").attr("contenteditable",!0).html(""),a.window.find(".ws-textarea-group").removeClass("ws-textarea-group-hide")),t.hidePreform();var w="";document.URL&&(w=encodeURIComponent(document.URL));var m=WBK.settings.serverUrl+"/api?action=chatSavePreform&callback=?";e.getJSON(m,{code:WBK.settings.whiteSaasCode,url:w,name:c,email:u,phone:d,emailAgreement:h,type_preform:n,type:i.auth_type,image_url:i.logo_visitor,vk_id:i.visitor_vk_id,fb_id:i.visitor_fb_id,fb_token:i.visitor_fb_token,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId,chatWidgetId:WBK.settings.chatWidgetId,chatId:WBK.settings.chatId,phoneMask:g,googleClientId:wsUtil.getGoogleClientId(),roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId()}),t.sendGoal("visitor_introduced")},formatTextToDate:function(e){var t=new Date;if(e){var n=e.split(/[- :]/);t=new Date(n[0],n[1]-1,n[2],n[3],n[4],n[5]);var a=t.getTimezoneOffset();a=(a<0?"+":"-")+Math.abs(a),t.setTime(t.getTime()+60*a*1e3-60*i.chat_timezone*60*1e3)}return t},dateFormat:function(e){var n={new_block:!1,date_line:!1},a=t.formatTextToDate(e),s=new Date,o=function(e){return(e+"").length<2?"0"+e:e},r=!1;return i.chat_old_time?(r=i.chat_old_time<a&&Math.ceil((a-i.chat_old_time)/6e4),i.chat_old_time.getFullYear()==a.getFullYear()&&i.chat_old_time.getMonth()==a.getMonth()&&i.chat_old_time.getDate()==a.getDate()||(i.chat_old_time.getFullYear()!=a.getFullYear()?n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()]+" "+a.getFullYear():n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()])):(r=s>a&&Math.ceil((s-a)/6e4),s.getFullYear()==a.getFullYear()&&s.getMonth()==a.getMonth()&&s.getDate()==a.getDate()||(s.getFullYear()!=a.getFullYear()?n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()]+" "+a.getFullYear():n.date_line=i.lang_text.dayNames[a.getDay()]+", "+a.getDate()+" "+i.lang_text.monthNames[a.getMonth()])),i.chat_old_time=a,r&&r>5&&(n.new_block=!0),a.getDay()==s.getDay()?(n.time=o(a.getHours())+":"+o(a.getMinutes()),n):(n.time=o(a.getDate())+"."+o(a.getMonth()+1)+"."+(a.getFullYear()+"").substr(2),n)},formatMessage:function(n){if(!n)return"";var a=t.cleanMessage(n),s=[];e.isEmptyObject(i.fileUploaded)||(e.each(i.fileUploaded,function(e,t){s.push(t)}),i.fileUploaded={},t.updateFilesUploaded());var o=a.match(/(?!(http(s)?:\/\/)([^\.]+)\.([^\s]+blank.gif))(https?:\/\/[\w\-\.]+\.[a-zA-Z]{2,6}(?:\/\S*)?(?:[\w])+\.(?:jpg|png|gif|jpeg|bmp))/gi);if(o){for(var r=0;r<o.length;r++){var l=a.indexOf(o[r]);s.push({message:{text:t.textUrlFormat(a.slice(0,l))},type:"text"}),s.push({message:{img_url:o[r],file_name:"",file_name_upload:"",img_type:"link"},type:"attach_image"}),a=a.slice(l,a.length).replace(o[r],"")}a&&s.push({message:{text:t.textUrlFormat(a)},type:"text"})}else s.push({message:{text:t.textUrlFormat(a)},type:"text"});return s},textUrlFormat:function(e){var t=!1,i=!1;return e=(e||"").replace(/(^|[^A-Za-z0-9--\-\_])(https?:\/\/)?((?:[A-Za-z\$0-9--](?:[A-Za-z\$0-9\-\_--]*[A-Za-z\$0-9--])?\.){1,5}[A-Za-z\$\-\d]{2,22}(?::\d{2,5})?)((?:\/(?:(?:\&amp;|\&#33;|,[_%]|[A-Za-z0-9--\-\_#%?+\/\$.~=;:]+|\[[A-Za-z0-9--\-\_#%?+\/\$.,~=;:]*\]|\([A-Za-z0-9--\-\_#%?+\/\$.,~=;:]*\))*(?:,[_%]|[A-Za-z0-9--\-\_#%?+\/\$.~=;:]*[A-Za-z0-9--\_#%?+\/\$~=]|\[[A-Za-z0-9--\-\_#%?+\/\$.,~=;:]*\]|\([A-Za-z0-9--\-\_#%?+\/\$.,~=;:]*\)))?)?)/gi,function(){var e=Array.prototype.slice.apply(arguments),i=e[1]||"",n=e[2]||"http://",a=e[3]||"",s=a+(e[4]||""),o=(e[2]||"")+e[3]+e[4];if(a.indexOf(".")==-1||a.indexOf("..")!=-1)return e[0];var r=a.split(".").pop(),l="info,name,academy,aero,arpa,coop,media,museum,mobi,travel,xxx,asia,biz,com,net,org,gov,mil,edu,int,tel,ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,bd,be,bf,bg,bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,eu,fi,fj,fk,fm,fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,ru,rs,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,ss,st,su,sv,sx,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zw,,,,,,cat,pro,local";if(s.indexOf("blank.gif")+1>0||e[0].indexOf("@")!=-1)return e[0];if((r.length>7||l.split(",").indexOf(r)==-1)&&(!/^[a-zA-Z]+$/.test(r)||!e[2]))return e[0];try{o=decodeURIComponent(o)}catch(c){}return t=!0,i+'<a class="ws-chat-message-link" href="'+n+s+'" target="_blank">'+o+"</a>"}),e=e.replace(/([a-zA-Z--\-_\.0-9]+@[a-zA-Z--\-_0-9]+\.[a-zA-Z--\-_\.0-9]+[a-zA-Z--\-_0-9]+)/g,function(e){return i=!0,'<a class="ws-chat-message-link ws-chat-message-email ws-chat-message-email-from-user" href="mailto:'+e+'" target="_blank">'+e+"</a>"}),i||t||(e=e.replace(/\+?\d+((\d+|-+| +|\(+|\)+){6,})\d+/g,function(e){return'<a class="ws-chat-message-link ws-chat-message-phone ws-chat-message-phone-from-user" href="javascript:void(0)" target="_blank">'+e+"</a>"})),e},cleanMessage:function(i){if(!i)return"";i=i instanceof e?i[0].firstChild:i.firstChild;for(var n="",a=new RegExp("^(DIV|P|LI|OL|TR|TD|BLOCKQUOTE|SCRIPT)$");i;){switch(i.nodeType){case 3:var s=i.data.replace(/^\n|\n$/g," ").replace(/[\n\xa0]/g," ").replace(/[ ]+/g," ");s=s?s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"):"",n+=s;break;case 1:var s=t.cleanMessage(i);if(i.tagName&&i.tagName.match(a)&&s){"\n"!=s.substr(-1)&&(s+="\n");for(var o=i.previousSibling;o&&3==o.nodeType&&""==trim(o.nodeValue);)o=o.previousSibling;!o||o.tagName&&o.tagName.match(a)||(s="\n"+s)}else"IMG"==i.tagName?s+='<img src="https://saas-support.com/widget/img/blank.gif" class="ws-emoji" style="'+i.getAttribute("style")+'">':"BR"==i.tagName&&(s+="\n");n+=s}i=i.nextSibling}return e.trim(n)},create:function(e,n,a,s){var o=this;if(i.chatCreating)wsUtil.setInterval("chatCreating_"+n,function(o){i.chatCreating||(wsUtil.deleteInterval("chatCreating_"+n),t.message(e,n,a,s))},1e3);else{i.chatCreating=!0;var r=WBK.settings.serverUrl+"/api?action=chatCreate&callback=?";jWS.getJSON(r,{code:WBK.settings.whiteSaasCode,visitorName:WBK.settings.visitorName?WBK.settings.visitorName:"",message:e,type:a,hash:n,visitorId:WBK.settings.visitorId,chatWidgetId:WBK.settings.chatWidgetId},function(t){if(t.Success&&t.Data&&t.Data.chat){for(var r=0;r<i.invitations.length;r++)wsUtil.deleteInterval("invitationShow_"+r);WBK.settings.chatId=t.Data.chat.id,i.chat_visitor_color=t.Data.chat.color,i.chat_visitor_name=t.Data.chat.visitor_name,i.chat_visitor_img=t.Data.chat.img,i.chat_introduced=t.Data.chat.introduced,WBK.settings.socket?i.chat_created||(WBK.settings.socket.emit("chatCreated",{chat_id:WBK.settings.chatId,chat_widget_id:t.Data.chat.chat_widget_id,visitor_name:WBK.settings.visitorName?WBK.settings.visitorName:t.Data.chat.visitor_name,color:t.Data.chat.color,img:t.Data.chat.img,created_at:t.Data.chat.created_at,message_id:t.Data.messageId,hash:n,message:e,type:a,googleRegistrationIds:s,fcmData:o.getFcmDatagcm_registration_id(e,!0),introduced:t.Data.chat.introduced,introduce_type:t.Data.chat.introduce_type,users_to_notification:t.Data.chat.users_to_notification}),i.chat_created=!0):WBK.initSocket(function(){i.chat_created||(WBK.settings.socket.emit("chatCreated",{chat_id:WBK.settings.chatId,chat_widget_id:t.Data.chat.chat_widget_id,visitor_name:WBK.settings.visitorName?WBK.settings.visitorName:t.Data.chat.visitor_name,color:t.Data.chat.color,img:t.Data.chat.img,created_at:t.Data.chat.created_at,message_id:t.Data.messageId,hash:n,message:e,type:a,googleRegistrationIds:s,fcmData:o.getFcmData(e,!0),introduced:t.Data.chat.introduced,introduce_type:t.Data.chat.introduce_type,users_to_notification:t.Data.chat.users_to_notification}),i.chat_created=!0)}),i.chatCreating=!1}})}},start:function(){if(WBK.settings.chatId){var e="";document.URL&&(e=encodeURIComponent(document.URL)),WBK.settings.socket?(WBK.settings.socket.emit("chatStarted",{chat_id:WBK.settings.chatId,visitor_name:WBK.settings.visitorName,url:e}),i.chat_created=!0):WBK.initSocket(function(){WBK.settings.socket.emit("chatStarted",{chat_id:WBK.settings.chatId,visitor_name:WBK.settings.visitorName,url:e}),i.chat_created=!0})}},printing:function(e){WBK.settings.socket&&WBK.settings.chatId&&WBK.settings.socket.emit("printing",{chat_id:WBK.settings.chatId,message:e})},message:function(e,t,i,n){var a={message:JSON.parse(e)};a.message_type=i,WBK.settings.socket&&WBK.settings.chatId&&WBK.settings.socket.emit("message",{chat_id:WBK.settings.chatId,message:e,hash:t,type:i,googleRegistrationIds:n,fcmData:this.getFcmData(a,!1)})},getFcmData:function(e,t){var n=WBK.settings.visitorName?WBK.settings.visitorName:i.user_name?i.user_name:i.chat_visitor_name,a=" ",s="";switch(s="default"!=i.auth_type?i.logo_visitor:i.chat_visitor_img?i.chat_visitor_img:WBK.settings.serverUrl+"/firstletter/?name="+n.substr(0,1)+"&color="+i.chat_visitor_color,e.message_type){case"show_invitation":case"text":a=e.message.text.replace(/(?:\r\n|\r|\n)/g,"<br />");break;case"attach_image":a="  ";break;case"attach_file":a="  ";break;case"rating":a="   ";break;case"introduced":a=" "}var o={is_first:t,chat_id:WBK.settings.chatId,name:n,message:a,color:i.chat_visitor_color,introduced:i.chat_introduced,auth_type:i.auth_type,image:s,vk_id:i.visitor_vk_id,fb_id:i.visitor_fb_id};return o},messageReceived:function(e){WBK.settings.socket&&WBK.settings.socket.emit("messageReceived",e)},messageRead:function(e){WBK.settings.socket&&WBK.settings.socket.emit("messageRead",e)},messageReadVisitor:function(e){for(var n in i.unread_messages)e||t.messageRead(i.unread_messages[n]),delete i.unread_messages[n];t.setUnreadMessages(0)},messageReadOperator:function(t){var n=a.window.find(".ws-chat-body-content").find("#mess_"+t);n.data("read",!0);var s=n.closest(".ws-chat-message-block"),o=s.find(".ws-chat-message");if(o.length){var r=!0;o.each(function(t,i){0==e(i).data("read")&&(r=!1)}),r&&s.find(".ws-chat-message-status").text(i.lang_text.is_read)}},setUnreadMessages:function(n){var s=e('link[rel="shortcut icon"], link[rel="icon"]');if(n>99&&(n=99),wsUtil.deleteInterval("unreadMessages"),0==n)return a.btn.find(".ws-btn-badge").text("").hide(),i.unread_messages_count=0,document.title=i.document_title,i.new_favicon_href="",void(i.document_favicon_href&&s.attr("href",i.document_favicon_href));if(a.btn.find(".ws-btn-badge").text(n).show(),i.document_favicon_href){var o=e('<img crossOrigin="anonymous" src="'+i.document_favicon_href+'"/>');o.load(function(){i.new_favicon_href=t.generateFavicon(o,n),wsUtil.setInterval("unreadMessages",function(){i.document_title==document.title?(document.title=wsUtil.doEnding(n,i.lang_text.one_new_mess,i.lang_text.two_new_mess,i.lang_text.five_new_mess),i.new_favicon_href&&s.attr("href",i.new_favicon_href)):(document.title=i.document_title,i.document_favicon_href&&s.attr("href",i.document_favicon_href))},1e3)}).error(function(){wsUtil.setInterval("unreadMessages",function(){i.document_title==document.title?document.title=n+" "+wsUtil.doEnding(n,i.lang_text.one_new_mess,i.lang_text.two_new_mess,i.lang_text.five_new_mess):document.title=i.document_title},1e3)})}else wsUtil.setInterval("unreadMessages",function(){i.document_title==document.title?document.title=n+" "+wsUtil.doEnding(n,i.lang_text.one_new_mess,i.lang_text.two_new_mess,i.lang_text.five_new_mess):document.title=i.document_title},1e3)},generateFavicon:function(t,n){if(i.document_favicon_href){var a,s=e("<canvas/>");e('link[rel="shortcut icon"], link[rel="icon"]');if(s[0].getContext("2d")){s[0].height=s[0].width=t[0].width,a=s[0].getContext("2d"),n&&(a.globalAlpha=.4,n<10?n=" "+n:n>100&&(n=99));var o=t[0].width/16,r=11*o,l=o,c=11*o,d=o,u=2*o;return a.drawImage(t[0],0,0),a.globalAlpha=1,a.font="bold "+r+'px "helvetica", sans-serif',a.shadowColor="#FFF",a.shadowBlur=u,a.shadowOffsetX=0,a.shadowOffsetY=0,a.fillStyle="#FFF",a.fillText(n,l,c),a.fillText(n,l+d,c),a.fillText(n,l,c+d),a.fillText(n,l+d,c+d),a.fillStyle="#000",a.fillText(n,l+d/2,c+d/2),s[0].toDataURL("image/png")}}},scroll:function(){a.window.find(".ws-chat-body").nanoScroller(),a.window.find(".ws-chat-body").nanoScroller({scrollBottom:0})},initBtnPosition:function(){var n={},s={};if(a.btn.show(),"pc"!=WBK.settings.device)t.updateBtnPositionMobile();else{switch(i.button_location){case"horizontal":switch(i.position_x){case"left":n.left=i.position_x_value+"%",n.right="auto",a.invitation.addClass("ws-chat-invitation-left");break;case"right":n.right=i.position_x_value+"%",n.left="auto"}switch(i.position_y){case"bottom":n.bottom=i.position_y_value+"%",n.top="auto",0==i.position_y_value&&a.btn.addClass("ws-chat-btn-attach"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-top-color: "+i.color_background_invitation+" !important;}");break;case"top":n.top=i.position_y_value+"%",n.bottom="auto",0==i.position_y_value&&(a.btn.addClass("ws-chat-btn-attach-top"),a.btn.find(".ws-btn-badge").css("top","32px")),a.invitation.addClass("ws-chat-invitation-bottom"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-bottom-color: "+i.color_background_invitation+" !important;}")}break;case"vertical_left":a.btn.addClass("ws-chat-btn-rotate").addClass("ws-chat-btn-attach-top"),a.btn.find(".ws-btn-badge").css("top","32px"),n.left=-(a.btn.outerWidth()-a.btn.outerHeight())/2+"px",n.right="auto",s.left=a.btn.outerWidth()/2+a.btn.outerHeight()+"px",s.right="auto",a.invitation.addClass("ws-chat-invitation-rotate-right"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-right-color: "+i.color_background_invitation+" !important;}");break;case"vertical_right":a.btn.addClass("ws-chat-btn-rotate").addClass("ws-chat-btn-attach"),n.right=-(a.btn.outerWidth()-a.btn.outerHeight())/2+"px",n.left="auto",s.right=a.btn.outerWidth()/2+a.btn.outerHeight()+"px",s.left="auto",a.invitation.addClass("ws-chat-invitation-rotate-left"),WBK.addStyles(".ws-chat .ws-chat-invitation-container:after{border-left-color: "+i.color_background_invitation+" !important;}")}if("vertical_left"==i.button_location||"vertical_right"==i.button_location){switch(i.position_y){case"bottom":n.bottom=(a.btn.outerWidth()-a.btn.outerHeight())/2+e(window).height()/100*i.position_y_value+"px",n.top="auto";break;case"top":n.top=(a.btn.outerWidth()-a.btn.outerHeight())/2+e(window).height()/100*i.position_y_value+"px",n.bottom="auto"}a.invitation.css({top:-(a.btn.outerWidth()-a.btn.outerHeight())/2+"px",bottom:"auto",left:s.left,right:s.right})}a.btn_el.css(n)}a.btn.hide()},updateBtnPositionMobile:function(){var t=window.innerWidth/WBK.getDeviceWidth();if(1!=t?i.scallingMobile=!0:i.scallingMobile=!1,i.scallingMobile){a.btn_el.removeClass("ws-chat-not-scalling");var n,s=a.btn_el.outerWidth(),o=a.btn_el.outerHeight(),r=(s-s*t)/2,l=(o-o*t)/2;n="right"===i.mobile_position_x?e(window).scrollLeft()+window.innerWidth*((100-i.mobile_position_x_value)/100)-t*s-r:e(window).scrollLeft()+window.innerWidth*(i.mobile_position_x_value/100)-r;var c;c="bottom"===i.mobile_position_y?e(window).scrollTop()+window.innerHeight*((100-i.mobile_position_y_value)/100)-t*o-l:e(window).scrollTop()+window.innerHeight*(i.mobile_position_y_value/100)-l,a.btn_el.css({top:c+"px",bottom:"auto",left:n+"px",right:"auto","-webkit-transform":"scale("+t+")","-khtml-transform":"scale("+t+")","-moz-transform":"scale("+t+")","-ms-transform":"scale("+t+")","-o-transform":"scale("+t+")",transform:"scale("+t+")","z-index":"inherit"}),wsUtil.setTimeout("zIndex",function(){a.btn_el.css("z-index",2147483645),parseInt(i.hide_zoom)&&wsUtil.setTimeout("btnElShow",function(){a.btn_el.show()},150)},50)}else{a.btn_el.addClass("ws-chat-not-scalling");var d={transform:"scale(1)"};"right"===i.mobile_position_x?(d.right=i.mobile_position_x_value+"%",d.left="auto"):(d.left=i.mobile_position_x_value+"%",d.right="auto"),"bottom"===i.mobile_position_y?(d.bottom=i.mobile_position_y_value+"%",d.top="auto"):(d.top=i.mobile_position_y_value+"%",d.bottom="auto"),a.btn_el.css(d),a.btn_el.show()}},initWindowPosition:function(){if("pc"==WBK.settings.device){var t=a.btn_el.position().top,i=a.btn_el.position().left,n=a.window.outerHeight(),s=a.window.width(),o=a.btn.outerHeight(),r=e(window).width(),l=window.innerHeight,c=0;a.window.hasClass("ws-chat-ico-bottom")&&(c=64),i+s>r&&(c=0,i=r-s),t=t-n+o,t<0&&(t=0),i<0&&(i=0),t+n>l&&(t=l-n),a.window.css({top:t/(l/100)+"%",left:(i+c)/(r/100)+"%"}),WBK.animateFastOnce(a.window,"cbk-zoomIn")}},updateWindowPosition:function(){var t=(a.window.position().top,a.window.position().left),i=(a.window.height(),a.window.width()),n=e(window).width(),s=(window.innerHeight,0);a.window.hasClass("ws-chat-ico-bottom")&&(s=64),t+i+s>n-15&&(t=n-i-s-15),a.window.css({left:(t+s)/(n/100)+"%"}),WBK.animateFastOnce(a.window,"cbk-zoomIn")},loadBtnEvents:function(){a.btn.on("click",function(){1==WBK.settings.chatInvitationOpened&&t.hideInvitation(),t.showWidget(),t.sendGoal("open")}),a.invitation.on("click",function(i){t.hideInvitation(),e(i.target).hasClass("ws-chat-invitation-close")||e(i.target).hasClass("ws-icon-close")||(t.showWidget(),t.sendGoal("open"))})},loadWindowEvents:function(){if(!e.fn._frameCheck()||"undefined"!=typeof WBK)try{e("body").on("click",'a[href="#showchat"], a[href="'+window.top.location.origin+'#showchat"], a[href="'+window.top.location.origin+'/#showchat"]',function(e){return t.showWidget(),t.sendGoal("open"),e.preventDefault(),!1})}catch(n){}if(a.window.find(".ws-chat-close").on("click",function(){t.hideWidget()}),e(document).on("click",".ws-chat-message-element-file",function(){if(i.chat_created){var n=(new Date).getTime(),a={file_name:e(this).data("fileName"),file_name_upload:e(this).data("fileNameUpload")};t.sendNode(JSON.stringify(a),n,"start_download")}}),e(document).on("click",".ws-chat-uploaded-el-close",function(){var n=e(this).parent().data("index");n&&(delete i.fileUploaded[n],t.updateFilesUploaded())}),a.window.find(".ws-chat-sound").on("click",function(){"on"==i.sound?(i.sound="off",a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_on),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-on").addClass("ws-icon-sound-off")):(i.sound="on",a.window.find(".ws-chat-sound").attr("title",i.lang_text.sound_off),a.window.find(".ws-chat-sound i").removeClass("ws-icon-sound-off").addClass("ws-icon-sound-on"));var e=new Date;e.setMinutes(e.getMinutes()+43200),wsUtil.setCookie("WidgetChat_sound_"+WBK.settings.chatWidgetId,i.sound,e)}),a.window.find(".ws-textarea").bind("keypress",function(e){var i=e.keyCode||e.which;13==i&&(e.preventDefault(),t.sendMessage(),a.window.find(".ws-textarea-send-btn").hide())}),a.window.find(".ws-textarea").bind("keyup",function(e){var i=e.keyCode||e.which;37!=i&&38!=i&&39!=i&&40!=i&&37!=i&&33!=i&&34!=i&&t.inputScroll()}),a.window.find(".ws-textarea").bind("keydown",function(e){var i=e.keyCode||e.which;8==i&&t.inputScroll()}),a.window.find(".ws-textarea").on("paste",function(e){e.preventDefault();var i="";(e.originalEvent||e.originalEvent.clipboardData.getData("text/plain"))&&(i=e.originalEvent.clipboardData.getData("text/plain")),i&&(i=i.replace(/^\n|\n$/g,"<br>").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),t.insertHTML(i));var n=e.clipboardData||e.originalEvent.clipboardData;if(n&&(n=n.items)){for(var a=!1,s=0;s<n.length;s++)0==n[s].type.indexOf("image")&&(a=n[s].getAsFile());if(a){a.name=a.filename="image_"+(new Date).getTime()+".png";var o=new File([a],a.filename),r=new FormData;r.append("img",o),r.append("type","img"),r.append("image_type","screen"),r.append("chat_id",WBK.settings.chatId),t.uploadFileServer(r,"img")}}}),a.window.find(".ws-textarea-send-btn").on("click",function(e){t.sendMessage(),a.window.find(".ws-textarea-send-btn").hide(),a.window.find(".ws-textarea").focus()}),e(document).on("click",".ws-chat-message-user .ws-chat-message-name-text",function(){t.showPreform("preform")}),e(document).on("click",".ws-chat-message-robot .ws-chat-message-input",function(){t.showPreform("preform"),e(this).closest(".ws-chat-message-robot").remove()}),e(document).on("click",".ws-chat-autoreply-btn",function(){t.showPreform("lead",e(this).data("index"))}),e(document).on("click",".ws-chat-message-manager .ws-chat-message-name-text, .ws-chat-ico .ws-chat-logo",function(){var i=" "+e(this).data("name")+",&nbsp;";a.window.find(".ws-textarea").is(":focus")||a.window.find(".ws-textarea").focus(),t.insertHTML(i)}),a.window.find(".ws-textarea").bind("keyup",function(n){var s=n.keyCode||n.which;if(13!=s)if(""!=e(".ws-textarea").html()){a.window.find(".ws-textarea-send-btn").show();var o=t.cleanMessage(e(".ws-textarea"));t.printing(o)}else 0==i.fileUploadedCount&&a.window.find(".ws-textarea-send-btn").hide()}),a.window.find(".ws-textarea").on("focus",function(){t.messageReadVisitor(!1)}),a.window.find(".ws-btn-smile, .ws-smile-container").mouseenter(function(){wsUtil.deleteTimeout("hideSmileContainer"),a.window.find(".ws-file-container").hide(),a.window.find(".ws-smile-container").show()}).mouseleave(function(){wsUtil.setTimeout("hideSmileContainer",function(){a.window.find(".ws-smile-container").hide()},300)}),a.window.find(".ws-btn-file, .ws-file-container").mouseenter(function(){wsUtil.deleteTimeout("hideFileContainer"),a.window.find(".ws-smile-container").hide(),a.window.find(".ws-file-container").show()}).mouseleave(function(){wsUtil.setTimeout("hideFileContainer",function(){a.window.find(".ws-file-container").hide()},300)}),e(window).on("resize.ws-chat",function(){wsUtil.setTimeout("resizeChat",function(){"pc"!=WBK.settings.device?t.updateBtnPositionMobile():WBK.settings.chatWindowOpened?t.updateWindowPosition():t.initWindowPosition()},500)}),"pc"==WBK.settings.device?(a.window.find(".ws-chat-header").on("mousedown",function(t){1!==t.which||e(t.target).hasClass("ws-chat-close")||e(t.target).hasClass("ws-icon-close")||e(t.target).hasClass("ws-chat-sound")||e(t.target).hasClass("ws-icon-sound-on")||e(t.target).hasClass("ws-icon-sound-off")||(a.window.addClass("ws-chat-drag"),i.dragChatObject.elem=a.window,i.dragChatObject.downX=t.pageX,i.dragChatObject.downY=t.pageY)}),e(document).on("mouseup.ws-chat-header",function(e){if(i.dragChatObject.dragStarted){i.dragChatObject.dragStarted=!1;var t=new Date;t.setMinutes(t.getMinutes()+1440);var n=JSON.stringify({top:a.window.css("top"),left:a.window.css("left"),width:a.window.css("width"),height:a.window.css("height")});wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,n,t)}a.window.removeClass("ws-chat-drag"),i.dragChatObject={}}),e(document).on("mousemove.ws-chat-header",function(t){if(i.dragChatObject.elem){var n=t.pageX-i.dragChatObject.downX,s=t.pageY-i.dragChatObject.downY;if(Math.abs(n)<3&&Math.abs(s)<3)return;i.dragChatObject.dragStarted||(i.dragChatObject.oldPosition={left:i.dragChatObject.elem.position().left||"",top:i.dragChatObject.elem.position().top||""},i.dragChatObject.shiftX=i.dragChatObject.downX-i.dragChatObject.elem.position().left,i.dragChatObject.shiftY=i.dragChatObject.downY-i.dragChatObject.elem.position().top,i.dragChatObject.dragStarted=!0);var o=t.pageX-i.dragChatObject.shiftX,r=t.pageY-i.dragChatObject.shiftY,l=e(window).width(),c=window.innerHeight;r=i.dragChatObject.elem.outerHeight()>c?0:r+i.dragChatObject.elem.outerHeight()>c-10?c-i.dragChatObject.elem.outerHeight():r<10?0:r,o=i.dragChatObject.elem.outerWidth()+o>l?l-i.dragChatObject.elem.outerWidth():o<10?0:o,o<100&&a.window.hasClass("ws-chat-ico-bottom")?a.window.addClass("ws-chat-ico-bottom-right"):a.window.removeClass("ws-chat-ico-bottom-right"),i.dragChatObject.elem.css({left:o+"px",top:r+"px",right:"auto",bottom:"auto"})}}),i.chat_is_online&&(a.window.find(".ws-chat-resize").on("mousedown",function(e){1===e.which&&(i.resizeChatObject.elem=a.window,i.resizeChatObject.elemMinSizeHeight=375,i.resizeChatObject.elemMinSizeHeight=i.resizeChatObject.elemMinSizeHeight+i.resizeChatObject.elem.find(".ws-chat-footer").outerHeight(),i.resizeChatObject.downX=e.pageX,i.resizeChatObject.downY=e.pageY,a.window.addClass("ws-chat-no-select"))}),e(document).on("mouseup.ws-chat-resize",function(e){if(i.resizeChatObject.dragStarted){i.resizeChatObject.dragStarted=!1;var n=new Date;n.setMinutes(n.getMinutes()+1440);var s=JSON.stringify({top:a.window.css("top"),left:a.window.css("left"),width:a.window.css("width"),height:a.window.css("height")});wsUtil.setCookie("WidgetChat_settings_"+WBK.settings.chatWidgetId,s,n),t.inputScroll()}i.resizeChatObject={},a.window.removeClass("ws-chat-no-select"),t.typingPositionUpdate()}),e(document).on("mousemove.ws-chat-resize",function(n){if(i.resizeChatObject.elem){var a=n.pageX-i.resizeChatObject.downX,s=n.pageY-i.resizeChatObject.downY;if(Math.abs(a)<3&&Math.abs(s)<3)return;i.resizeChatObject.dragStarted||(i.resizeChatObject.old={width:i.resizeChatObject.elem.outerWidth(),height:i.resizeChatObject.elem.outerHeight(),left:i.resizeChatObject.elem.position().left||"",top:i.resizeChatObject.elem.position().top||""},i.resizeChatObject.shiftX=i.resizeChatObject.downX-i.resizeChatObject.elem.position().left,i.resizeChatObject.shiftY=i.resizeChatObject.downY-i.resizeChatObject.elem.position().top,i.resizeChatObject.dragStarted=!0),i.resizeChatObject.dragStarted=!0;var o=n.pageX-i.resizeChatObject.downX,r=n.pageY-i.resizeChatObject.downY,l=e(window).width(),c=window.innerHeight,d=i.resizeChatObject.old.height+r,u=i.resizeChatObject.old.width+o;if(i.resizeChatObject.elem.position().top+d>c){d=c-i.resizeChatObject.elem.position().top}i.resizeChatObject.elem.position().left+u>l&&(u=l-i.resizeChatObject.elem.position().left),
i.resizeChatObject.elem.css({width:u>338?u:338,height:d>=400?d:400}),t.scroll()}}))):(e(window).on("scroll.ws-chat",function(){parseInt(i.hide_zoom)&&a.btn_el.hide(),wsUtil.setTimeout("scrollTimerChat",function(){t.updateBtnPositionMobile()},250)}),i.windowRatioChat=window.innerWidth/window.screen.availWidth,wsUtil.setInterval("mobileResizeChat",function(){i.windowRatioChat!==window.innerWidth/window.screen.availWidth&&(i.windowRatioChat=window.innerWidth/window.screen.availWidth,t.updateBtnPositionMobile())},250)),a.window.find(".ws-file-upload").on("change",function(i){i.preventDefault(),a.window.find(".ws-file-container").hide(),t.uploadFile(e(this).data("type"))}),a.window.find(".ws-offline-btn").on("click",function(){t.sendOfflineMessage()}),a.window.find(".ws-preform-btn-cancel").on("click",function(){t.hidePreform()}),a.window.find(".ws-preform-btn-save").on("click",function(){t.savePreform(e(this).data("type"),e(this).data("index"))}),a.window.find(".ws-chat-social-vk").on("click",function(){var e=675,t=380,i=(screen.width-e)/2,n=(screen.height-t)/4;open(WBK.settings.serverUrl+"/chat/auth_vk/?origin="+window.location.origin,"publish","width="+e+",height="+t+", top="+n+", left="+i+",resizable=yes,scrollbars=yes,status=yes")}),a.window.find(".ws-chat-social-fb").on("click",function(){var e=675,t=380,i=(screen.width-e)/2,n=(screen.height-t)/4;open(WBK.settings.serverUrl+"/chat/auth_fb/?origin="+window.location.origin,"publish","width="+e+",height="+t+", top="+n+", left="+i+",resizable=yes,scrollbars=yes,status=yes")}),e(window).on("message",function(e){var e=e.originalEvent.data;if(e)switch(e.type){case"vk_auth":t.vkAuth(e);break;case"fb_auth":t.fbAuth(e)}}),a.window.find(".ws-preform-input").bind("keypress",function(i){var n=i.keyCode||i.which;13==n&&(i.preventDefault(),t.savePreform(e(".ws-preform-btn-save").data("type"),e(this).data("index")))}),WBK.settings.phoneMasks){var s=e.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),o={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:s,listKey:"mask",onMaskChange:function(){e(this).attr("placeholder",e(this).inputmask("getemptymask"))}};e(".ws-offline-phone").inputmasks(o),e(".ws-preform-phone").inputmasks(o),e(".cbk-phone-checker").inputmasks(o)}},vkAuth:function(n){i.visitor_vk_id=n.user_id,e.ajax({url:"https://api.vk.com/method/users.get?user_ids="+n.user_id+"&fields=photo_100&lang=ru&v=5.45",type:"GET",dataType:"jsonp",crossDomain:!0,success:function(s){a.window.find(".ws-preform-name").val(s.response[0].first_name+" "+s.response[0].last_name),n.email&&a.window.find(".ws-preform-email").val(n.email),s.response[0].photo_100&&(i.logo_visitor=s.response[0].photo_100),i.auth_type="vk",t.savePreform(e(".ws-preform-btn-save").data("type"),e(".ws-preform-btn-save").data("index"))}})},fbAuth:function(n){i.visitor_fb_token=n.access_token,e.ajax({url:"https://graph.facebook.com/me?fields=id,email,first_name,last_name,picture.width(100).height(100)&access_token="+n.access_token,type:"GET",dataType:"jsonp",crossDomain:!0,success:function(n){i.visitor_fb_id=n.id,a.window.find(".ws-preform-name").val(n.first_name+" "+n.last_name),n.email&&a.window.find(".ws-preform-email").val(n.email),n.picture.data.url&&(i.logo_visitor=n.picture.data.url),i.auth_type="fb",t.savePreform(e(".ws-preform-btn-save").data("type"),e(".ws-preform-btn-save").data("index"))}})},updateUser:function(){if(i.visitorData&&(i.auth_type=i.visitorData.type,i.logo_visitor=i.visitorData.img,i.visitorData=!1),i.user_name=WBK.settings.visitorName?WBK.settings.visitorName:"",i.user_email=WBK.settings.visitorEmail?WBK.settings.visitorEmail:"",i.user_phone=WBK.settings.visitorPhone?WBK.settings.visitorPhone:"",i.chat_created){a.window.find(".ws-chat-message-user").find(".ws-chat-message-name-text").text(i.user_name),t.logoVisitor(!0),a.window.find(".ws-chat-message-user").find(".ws-chat-message-name-text").text(i.user_name);var e=new Date;e=e.getTime();var n={visitor_name:i.user_name,visitor_email:i.user_email,visitor_phone:i.user_phone,auth_type:i.auth_type,image:i.logo_visitor,vk_id:i.visitor_vk_id,fb_id:i.visitor_fb_id};WBK.settings.socket?WBK.settings.socket.emit("introduced",{chat_id:WBK.settings.chatId,visitor_name:i.user_name,visitor_email:i.user_email,visitor_phone:i.user_phone,hash:e,message:JSON.stringify(n),type:"introduced"}):WBK.initSocket(function(){WBK.settings.socket.emit("introduced",{chat_id:WBK.settings.chatId,visitor_name:i.user_name,visitor_email:i.user_email,visitor_phone:i.user_phone,hash:e,message:JSON.stringify(n),type:"introduced"})})}},operatorsIsOnline:function(){var t=!1;return i.operators_id=[],i.operators_online_id=[],i.operators_array=[],i.all_operators&&e.each(i.all_operators,function(e,n){i.all_operators[e].user_logo&&i.all_operators[e].connected_at&&i.operators_array.push(i.all_operators[e]),i.operators_id.push(i.all_operators[e].user_id+"_"+i.all_operators[e].employee_id),parseInt(i.all_operators[e].status)&&(i.operators_online_id.push(i.all_operators[e].user_id+"_"+i.all_operators[e].employee_id),t=!0)}),t},addMessage:function(e){var n,s="",o=!0,r=i.lang_text.is_received,l=!1;switch(e.is_read&&(r=i.lang_text.is_read,l=!0),e.user=e.user?e.user:"",e.date=t.dateFormat(e.date),e.message_type){case"introduced":case"error":case"start_download":case"open_window":case"close_window":case"auto_ended":case"not_require_answer":case"close_chat":case"crm_integration_sended":case"invite_to_chat":case"":return!1;case"show_invitation":case"text":i.messages_quant_to_rate++,e.message=e.message.text.replace(/(?:\r\n|\r|\n)/g,"<br />");break;case"auto_reply":if(e.auto_reply_get_contact){var c=i.autoreplies[e.auto_reply_index].text_btn?i.autoreplies[e.auto_reply_index].text_btn:i.lang_text.autoreply_link;e.message=wsUtil.specialChars(e.message.text)+'<br><div class="ws-chat-autoreply-link"><a data-index="'+e.auto_reply_index+'" class="ws-chat-autoreply-btn" href="#">'+c+"</a></div>";var d=new Date;d.setMinutes(d.getMinutes()+43200),wsUtil.setCookie("WidgetChat_autoreply_getcontact_"+WBK.settings.chatId,!0,d)}else e.message=wsUtil.specialChars(e.message.text);break;case"attach_image":i.messages_quant_to_rate++;var u="";switch(e.message.img_type){case"link":u=e.message.img_url;break;case"uploaded":u=WBK.settings.serverUrl+"/chat/download/?type=image&file="+e.message.file_name_upload+"&filename="+e.message.file_name}e.message='<a class="ws-chat-message-element"  data-file-name="'+e.message.file_name+'" data-file-name-upload="'+e.message.file_name_upload+'" href="'+u+'" target="_blank"><img class="ws-chat-message-img" src="'+e.message.img_url+'"><div class="ws-foto-hover"></div><div class="ws-foto-hover-img"></div></a>';break;case"attach_file":i.messages_quant_to_rate++;var h='<div class="ws-file-block"><div class="ws-file-el"><img class="ws-icon-file" src="'+WBK.settings.staticServerUrl+"/"+e.message.file_ico_url+'"> <div class="ws-file-size">'+e.message.file_size+" "+e.message.file_size_type+'</div></div><div class="ws-file-name">'+e.message.file_name+'</div></div><div class="ws-file-hover"></div>';e.message='<a class="ws-chat-message-element ws-chat-message-element-file" data-file-name="'+e.message.file_name+'" data-file-name-upload="'+e.message.file_name_upload+'" href="'+WBK.settings.serverUrl+"/chat/download/?type=doc&file="+e.message.file_name_upload+"&filename="+e.message.file_name+'" target="_blank">'+h+"</a>";break;case"connect_to_chat":var g=e.message.user_name+(e.message.user_surname?" "+e.message.user_surname:"");e.date.date_line&&a.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+e.date.date_line+"</div>");var p=e.message.user_profession?e.message.user_profession:"",f='<div class="ws-chat-manager-join"><img src="'+WBK.settings.staticServerUrl+e.message.img_url+'" alt="" class="ws-manager-img"><div class="ws-manager-name">'+g+'</div><div class="ws-manager-position">'+p+'</div><div class="ws-manager-event">'+i.lang_text.join_chat+"</div></div>";return a.window.find(".ws-chat-typing").before(f),!1;case"disconnect_from_chat":var g=e.message.user_name+(e.message.user_surname?" "+e.message.user_surname:"");e.date.date_line&&a.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+e.date.date_line+"</div>");var p=e.message.user_profession?e.message.user_profession:"",f='<div class="ws-chat-manager-join"><img src="'+WBK.settings.staticServerUrl+e.message.img_url+'" alt="" class="ws-manager-img"><div class="ws-manager-name">'+g+'</div><div class="ws-manager-position">'+p+'</div><div class="ws-manager-event">'+i.lang_text.disconnect_from_chat+"</div></div>";return a.window.find(".ws-chat-typing").before(f),!1}e.date.date_line&&a.window.find(".ws-chat-typing").before('<div class="ws-chat-date-block">'+e.date.date_line+"</div>");var w='<div id="mess_'+e.hash+'" data-read="'+l+'" class="ws-chat-message"><div class="ws-chat-message-source">'+e.message+'</div><div class="ws-chat-message-date">'+e.date.time+"</div></div>",m=a.window.find(".ws-chat-body-content").children(":not(.ws-chat-typing,.ws-chat-uploaded-files)").last();switch(e.type){case"manager":i.last_operator_message_id=e.id?e.id:i.last_operator_message_id,s="ws-chat-message-manager",o=m.data("user")==e.user;var v=this.getOperator(e.user);v&&(n=v.name+(v.surname?" "+v.surname:""));break;case"user":n=i.user_name?i.user_name:i.lang_text.default_user,s="ws-chat-message-user"}if((m.hasClass("ws-chat-robot-hello")||m.hasClass("ws-chat-manager-hello"))&&m.css("padding-bottom","10px"),!e.date.new_block&&m.hasClass(s)&&o)m.find(".ws-chat-message-date").remove(),m.find(".ws-chat-message:last").after(w),e.is_read||"user"!=e.type||m.find(".ws-chat-message-status").text(r).addClass("ws-chat-message-status");else{var b="",k="",_="";if("manager"==e.type){var v=this.getOperator(e.user);b='<div class="ws-chat-message-logo"><img class="ws-chat-message-logo-img" src="'+WBK.settings.staticServerUrl+v.img+'"></div>'}else{var y=t.logoVisitor(!1);b='<div class="ws-chat-message-logo">'+y+"</div>",k='<div class="ws-chat-message-status">'+r+"</div>",_=i.lang_text.change_name_title}var x='<div class="ws-chat-message-block '+s+'" data-user="'+e.user+'">'+b+'<div class="ws-chat-message-name"><span class="ws-chat-message-name-text" data-name="'+n+'" title="'+_+'">'+n+"</span></div>"+w+k+"</div>";a.window.find(".ws-chat-typing").before(x)}return e.user||e.is_read&&parseInt(e.is_read)||(a.window.find(".ws-chat-message-status:last").addClass("ws-chat-message-status-hidden"),wsUtil.setTimeout("show_message_status",function(){var e=a.window.find(".ws-chat-message-status.ws-chat-message-status-hidden");e.removeClass("ws-chat-message-status-hidden"),WBK.animateOnce(e,"cbk-flipInY")},1e3)),"manager"==e.type&&e.user&&t.updateIcoBottom(e.user),!WBK.settings.chatWindowOpened||"attach_image"!=e.message_type&&"attach_file"!=e.message_type||a.window.find(".ws-chat-body-content img:last").load(function(){t.scroll()}),t.typingPositionUpdate(),e.scroll&&t.scroll(),!0},getOperator:function(e){var t={img:"/img/avatars/nophoto.png",is_alias:0,name:"",surname:!1,profession:"",status:0,user_logo:"/img/avatars/nophoto.png"};return"undefined"!=typeof i.all_operators[e]&&(t=i.all_operators[e]),t},logoVisitor:function(e){var t='<img class="ws-chat-message-logo-img" src="'+i.default_logo_visitor+'">';if("vk"!=i.auth_type&&"fb"!=i.auth_type||!i.logo_visitor){if(i.user_name){var n=i.user_name.substr(0,1).toUpperCase();t='<div class="ws-chat-message-logo-letter">'+n+"</div>",e&&a.window.find(".ws-chat-message-user").find(".ws-chat-message-logo-letter").html(t)}}else t='<img class="ws-chat-message-logo-img" src="'+i.logo_visitor+'">',e&&a.window.find(".ws-chat-message-user").find(".ws-chat-message-logo").html(t);return t},playSound:function(e){if("off"!=i.sound){var t="";switch(e){case"message":t="chat1";break;case"send_message":break;case"operator_join":t="chat1"}WBK.Sound(t)}},typing:function(e,t){var n=this;void 0==t&&(t=5e3);var s=e.user_id+"_"+e.employee_id,o=this.getOperator(s),r=o.name?o.name:i.lang_text.operator;a.window.find(".ws-chat-typing").find(".ws-manager-name").text(r),n.typingPositionUpdate(),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-removing"),wsUtil.setTimeout("chatTypingActivateTimeout",function(){a.window.find(".ws-chat-typing").addClass("ws-chat-typing-active")},300),wsUtil.setTimeout("chatTypingTimeout",function(){a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing")},t)},typingPositionUpdate:function(){var t=a.window.find(".ws-chat-body-content").height(),i=0,n=a.window.find(".ws-chat-typing").outerHeight()+a.window.find(".ws-chat-uploaded-files").outerHeight();a.window.find(".ws-chat-body-content").children(":not(.ws-chat-typing,.ws-chat-uploaded-files)").each(function(n,a){if(i+=e(a).outerHeight(),t<i)return!1});var s=t-i-6,o=0;s>n&&(o=s-n),a.window.find(".ws-chat-typing").css("marginTop",o)},operatorClosed:function(){a.window.removeClass("ws-chat-ico-bottom"),a.window.find(".ws-chat-ico-container").empty(),i.chat_created=!1},getTimeClosedChat:function(){return wsUtil.getStorage("ws_time_closed_chat")},updateTimeClosedChat:function(){wsUtil.setStorage("ws_time_closed_chat",(new Date).getTime())},operatorJoin:function(e){var n=e.user_id+"_"+e.employee_id;if(n!=i.invitation_operator_id?(t.addMessage({id:e.id,hash:e.hash,message:JSON.parse(e.message),date:e.created_at,user:n,is_read:!1,message_type:e.type,scroll:!0}),t.playSound("operator_join")):i.invitation_operator_id=!1,!i.chat_operators.hasOwnProperty(n)){var a=this.getOperator(n);i.chat_operators[n]={employee_id:e.employee_id,name:a.name+(a.surname?" "+a.surname:""),user_id:e.user_id,gcm_registration_id:a.gcm_registration_id}}t.operatorsUpdate(),i.send_autoreply=!0,i.send_autoreply_first=!1,t.getAutoReply(),t.scroll(),t.sendGoal("operator_connect")},operatorExit:function(e){var n=e.user_id+"_"+e.employee_id;t.addMessage({id:e.id,hash:e.hash,message:JSON.parse(e.message),date:e.created_at,user:n,is_read:!1,message_type:e.type,scroll:!0}),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing"),i.chat_operators.hasOwnProperty(n)&&delete i.chat_operators[n],t.operatorsUpdate(),t.scroll()},onVisitorMessage:function(e){if("show_invitation"!=e.data.type&&"auto_reply"!=e.data.type){if("rating"==e.data.type)return e.data.message=JSON.parse(e.data.message),i.chatRate=e.data.message.rate,void t.addMessageRobot(e.data);var n=!1;WBK.settings.chatWindowOpened&&(n=!0),t.addMessage({id:e.data.id,hash:e.data.hash,type:"user",message:JSON.parse(e.data.message),date:e.data.created_at,user:!1,is_read:!1,message_type:e.data.type,scroll:n}),t.playSound("message"),this.checkRatingSettings()}},onVisitorMessageRead:function(){t.messageReadVisitor(!0)},socketConnected:function(e,n){i.chat_created?t.reconnect():i.chat_created||"undefined"!=typeof n&&n(e)},onOperatorStatus:function(e){1==e.status?(wsUtil.deleteTimeout("chatOperatorsUpdate"),t.operatorsUpdate(e)):wsUtil.setTimeout("chatOperatorsUpdate",function(){t.operatorsUpdate(e)},15e3)},onConnectToChat:function(e){i.last_operator_data={user_id:e.user_id,employee_id:e.employee_id},jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("not_connected"),t.operatorJoin(e)},onDisconnectFromChat:function(e){t.operatorExit(e),jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("all")},onCloseChat:function(e){t.operatorClosed(),t.stopAutoReply("all"),t.updateTimeClosedChat()},onOperatorPrinting:function(e){jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("all"),t.typing(e),jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("not_answer_operator")},onOperatorMessage:function(e){var n=e.user_id+"_"+e.employee_id;i.last_operator_data={user_id:e.user_id,employee_id:e.employee_id},wsUtil.deleteTimeout("chatTypingTimeout"),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing");var s=!1;WBK.settings.chatWindowOpened&&(s=!0);var o=t.addMessage({id:e.id,hash:e.hash,type:"manager",message:JSON.parse(e.message),date:!1,user:n,is_read:!1,message_type:e.type,scroll:s});o&&(t.playSound("message"),t.messageReceived(e),i.unread_messages_count+=1),i.unread_messages[e.hash]={id:e.id,hash:e.hash},a.window.find(".ws-textarea").is(":focus")?t.messageReadVisitor(!1):o&&t.setUnreadMessages(i.unread_messages_count),WBK.settings.chatWindowOpened||WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||"pc"!=WBK.settings.device||t.showWidget(),i.send_autoreply=!0,jWS.isEmptyObject(i.autoreplies)||t.stopAutoReply("not_answer_operator"),this.checkRatingSettings()},onOperatorUpdateMessage:function(t){t.user_id+"_"+t.employee_id;wsUtil.deleteTimeout("chatTypingTimeout"),a.window.find(".ws-chat-typing").removeClass("ws-chat-typing-active").addClass("ws-chat-typing-removing"),t.message=JSON.parse(t.message),e("#mess_"+t.hash+" .ws-chat-message-source").html(t.message.text)},onMessageRead:function(e){t.messageReadOperator(e.hash)},onUpdateRegistrationId:function(e){var t=e.user_id+"_"+e.employee_id;i.all_operators[t]&&(i.all_operators[t].gcm_registration_id=e.registration_id),i.chat_operators[t]&&(i.chat_operators[t].gcm_registration_id=e.registration_id)},reconnect:function(){e.getJSON(WBK.settings.serverUrl+"/chat/api/",{action:"getUnreadMessages",chatId:WBK.settings.chatId,chatWidgetId:WBK.settings.chatWidgetId,visitorId:WBK.settings.visitorId,lastOperatorMessageId:i.last_operator_message_id?i.last_operator_message_id:0},function(e){if(e.success&&e.data.messages){var n=!1;WBK.settings.chatWindowOpened&&(n=!0);var s=e.data.messages,o=!1;for(var r in s)if(!i.unread_messages.hasOwnProperty(s[r].hash)){t.messageReceived(s[r]),"close_chat"==s[r].type&&(o=!0);var l=s[r].user_id+"_"+s[r].employee_id;t.addMessage({id:s[r].id,hash:s[r].hash,type:"manager",message:JSON.parse(s[r].message),date:!1,user:l,is_read:!1,message_type:s[r].type,scroll:n}),i.unread_messages[s[r].hash]={id:s[r].id,hash:s[r].hash},i.unread_messages_count+=1,a.window.find(".ws-textarea").is(":focus")?t.messageReadVisitor(!1):t.setUnreadMessages(i.unread_messages_count)}o&&(t.messageReadVisitor(!1),t.operatorClosed())}})},setTemplate:function(){n='<div class="ws-chat"><div class="ws-chat-container ws-chat-round"><div class="ws-chat-header" style="background: '+i.color_background_chat_header+'"><div class="ws-chat-logo"><i class="ws-icon-chat"></i><img src="'+i.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div><div class="ws-chat-title" style="color: '+i.color_background_chat_header_text+'">'+i.text_button_online+'</div><a class="ws-chat-close" style="color: '+i.color_background_chat_header_text+'" href="javascript:void(0)" title="'+i.lang_text.close_title+'"><i class="ws-icon-close" style="color: '+i.color_background_chat_header_text+'"></i></a><a class="ws-chat-sound" style="color: '+i.color_background_chat_header_text+'" href="javascript:void(0)" title="'+i.lang_text.sound_off+'"><i class="ws-icon-sound-on" style="color: '+i.color_background_chat_header_text+'"></i></a></div><div class="ws-chat-body"><div class="ws-chat-rating">'+i.lang_text.rate_request+'<div class="ws-chat-rating-btns ws-chat-rating-btns-'+i.rate_chat_view+'"><a class="ws-chat-rating-el ws-chat-rating-el-1" href="javascript:void(0)" data-value="1" title="'+i.lang_text.rate_text_1+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-2" href="javascript:void(0)" data-value="2" title="'+i.lang_text.rate_text_2+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-3" href="javascript:void(0)" data-value="3" title="'+i.lang_text.rate_text_3+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-4" href="javascript:void(0)" data-value="4" title="'+i.lang_text.rate_text_4+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a><a class="ws-chat-rating-el ws-chat-rating-el-5" href="javascript:void(0)" data-value="5" title="'+i.lang_text.rate_text_5+'"><img src="'+WBK.settings.staticServerUrl+'/widget/img/blank.gif" alt=""></a></div></div><div class="ws-chat-shadow"></div><div class="ws-chat-body-content"><div class="ws-chat-typing"><span class="ws-chat-typing-action"><i class="ws-icon-typing"></i></span><span class="ws-manager-name"></span> '+i.lang_text.typing+'...</div><div class="ws-chat-uploaded-files"></div></div></div><div class="ws-chat-body-offline" style="display: none"><div class="ws-chat-offline-text">'+i.offline_text+'</div><div class="ws-chat-offline-text-success">'+i.lang_text.offline_text_success+'</div><div class="ws-offline-input-group '+("hide"==i.get_contact_offline_name?"ws-hide":"")+'"><div class="ws-offline-input-label">'+i.lang_text.form_name+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_name?" *":"")+'</span></div><input type="text" class="ws-offline-input ws-offline-name" placeholder="'+i.lang_text.form_name_placeholder+'" value="'+i.user_name+'"></div><div class="ws-offline-input-group '+("hide"==i.get_contact_offline_phone?"ws-hide":"")+'"><div class="ws-offline-input-label">'+i.lang_text.form_phone+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_phone?" *":"")+'</span></div><input type="text" class="ws-offline-input ws-offline-phone" placeholder="'+i.lang_text.form_phone_placeholder+'" value="'+i.user_phone+'"></div><div class="ws-offline-input-group '+("hide"==i.get_contact_offline_email?"ws-hide":"")+'"><div class="ws-offline-input-label">'+i.lang_text.form_email+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_email?" *":"")+'</span></div><input type="text" class="ws-offline-input ws-offline-email" placeholder="'+i.lang_text.form_email_placeholder+'" value="'+i.user_email+'"></div><div class="ws-offline-input-group"><div class="ws-offline-input-label">'+i.lang_text.form_message+'<span class="ws-input-required">'+("yes"==i.get_contact_offline_message?" *":"")+'</span></div><div contenteditable="true" class="ws-offline-textarea"></div><div class="ws-offline-textarea-element"><a class="ws-offline-textarea-btn ws-btn-smile" href="javascript:void(0)"><i class="ws-icon-smile"></i></a><div class="ws-smile-container ws-smile-container-offline"></div></div></div><div class="ws-offline-input-group'+("hide"!=i.get_contact_email&&"off"!=i.email_service&&parseInt(i.email_agreement)?"":" ws-hide")+'"><label class="ws-offline-label-agreement"><input type="checkbox" class="ws-offline-email-agreement" checked><span class="ws-offline-email-agreement-text">'+i.email_agreement_text+'</span></label></div><div class="ws-offline-input-group ws-offline-input-group-btn"><a href="#" class="ws-offline-btn">'+i.lang_text.offline_btn+'</a></div></div><div class="ws-chat-body-preform" style="display: none"><div class="ws-chat-preform-text"></div><div class="ws-chat-preform-social"><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-vk"><img class="ws-chat-social-img" src="'+WBK.settings.staticServerUrl+'/widget/img/vk.png"></a><a href="javascript:void(0)" class="ws-chat-social-el ws-chat-social-fb"><img class="ws-chat-social-img" src="'+WBK.settings.staticServerUrl+'/widget/img/fb.png"></a></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-name" placeholder="'+i.lang_text.form_name_placeholder+'" value="'+i.user_name+'"></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-phone" placeholder="'+i.lang_text.form_phone_placeholder+'" value="'+i.user_phone+'"><input type="text" class="cbk-phone-checker white-saas-generator-input-hidden"/></div><div class="ws-preform-input-group"><div class="ws-preform-input-label"></div><input type="text" class="ws-preform-input ws-preform-email" placeholder="'+i.lang_text.form_email_placeholder+'" value="'+i.user_email+'"></div><div class="ws-preform-input-group ws-preform-input-group-text"><div class="ws-preform-input-label ws-preform-email-text">'+i.lang_text.email_exit+'</div></div><div class="ws-preform-input-group ws-preform-input-group-text"><label class="ws-preform-label-agreement"><input type="checkbox" class="ws-preform-email-agreement" checked><span class="ws-preform-email-agreement-text">'+i.email_agreement_text+'</span></label></div><div class="ws-preform-input-group ws-preform-input-group-btn"><a href="javascript:void(0)" class="ws-preform-btn-cancel">'+i.lang_text.offline_btn_cancel+'</a><a href="javascript:void(0)" class="ws-preform-btn ws-preform-btn-save">'+i.lang_text.preform_btn+'</a></div></div><div class="ws-chat-footer"><div class="ws-textarea-element"><a class="ws-textarea-btn ws-btn-file" href="javascript:void(0)"><i class="ws-icon-file"></i></a><a class="ws-textarea-btn ws-btn-smile" href="javascript:void(0)"><i class="ws-icon-smile"></i></a><div class="ws-smile-container"></div><div class="ws-file-container"><div class="ws-file-element ws-file-doc"><i class="ws-icon-document"></i>'+i.lang_text.file+'<input type="file" class="ws-file-upload ws-file-doc-upload" name="ws-doc" data-type="doc" accept="'+i.allow_mime_file+'"></div><div class="ws-file-element ws-file-foto"><i class="ws-icon-image"></i>'+i.lang_text.image+'<input type="file" class="ws-file-upload ws-file-img-upload" name="ws-img" data-type="img" accept="'+i.allow_mime_img+'"></div></div></div><div class="ws-textarea-group"><div contenteditable="true" class="ws-textarea" placeholder="    Enter"></div><div class="ws-textarea-send-btn" title="'+i.lang_text.send_btn_title+'"><i class="ws-icon-enter"></i></div></div></div><div class="ws-chat-copyright"><a href="'+i.partnerLink+'" class="ws-chat-copyright-url" target="_blank" data-widget="chat">'+i.lang_text.text_link+'</a></div><div class="ws-chat-resize" style="color: '+i.color_background_chat_header+'"><i class="ws-icon-resize"></i></div><div class="ws-chat-ico-container"></div></div><div class="ws-chat-btn-el-container ws-chat-not-scalling"><div class="ws-chat-btn-container ws-chat-btn-mini-hover"><div class="ws-btn-badge"></div><div class="ws-btn-ico"><div class="ws-chat-logo"><i class="ws-icon-chat" style="color: '+i.color_background_button+'"></i><img src="'+i.chat_widget_logo+'" class="ws-chat-logo-img"><div class="ws-chat-status-round ws-chat-status-online"></div></div></div><div class="ws-btn-title"></div></div><div class="ws-chat-invitation-container"><div class="ws-chat-invitation-close"><i class="ws-icon-close"></i></div><div class="ws-chat-invitation-body"><div class="ws-chat-invitation-logo"></div><div class="ws-chat-invitation-body-el"><div class="ws-chat-invitation-body-text"></div></div></div><div class="ws-chat-invitation-form"><input type="text" class="ws-chat-invitation-input" placeholder="'+i.lang_text.form_message_placeholder+'"></div></div></div></div>'},setSettings:function(t){var n={dragChatObject:{},resizeChatObject:{},chat_created:!1,chat_old_time:!1,chat_timezone:3,unread_messages:{},unread_messages_count:0,document_title:document.title,document_favicon_href:e('link[rel="shortcut icon"]').length?e('link[rel="shortcut icon"]').attr("href"):e('link[rel="icon"]').attr("href"),new_favicon_href:"",input_scroll:!1,auth_type:"default",default_logo_visitor:WBK.settings.staticServerUrl+"/widget/img/user.png",logo_visitor:!1,is_first_message:!1,first_message:!1,bottom_body:62,height_input:56,allow_mime_file:".pdf,.txt,.doc,.docx,.xls,.xlsm,.rar,.zip",allow_mime_img:"image/png,image/jpg,image/jpeg,image/gif",invitation_show_data:!1,invitation_operator_id:!1,last_operator_message_id:!1,last_operator_data:!1,send_autoreply:!1,send_autoreply_first:!1,show_one_invitation:!1,fileUploaded:{},fileUploadedCount:0,chatCreating:!1,scallingMobile:!1,windowRatioChat:1,offline_message_sending:!1,scroll_left:0,scroll_top:0};e.extend(!0,i,n),e.extend(!0,i,t)},log:function(e){wsUtil.log("CHAT : "+e)}}}(jWS),wsKiller=function(e){var t,i,n,a;return{settings:{},templates:{},widget:{},init:function(s){t=this,i=this.settings,n=this.templates,a=this.widget,e.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),t.loader(s)},loader:function(e){var n=e.Data.callback;t.setDefaultText(),n.killerLangText&&(i.text=n.killerLangText),t.setDefaultSettings(),t.setTemplate(),WBK.settings.callbackEnabled=!0,WBK.settings.killerId=e.Settings.killerId,n.killerHasMoney&&(i.killerHasMoney=1),n.killerIsPayed&&(i.killerIsPayed=!0),n.killerUseDepartment&&n.killerDepartments&&(i.useDepartment=parseInt(n.killerUseDepartment),i.departments=n.killerDepartments),n.killerTimezone&&""!==n.killerTimezone&&(i.killerTimezone=n.killerTimezone,i.killerTimezone=parseInt(i.killerTimezone.charAt(3)+i.killerTimezone.charAt(4)+i.killerTimezone.charAt(5))),n.killerWorkdays&&(i.killerWorkdays=n.killerWorkdays);var a=new Date;if(i.timeDelta=parseInt(a.getTime()/1e3)-WBK.settings.utcTime,a.setTime(1e3*WBK.settings.utcTime+60*a.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3),i.currentDay=a.getDay()-1,i.currentDay<0&&(i.currentDay=6),i.prevDay=i.currentDay-1,i.prevDay<0&&(i.prevDay=6),n.killerFormCall=parseInt(n.killerFormCall),n.killerFormCall&&(i.killerFormCall=n.killerFormCall),parseInt(n.killerFormCallHide)&&(i.killerFormCallHide=parseInt(n.killerFormCallHide)),n.killerCallOff=parseInt(n.killerCallOff),n.killerCallOff&&(i.killerCallOff=n.killerCallOff),n.killerText&&(i.text.killerText=n.killerText,i.text.cbkShareTitle[0][0][0]=t.formatText(i.text.killerText[0].call_deferred[0]),i.text.cbkShareTitle[0][0][1]=t.formatText(i.text.killerText[0].call_deferred[1]),i.text.cbkShareTitle[0][1][0]=t.formatText(i.text.killerText[0].call_deferred[0]),i.text.cbkShareTitle[0][1][1]=t.formatText(i.text.killerText[0].call_deferred[1]),i.text.cbkShareTitle[1][1][0]=t.formatText(i.text.killerText[1].success_call[0]),i.text.cbkShareTitle[1][1][1]=t.formatText(i.text.killerText[1].success_call[1])),e.Settings.serviceName&&(i.text.cbkCopyright=" "+WBK.settings.servicename+"   "),e.Settings.serviceDomain&&(i.cbkLink="http://"+WBK.settings.servicedomain+"?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=killer&utm_term=",WBK.settings.thisIsCallbackKILLER&&(i.cbkLink="http://cb-killer.ru/?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=killer&utm_term=")),n.partnerLink&&(i.cbkLink=n.partnerLink),n.killerIsPaused&&(i.killerIsPaused=n.killerIsPaused),n.killerPausedStart&&(i.killerPausedStart=n.killerPausedStart),n.killerPausedEnd&&(i.killerPausedEnd=n.killerPausedEnd),n.killerPausedDay&&(i.killerPausedDay=n.killerPausedDay),n.killerSettings&&(n.killerSettings.windowPosition&&(i.windowPosition=parseInt(n.killerSettings.windowPosition)),n.killerSettings.killerTransparentBgr&&(i.killerTransparentBgr=!0),n.killerLogo&&(i.killerLogo=n.killerLogo),n.killerBtnLogo&&(i.killerBtnLogo=n.killerBtnLogo),n.killerUpdatedAt&&(i.killerUpdatedAt=n.killerUpdatedAt),n.killerSettings.btnType&&(i.btnType=n.killerSettings.btnType),n.killerSettings.btnSize&&(i.btnSize=n.killerSettings.btnSize),n.killerSettings.btnPosition&&"btn"===i.btnType&&(i.btnPosition=n.killerSettings.btnPosition),n.killerSettings.btnExtendedPosition&&"extended_btn"===i.btnType&&(i.btnExtendedPosition=n.killerSettings.btnExtendedPosition),n.killerSettings.btnExtendedCorner&&"extended_btn"===i.btnType&&(i.btnExtendedCorner=n.killerSettings.btnExtendedCorner),n.killerSettings.hideBtn&&(i.hideBtn=parseInt(n.killerSettings.hideBtn)),n.killerSettings.timerType&&(i.timerType=n.killerSettings.timerType),n.killerSettings.hideDefered&&(i.hideDefered=parseInt(n.killerSettings.hideDefered)),n.killerSettings.btnText&&(i.btnText=n.killerSettings.btnText),n.killerSettings.btnTextAdd&&"pc"==WBK.settings.device&&(i.btnTextAdd=n.killerSettings.btnTextAdd),
n.killerSettings.windowNoCopyright&&(WBK.settings.hideCopyright=!0),n.killerSettings.btnNoAnimateOnScroll&&(i.btnNoPulse=!0),n.killerSettings.btnStaticOnScroll&&(i.btnStaticOnScroll=!0),parseInt(n.killerSettings.btnHideMobileZoom)&&(i.btnHideMobileZoom=!0),n.killerSettings.btnHideOnMobile&&"mobile"===WBK.settings.device&&(i.hideBtn=1),n.killerSettings.btnHideOnTablet&&"tablet"===WBK.settings.device&&(i.hideBtn=1),n.killerSettings.btnRotateTimeout&&(i.timeouts.rotatePhoneIcons=n.killerSettings.btnRotateTimeout),n.killerSettings.btnShowTimeout&&(i.timeouts.btnShowTimeout=n.killerSettings.btnShowTimeout),n.killerSettings.btnShowScroll&&(i.btnShowScroll=n.killerSettings.btnShowScroll),n.killerSettings.windowBtnTextOnline&&(i.windowBtnTextOnline=n.killerSettings.windowBtnTextOnline),n.killerSettings.windowBtnTextOffline&&(i.windowBtnTextOffline=n.killerSettings.windowBtnTextOffline),n.killerSettings.windowNoSendRecordToVisitor&&(i.skipSendRecordToVisitor=!0),void 0!=n.killerSettings.killerManagerRatingCheck&&(i.managerRatingCheck=parseInt(n.killerSettings.killerManagerRatingCheck)),void 0!=n.killerSettings.killerVisitorGetName&&(i.killerVisitorGetName=parseInt(n.killerSettings.killerVisitorGetName)),n.killerSettings.windowDisplayMode&&(1===n.killerSettings.windowDisplayMode&&(i.showWindowReapperanceTimeout=0,i.showOnExitReapperanceTimeout=40),2===n.killerSettings.windowDisplayMode&&(i.showWindowReapperanceTimeout=7,i.showOnExitReapperanceTimeout=10080),3===n.killerSettings.windowDisplayMode&&(i.noShowWindow=!0)),n.killerSettings.killerCallTimeout&&(i.callTimeout=parseInt(n.killerSettings.killerCallTimeout)),n.killerSettings.windowMinApperanceTimeout&&n.killerSettings.windowMaxApperanceTimeout&&n.killerSettings.windowMinApperanceTimeout<n.killerSettings.windowMaxApperanceTimeout?i.showWindowApperanceTimeout=wsUtil.getRandomArbitrary(n.killerSettings.windowMinApperanceTimeout,n.killerSettings.windowMaxApperanceTimeout):n.killerSettings.windowMinApperanceTimeout?i.showWindowApperanceTimeout=wsUtil.getRandomArbitrary(n.killerSettings.windowMinApperanceTimeout,n.killerSettings.windowMinApperanceTimeout+7):n.killerSettings.windowMaxApperanceTimeout&&(i.showWindowApperanceTimeout=wsUtil.getRandomArbitrary(0,n.killerSettings.windowMaxApperanceTimeout)),n.killerSettings.windowNoShowOnExit&&(i.noShowOnExit=!0),(n.killerSettings.btnColor||n.killerSettings.btnMobileColor&&"pc"!=WBK.settings.device)&&("pc"!=WBK.settings.device&&n.killerSettings.btnMobileColor?i.btnColor=n.killerSettings.btnMobileColor:n.killerSettings.btnColor&&(i.btnColor=n.killerSettings.btnColor),WBK.addStyles(".ws-killer .ws-killer-btn{background-color: "+i.btnColor+"!important;} .ws-killer .ws-killer-btn .ws-icon-phone{color: "+i.btnColor+"!important;} .cbk-btn, .cbk-btn:hover {background-color: "+i.btnColor+"!important;} .cbk-phone .cbk-phone-bgr {background-color: "+i.btnColor+"!important;}")),(n.killerSettings.btnTextColor||n.killerSettings.btnMobileTextColor&&"pc"!=WBK.settings.device)&&("pc"!=WBK.settings.device&&n.killerSettings.btnMobileTextColor?i.btnTextColor=n.killerSettings.btnMobileTextColor:n.killerSettings.btnTextColor&&(i.btnTextColor=n.killerSettings.btnTextColor),WBK.addStyles(".ws-killer .ws-btn-title {color: "+i.btnTextColor+"!important} .cbk-btn .cbk-title, .cbk-btn:hover .cbk-title {color: "+i.btnTextColor+"!important;} .cbk-phone .cbk-phone-phone .ws-icon-phone, .cbk-phone .cbk-phone-text, .cbk-phone .cbk-phone-text span, .cbk-phone .cbk-phone-phone.cbk-phone-with-text, .cbk-phone .cbk-phone-phone.cbk-phone-with-text span{color: "+i.btnTextColor+"!important;}")),n.killerSettings.windowBackgroundColor&&WBK.addStyles(".cbk-window .cbk-background div {background-color: "+n.killerSettings.windowBackgroundColor+"!important;}.cbk-window.callbackkiller-mobile .cbk-background, .cbk-window.callbackkiller-mobile .cbk-background div {background-color: "+n.killerSettings.windowBackgroundColor+"!important;}"),n.killerSettings.windowTextColor&&WBK.addStyles(".cbk-window * {color: "+n.killerSettings.windowTextColor+"!important}.cbk-window a, .cbk-window a:hover, .cbk-window a.cbk-button-no.cbk-button-no-dark {color: "+n.killerSettings.windowTextColor+"!important;}.cbk-window a.cbk-button-no.cbk-button-no-dark, .cbk-window a.cbk-button-no.cbk-button-no-dark:hover {color: "+n.killerSettings.windowTextColor+"!important;border-bottom: 1px dashed "+n.killerSettings.windowTextColor+"!important}"),n.killerSettings.windowLinkColor&&WBK.addStyles(".cbk-link-btn a, .cbk-link-btn a:hover, .cbk-link-btn a:active, .cbk-window a.cbk-button-no, .cbk-window a.cbk-button-no:hover{color: "+n.killerSettings.windowLinkColor+"!important; border-bottom: 1px dashed "+n.killerSettings.windowLinkColor+"!important;}"),n.killerSettings.windowInputBackgroundColor&&WBK.addStyles(".cbk-window .cbk-form .cbk-input, .cbk-window .cbk-form .cbk-input:focus, .cbk-window .cbk-form .cbk-input:hover, .cbk-window .cbk-form .cbk-select, .cbk-window .cbk-form .cbk-select option {background: "+n.killerSettings.windowInputBackgroundColor+"!important;}"),n.killerSettings.windowInputTextColor&&WBK.addStyles(".cbk-window .cbk-form .cbk-input, .cbk-window .cbk-form .cbk-input:focus, .cbk-window .cbk-form .cbk-input:hover, .cbk-window .cbk-form .cbk-select, .cbk-window .cbk-form .cbk-select option {color: "+n.killerSettings.windowInputTextColor+"!important;}"),n.killerSettings.windowBtnBackgroundColor&&WBK.addStyles(".cbk-window .cbk-button {background: "+n.killerSettings.windowBtnBackgroundColor.replace(",1)",",.8)")+"!important;}.cbk-window .cbk-button:hover, .cbk-window .cbk-button:active {background: "+n.killerSettings.windowBtnBackgroundColor+"!important;}"),n.killerSettings.windowBtnTextColor&&WBK.addStyles(".cbk-window .cbk-button, .cbk-window .cbk-button:hover, .cbk-window .cbk-button:active {color: "+n.killerSettings.windowBtnTextColor+"!important;}"),"hide"==n.killerSettings.logoShadow&&WBK.addStyles(".cbk-window-logo {box-shadow:none!important;}"),(n.killerSettings.btnPositionBottom||0===n.killerSettings.btnPositionBottom)&&(i.phonePositionBottom=n.killerSettings.btnPositionBottom),(n.killerSettings.btnPositionRight||0===n.killerSettings.btnPositionRight)&&(i.phonePositionRight=n.killerSettings.btnPositionRight),void 0!==n.killerSettings.btnMobilePositionHorizontal&&(i.btnMobilePositionHorizontal=n.killerSettings.btnMobilePositionHorizontal),n.killerSettings.btnMobilePositionHorizontalType&&(i.btnMobilePositionHorizontalType=n.killerSettings.btnMobilePositionHorizontalType),void 0!==n.killerSettings.btnMobilePositionVertical&&(i.btnMobilePositionVertical=n.killerSettings.btnMobilePositionVertical),n.killerSettings.btnMobilePositionVerticalType&&(i.btnMobilePositionVerticalType=n.killerSettings.btnMobilePositionVerticalType)),t.checkWorkTime(),!i.killerWorking&&n.killerOffNoWork&&(i.hideBtn=1,i.noShowOnExit=!0,i.noShowWindow=!0),wsUtil.getCookie("WhiteCallback_callId")&&(i.callId=wsUtil.getCookie("WhiteCallback_callId"),WBK.initSocket()),t.initWidget(),t.initKiller(),"#callbackkiller"===window.top.location.hash||"#callbackwidget"===window.top.location.hash){var s=new Date;s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("CallbackKiller_shownOn","onbtn",s),t.showWindow("btn")}if("#callbackkillermodal"===window.top.location.hash||"#callbackwidgetmodal"===window.top.location.hash){var s=new Date;s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("CallbackKiller_shownOn","onbtn",s),t.showWindow("modal")}},showWindow:function(n,s){if(WBK.settings.windowInvaderOpened&&(wsInvader.widget.window.find(".cbk-support-new-message-copyright").hide(),wsInvader.widget.window.hide()),WBK.settings.chatEnabled&&("auto"==n?WBK.settings.chatBtnOpened&&!WBK.settings.chatInvitationOpened&&(wsChat.widget.btn.hide(),wsChat.widget.invitation.hide()):WBK.settings.chatWindowOpened&&wsChat.widget.window.hide(),WBK.settings.chatBtnOpened&&"auto"!=n&&(wsChat.widget.btn.hide(),wsChat.widget.invitation.hide())),"auto"===n&&(WBK.settings.windowGeneratorOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened))wsUtil.getCookie("WhiteCallback_noShowWindow")||i.noShowWindow||wsUtil.setTimeout("showWindowOnTimer",function(){if(!wsUtil.getCookie("WhiteCallback_noShowWindow")&&!wsUtil.getCookie("WhiteCallback_noShowOnExit")&&(t.checkWorkTime(),!WBK.settings.windowOpened)){var e=new Date;e.setMinutes(e.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onshow",e),t.showWindow("auto")}},1e3*i.showWindowApperanceTimeout);else{if("pc"!=WBK.settings.device&&23663!==WBK.settings.siteId&&(i.scrollLeft=e(window).scrollLeft(),i.scrollTop=e(window).scrollTop(),e("meta[name=viewport]").length?(a.window.data("oldViewport",e("meta[name=viewport]").attr("content")),e("meta[name=viewport]").remove()):a.window.data("noViewport",1),e("head").append(e("<meta>").attr("name","viewport").attr("content","width=device-width, user-scalable=0, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0")),e("body").addClass("cbk-body-mobile")),WBK.settings.windowOpened=!0,a.btn.hasClass("cbk-phone")&&"pc"==WBK.settings.device&&(t.stopRotatePhoneIcons(),a.btn.removeClass("cbk-pulse")),a.btn.is(":visible"))if("exit"===n)a.btn.hide();else{var o="cbk-fadeOutRight";"pc"!=WBK.settings.device?o="cbk-fadeOutDown":1===i.windowPosition&&(o="cbk-fadeOutLeft"),WBK.animateFastOnce(a.btn,o,function(){a.btn.hide()})}if("exit"===n){a.window.addClass("cbk-window-onexit"),a.window.removeClass("cbk-window-modal");var r=a.window.width(),l=i.showOnExitXPosition-r/2;l<0&&(l=0),l+r>window.innerWidth&&(l=window.innerWidth-r-10),a.window.css("left",l+"px")}else if(2!==i.windowPosition&&"modal"!==n||"pc"!=WBK.settings.device)a.window.removeClass("cbk-window-onexit"),2!==i.windowPosition&&a.window.removeClass("cbk-window-modal"),a.window.css("left",""),a.window.css("top","");else{a.window.addClass("cbk-window-modal"),a.window.removeClass("cbk-window-onexit");var r=a.window.width(),l=(window.innerWidth-r)/2;l<0&&(l=0);var c=a.window.height(),d=(window.innerHeight-c)/2;d<0&&(d=0),a.window.css("left",l+"px"),a.window.css("top",d+"px")}if(t.initCallTimer(),i.killerTransparentBgr||a.windowbgr.show(),a.window.show(),"modal"===n)u="cbk-fadeInUp",WBK.animateFastOnce(a.window,u);else if("exit"!==n){var u="cbk-fadeInRight";"pc"!=WBK.settings.device?a.window.show():1===i.windowPosition||2===i.windowPosition?(u="cbk-fadeInLeft",WBK.animateFastOnce(a.window,u)):1!==i.windowPosition&&"sm"===n?("right"!=wsInvader.settings.position&&(u="cbk-fadeInLeft",a.window.addClass("cbk-window-left")),WBK.animateFastOnce(a.window,u)):1!==i.windowPosition&&"instinct"===n&&("right"!=wsInstinct.settings.position_x&&(u="cbk-fadeInLeft",a.window.addClass("cbk-window-left")),WBK.animateFastOnce(a.window,u))}if(t.checkWorkTime(),a.window.find("div.cbk-form").hide(),e("#cbkPhoneBtn").show(),!s&&i.killerWorking){a.window.find("div.cbk-callform .cbk-button-no").show(),i.killerHasMoney&&!i.killerCallOff&&"hide"!=i.timerType?a.window.find(".cbk-timer").show():(!i.killerCallOff&&i.killerHasMoney||(n="nomoney"),a.window.find(".cbk-timer").hide()),"modal"===n?n="auto":"sm"!==n&&"instinct"!==n||(n="btn"),t.setFormText(a.window.find("div.cbk-callform .cbk-form-title"),i.text.killerText[i.killerWorking][n][WBK.settings.hasVisitorName]),t.personalizeForms();var h=a.window.find("div.cbk-callform");h.show(),WBK.animateOnce(h,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(h.find("div.cbk-form-title"),"cbk-bounce")}),t.setPhoneInputFocus()}else{t.setWorkDays(),i.killerHasMoney?"modal"===n?n="auto":"sm"!==n&&"instinct"!==n||(n="btn"):n="nomoney",t.setFormText(a.window.find("div.cbk-cdform .cbk-form-title"),i.text.killerText[i.killerWorking][n][WBK.settings.hasVisitorName]),t.personalizeForms();var g=a.window.find("div.cbk-cdform");g.show(),WBK.animateOnce(g,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(g.find("div.cbk-form-title"),"cbk-bounce")}),t.setPhoneInputFocus()}t.onResizeWindow(),i.callStarted=!1;var p=WBK.settings.serverUrl+"/api?action=newshow&callback=?";e.getJSON(p,{shownOn:wsUtil.getCookie("WhiteCallback_shownOn"),device:WBK.settings.device,code:WBK.settings.whiteSaasCode,googleClientId:wsUtil.getGoogleClientId(),killerId:WBK.settings.killerId,visitorId:WBK.settings.visitorId,advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId()})}t.fixJivo(!0)},hideWindow:function(){if("pc"!=WBK.settings.device&&(a.window.data("noViewport")?(a.window.data("noViewport",0),e("meta[name=viewport]").attr("content","")):e("meta[name=viewport]").attr("content",a.window.data("oldViewport")),e("body").removeClass("cbk-body-mobile"),e(window).scrollTop(i.scrollTop),e(window).scrollLeft(i.scrollLeft),t.fixJivo(!1)),a.windowbgr.hide(),WBK.settings.windowOpened){var n="cbk-fadeOutRight";"pc"!=WBK.settings.device?(a.window.hide(),a.window.find("div.cbk-form").hide()):(1===i.windowPosition||a.window.hasClass("cbk-window-left"))&&(n="cbk-fadeOutLeft"),"pc"==WBK.settings.device&&WBK.animateFastOnce(a.window,n,function(){a.window.hide(),a.window.find("div.cbk-form").hide(),1!==i.windowPosition&&a.window.hasClass("cbk-window-left")&&a.window.removeClass("cbk-window-left")})}if(1!=i.hideBtn&&i.btnShow){var s="cbk-fadeInRight";"pc"!=WBK.settings.device?(s="cbk-fadeInUp",a.btn.show(500)):(a.btn.show(),WBK.animateFastOnce(a.btn,s,function(){t.updatePhonePosition()}))}if(a.btn.hasClass("cbk-phone")&&"pc"==WBK.settings.device&&t.startRotatePhoneIcons(),WBK.settings.windowOpened=!1,i.showWindowReapperanceTimeout){var o=new Date;o.setDate(o.getDate()+parseInt(i.showWindowReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowWindow",1,o)}else wsUtil.setCookie("WhiteCallback_noShowWindow",1);var o=new Date;o.setMinutes(o.getMinutes()+parseInt(i.showOnExitReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowOnExit",1,o),WBK.settings.invaderCallbackStatId=!1,WBK.settings.chatEnabled&&(WBK.settings.chatBtnOpened&&wsChat.widget.btn.show(),WBK.settings.chatWindowOpened&&wsChat.widget.window.show()),WBK.settings.windowInvaderOpened&&wsInvader.showWidget()},startShakeBtn:function(){wsUtil.setInterval("shakeBtn",function(){"extended_btn"==i.btnType?WBK.animateOnce(a.extended_btn,"cbk-shake"):WBK.animateOnce(a.btn,"cbk-shake")},1e3*i.timeouts.shakeBtn)},stopShakeBtn:function(){wsUtil.deleteInterval("shakeBtn")},startRotatePhoneIcons:function(){a.btn.hasClass("cbk-phone")&&t.initBtnText(),a.btn.find(".cbk-phone-content div.cbk-rotate-icon").length||a.btn.find(".cbk-phone-content div:first").addClass("cbk-rotate-icon"),wsUtil.setInterval("rotatePhoneIcons",function(){if(a.btn.hasClass("cbk-pulse"))a.btn.find(".cbk-phone-content div").removeClass("cbk-rotate-icon");else{var e=!1;a.btn.find(".cbk-phone-content div.cbk-rotate-icon").is(":last-child")&&(e=!0),e?(a.btn.find(".cbk-phone-content div").removeClass("cbk-rotate-icon"),a.btn.find(".cbk-phone-content div:first").addClass("cbk-rotate-icon")):a.btn.find(".cbk-phone-content div.cbk-rotate-icon").removeClass("cbk-rotate-icon").next().addClass("cbk-rotate-icon")}a.btn.hasClass("cbk-phone")&&t.initBtnText()},1e3*i.timeouts.rotatePhoneIcons)},stopRotatePhoneIcons:function(){wsUtil.deleteInterval("rotatePhoneIcons"),a.btn.find(".cbk-rotate-icon").removeClass("cbk-rotate-icon"),t.initBtnText()},getBackground:function(e){var i=e.css("background-color"),n=parseFloat(i.split(",")[3],10);return(isNaN(n)||n>.8)&&"transparent"!==i?i:!e.is("body")&&t.getBackground(e.parent())},getLuma:function(e){var t=e.substring(4,e.length-1).split(","),i=t[0],n=t[1],a=t[2],s=.2126*i+.7152*n+.0722*a;return s},showError:function(e,t){e.is("input")?(e.addClass("cbk-error"),"pc"==WBK.settings.device&&e.addClass("cbk-error").focus()):e.is("select")||(e=e.parent()),e.after('<div class="cbk-error-text">'+t+"</div>")},hideErorrs:function(){a.window.find(".cbk-error-text").remove(),a.window.find(".cbk-error").removeClass("cbk-error")},initBtn:function(){"btn"==i.btnType&&i.btnText&&e(".cbk-btn .cbk-title").html(i.btnText),"extended_btn"==i.btnType&&"pc"==WBK.settings.device&&(i.btnText?a.extended_btn.find(".ws-btn-title").html(i.btnText):a.extended_btn.addClass("ws-killer-text-none")),t.initBtnText(),a.btn.hasClass("cbk-phone")?("pc"==WBK.settings.device&&(t.startRotatePhoneIcons(),a.btn.on("mouseenter.callbackkiller",function(e){wsUtil.deleteTimeout("cbkPhonePulse"),a.btn.removeClass("cbk-pulse"),t.stopRotatePhoneIcons()}).on("mouseleave.callbackkiller",function(e){a.btn.find(".cbk-phone-phone").addClass("cbk-rotate-icon"),t.startRotatePhoneIcons()}).on("dragstart",function(e){e.preventDefault()}).on("mousedown.callbackkiller",function(e){1===e.which&&(i.dragObject.elem=t.widget.btn,i.dragObject.downX=e.pageX,i.dragObject.downY=e.pageY)}).on("mouseup.callbackkiller",function(e){if(i.dragObject.dragStarted){i.dragObject.dragStarted=!1;var t=new Date;t.setSeconds(t.getSeconds()+1),wsUtil.setCookie("WhiteCallback_noClickOnPhone",1,t)}i.dragObject={}})),e(document).on("mouseup.callbackkiller",function(e){if(i.dragObject.dragStarted){i.dragObject.dragStarted=!1;var t=new Date;t.setSeconds(t.getSeconds()+1),wsUtil.setCookie("WhiteCallback_noClickOnPhone",1,t)}i.dragObject={}}),e(document).on("mousemove.callbackkiller",function(e){if(i.dragObject.elem){var t=e.pageX-i.dragObject.downX,n=e.pageY-i.dragObject.downY;if(Math.abs(t)<3&&Math.abs(n)<3)return;i.dragObject.dragStarted||(i.dragObject.oldPosition={left:i.dragObject.elem.position().left||"",top:i.dragObject.elem.position().top||""},i.dragObject.shiftX=i.dragObject.downX-i.dragObject.elem.position().left,i.dragObject.shiftY=i.dragObject.downY-i.dragObject.elem.position().top,i.dragObject.dragStarted=!0),i.dragObject.elem.css({left:e.pageX-i.dragObject.shiftX+"px",top:e.pageY-i.dragObject.shiftY+"px",right:"auto",bottom:"auto"})}})):i.btnNoPulse||t.startShakeBtn()},initBtnText:function(){if(e(".cbk-phone .cbk-phone-text").length){if(i.btnText){var t=new Array,n="",a=0,s=0;for(t=i.btnText.split(" "),s=0;s<t.length;s++)t[s].length>n.length&&(n=t[s]);"sm"===i.btnSize?n.length>10?a=70:n.length>8?a=80:n.length>6&&(a=90):"xs"===i.btnSize?n.length>10?a=70:n.length>8?a=80:n.length>6&&(a=90):n.length>10?a=80:n.length>8&&(a=90),a?e(".cbk-phone .cbk-phone-text").html(e("<span>").addClass("cbk-font-size-"+a).html(i.btnText)):e(".cbk-phone .cbk-phone-text").html(i.btnText)}if(e(".cbk-phone").is(":visible")?e(".cbk-phone .cbk-phone-text").css("marginTop",(e(".cbk-phone").outerHeight()-e(".cbk-phone .cbk-phone-text").outerHeight())/2):(e(".cbk-phone").show(),e(".cbk-phone .cbk-phone-text").css("marginTop",(e(".cbk-phone").outerHeight()-e(".cbk-phone .cbk-phone-text").outerHeight())/2),e(".cbk-phone").hide()),i.btnTextAdd){var t=new Array,n="",a=0,s=0;for(t=i.btnTextAdd.split(" "),s=0;s<t.length;s++)t[s].length>n.length&&(n=t[s]);"sm"===i.btnSize?n.length>10?a=70:n.length>8?a=80:n.length>6&&(a=90):"xs"===i.btnSize?n.length>10?a=70:n.length>8?a=80:n.length>6&&(a=90):n.length>10?a=80:n.length>8&&(a=90),a?e(".cbk-phone .cbk-phone-phone").addClass("cbk-phone-with-text").html(e("<span>").addClass("cbk-font-size-"+a).html(i.btnTextAdd)):e(".cbk-phone .cbk-phone-phone").addClass("cbk-phone-with-text").html(i.btnTextAdd),e(".cbk-phone").is(":visible")?e(".cbk-phone .cbk-phone-phone").css("marginTop",(e(".cbk-phone").outerHeight()-e(".cbk-phone .cbk-phone-phone").outerHeight())/2):(e(".cbk-phone").show(),e(".cbk-phone .cbk-phone-phone").css("marginTop",(e(".cbk-phone").outerHeight()-e(".cbk-phone .cbk-phone-phone").outerHeight())/2),e(".cbk-phone").hide())}}},initPhonePosition:function(){if("pc"!=WBK.settings.device)t.updateBtnMobilePosition();else if("phone"==i.btnType)if(i.btnStaticOnScroll){e(window).width();a.btn.stop().css({left:i.phonePositionRight>50?100-i.phonePositionRight+"%":"auto",right:i.phonePositionRight<50?i.phonePositionRight+"%":"auto",bottom:i.phonePositionBottom<50?i.phonePositionBottom+"%":"auto",top:i.phonePositionBottom>50?100-i.phonePositionBottom+"%":"auto"})}else{var n=e(window).scrollTop(),s=window.innerHeight,o=(e(window).width(),s*i.phonePositionBottom/100),r=s-o+n;i.phonePositionBottom<50&&(r-=a.btn.outerHeight()),a.btn.stop().css({bottom:"auto",top:r+"px",left:i.phonePositionRight>50?100-i.phonePositionRight+"%":"auto",right:i.phonePositionRight<50?i.phonePositionRight+"%":"auto"})}else if("btn"==i.btnType){var l={};"left"===i.btnPosition||"right"===i.btnPosition?(l.bottom=i.phonePositionBottom>50?100-i.phonePositionBottom+"%":"auto",l.top=i.phonePositionBottom<50?i.phonePositionBottom+"%":"auto",i.phonePositionBottom<50?l.marginTop=-a.btn.outerHeight():l.marginBottom=a.btn.outerWidth()):(l.left=i.phonePositionRight>50?100-i.phonePositionRight+"%":"auto",l.right=i.phonePositionRight<50?i.phonePositionRight+"%":"auto"),a.btn.stop().css(l)}else if("extended_btn"==i.btnType){var l={bottom:i.phonePositionBottom<50?i.phonePositionBottom+"%":"auto",top:i.phonePositionBottom>50?100-i.phonePositionBottom+"%":"auto",right:i.phonePositionRight<50?i.phonePositionRight+"%":"auto",left:i.phonePositionRight>50?100-i.phonePositionRight+"%":"auto"};switch(a.btn.show(),i.btnExtendedPosition){case"horizontal":100==i.phonePositionBottom?a.extended_btn.addClass("ws-killer-btn-attach-top"):0==i.phonePositionBottom&&a.extended_btn.addClass("ws-killer-btn-attach-bottom");break;case"vertical_left":a.extended_btn_container.addClass("ws-killer-btn-left"),a.extended_btn.addClass("ws-killer-btn-attach-top"),i.phonePositionBottom>50?l.marginTop=a.extended_btn.outerWidth():l.marginBottom=-a.extended_btn.outerHeight();break;case"vertical_right":a.extended_btn_container.addClass("ws-killer-btn-right"),a.extended_btn.addClass("ws-killer-btn-attach-bottom"),a.extended_btn.show(),i.phonePositionBottom>50?l.marginTop=-a.extended_btn.outerHeight():l.marginBottom=a.extended_btn.outerWidth()}a.btn.hide(),a.extended_btn_container.stop().css(l)}},updatePhonePosition:function(){if("mobile"===WBK.settings.device&&1!=i.hideBtn&&i.btnShow)t.updateBtnMobilePosition();else if("tablet"===WBK.settings.device&&1!=i.hideBtn&&i.btnShow)t.updateBtnMobilePosition();else if("phone"==i.btnType)if(i.btnStaticOnScroll)i.btnNoPulse||"pc"!=WBK.settings.device||(a.btn.addClass("cbk-pulse"),wsUtil.setTimeout("cbkPhonePulse",function(){a.btn.removeClass("cbk-pulse"),a.btn.find(".cbk-phone-phone").addClass("cbk-rotate-icon")},1e3*i.timeouts.phonePulse));else{var n=e(window).scrollTop(),s=window.innerHeight,o=(e(window).width(),s*i.phonePositionBottom/100),r=s-o+n;i.phonePositionBottom<50&&(r-=a.btn.outerHeight()),a.btn.stop().animate({left:i.phonePositionRight>50?100-i.phonePositionRight+"%":"auto",right:i.phonePositionRight<50?i.phonePositionRight+"%":"auto",top:r+"px",bottom:"auto"},350,function(){i.btnNoPulse||"pc"!=WBK.settings.device||(a.btn.addClass("cbk-pulse"),wsUtil.setTimeout("cbkPhonePulse",function(){a.btn.removeClass("cbk-pulse"),a.btn.find(".cbk-phone-phone").addClass("cbk-rotate-icon")},1e3*i.timeouts.phonePulse))})}},updateBtnMobilePosition:function(){var t=window.innerWidth/WBK.getDeviceWidth(),n=.57*t;if(1!=t?i.scallingMobile=!0:i.scallingMobile=!1,i.scallingMobile){a.btn.removeClass("cbk-not-scalling");var s,o=(120-120*n)/2;s="right"===i.btnMobilePositionHorizontalType?e(window).scrollLeft()+window.innerWidth*(i.btnMobilePositionHorizontal/100)-120*n-o:e(window).scrollLeft()+window.innerWidth*(i.btnMobilePositionHorizontal/100)-o;var r;r="bottom"===i.btnMobilePositionVerticalType?e(window).scrollTop()+window.innerHeight*(i.btnMobilePositionVertical/100)-120*n-o:e(window).scrollTop()+window.innerHeight*(i.btnMobilePositionVertical/100)-o,a.btn.css({top:r+"px",bottom:"auto",left:s+"px",right:"auto","-webkit-transform":"scale("+n+")","-khtml-transform":"scale("+n+")","-moz-transform":"scale("+n+")","-ms-transform":"scale("+n+")","-o-transform":"scale("+n+")",transform:"scale("+n+")"})}else{a.btn.addClass("cbk-not-scalling");var l={};"right"===i.btnMobilePositionHorizontalType?(l.right=100-i.btnMobilePositionHorizontal+"%",l.left="auto"):(l.left=i.btnMobilePositionHorizontal+"%",l.right="auto"),"bottom"===i.btnMobilePositionVerticalType?(l.bottom=100-i.btnMobilePositionVertical+"%",l.top="auto"):(l.top=i.btnMobilePositionVertical+"%",l.bottom="auto"),a.btn.css({"-webkit-transform":"scale("+n+")","-khtml-transform":"scale("+n+")","-moz-transform":"scale("+n+")","-ms-transform":"scale("+n+")","-o-transform":"scale("+n+")",transform:"scale("+n+")"}),a.btn.css(l)}1!=i.hideBtn&&i.btnShow&&a.btn.show()},onResizeWindow:function(){if(a.window.hasClass("cbk-window-modal")){var n=a.window.width(),s=(window.innerWidth-n)/2;s<0&&(s=0);var o=a.window.height(),r=(window.innerHeight-o)/2;r<0&&(r=0),a.window.css("left",s+"px"),a.window.css("top",r+"px")}if("pc"!=WBK.settings.device){a.window.find("div.cbk-window-logo").css({margin:"20px auto 0",position:"initial"}),a.window.find("div.cbk-form").css("marginTop",20);var l=a.window.find("div.cbk-forms"),c=a.window.find("div.cbk-form:visible").outerHeight(!0),d=a.window.find("div.cbk-window-logo:visible")?a.window.find("div.cbk-window-logo:visible").outerHeight(!0):0,u=0;window.innerHeight>c+d&&(u=(window.innerHeight-c-d)/2);var h=a.window.find(".cbk-copyright");l.css("marginTop",0),l.css("marginTop",u),h.css("margin-top",0),h.css("margin-top","-"+h.outerHeight()+"px");var g=c+d+u+h.outerHeight();g<window.innerHeight&&(g=window.innerHeight),a.window.find(".cbk-background").attr("style","height:"+g+"px !important"),i.btnHideMobileZoom&&i.scallingMobile&&"pc"!=WBK.settings.device&&a.btn.hide()}else{var l=a.window.find("div.cbk-forms");i.formHeight||(i.formHeight=a.window.find("div.cbk-form:visible").height(),l.height(i.formHeight),a.window.find("div.cbk-forms").height(i.formHeight));var p=0;!i.killerLogo||a.window.hasClass("cbk-window-modal")||a.window.hasClass("cbk-window-onexit")||(p=120);var f=0;f=a.window.hasClass("cbk-window-modal")||a.window.hasClass("cbk-window-onexit")||e.fn._frameCheck()?l.parent().height():window.innerHeight,l.css("marginTop",(f-l.height()+p)/2)}t.updatePhonePosition()},onScroll:function(){var t=this;if(3==i.hideBtn&&!i.btnShow){var n=e(window).scrollTop(),s=e(document).height()-e(window).height(),o=n/s*100;!WBK.settings.windowOpened&&!WBK.settings.windowGeneratorOpened&&i.btnShowScroll<=o&&(i.btnShow=!0,a.btn.show())}i.btnHideMobileZoom&&"pc"!=WBK.settings.device&&a.btn.hide(),wsUtil.setTimeout("scrollTimer",function(){t.updatePhonePosition()},250)},initCallTimer:function(){return"hide"==i.timerType?void a.window.find("div.cbk-timer").hide():(a.window.find("div.cbk-timer").html('<span class="cbk-number">00</span><span class="cbk-d">:</span><span class="cbk-number cbk-number-sec">'+(i.callTimeout-1)+'</span><span class="cbk-d">:</span><span class="cbk-number cbk-number-msec">99</span>'),void("seconds"==i.timerType&&(a.window.find("div.cbk-callform").find(".cbk-d").last().hide(),a.window.find("div.cbk-departmentform").find(".cbk-d").last().hide(),a.window.find("div.cbk-timer").find(".cbk-number-msec").hide())))},fixJivo:function(t){"pc"!=WBK.settings.device&&(t?e("body").append('<style id="cbk-j-fix">div#jivo-iframe-container{z-index:50000 !important;}</style>'):e("#cbk-j-fix").remove())},initWidget:function(){WBK.loadFont();var s=n.phone,o="",r="";if("pc"==WBK.settings.device){if("btn"===i.btnType&&(s=n.btn,"left"===i.btnPosition?o="cbk-btn-left":"top"===i.btnPosition?o="cbk-btn-top":"right"===i.btnPosition&&(o="cbk-btn-right")),"phone"===i.btnType&&(i.btnStaticOnScroll&&(o="cbk-phone-fixed "),"sm"===i.btnSize?o+="cbk-phone-sm":"xs"===i.btnSize&&(o+="cbk-phone-xs")),"extended_btn"===i.btnType)switch(s=n.extended_btn,i.btnExtendedCorner){case"smooth":o+="ws-killer-btn-mini-round";break;case"round":o+="ws-killer-btn-round";break;case"flat":o+="";break;default:o+="ws-killer-btn-mini-round"}"vertical_left"==i.btnExtendedPosition&&(r+="ws-killer-btn-left"),"vertical_right"==i.btnExtendedPosition&&(r+="ws-killer-btn-right")}a.btn=e(s).addClass(o);var l=a.btn;if("extended_btn"===i.btnType&&"pc"==WBK.settings.device&&(a.extended_btn=a.btn.find(".ws-killer-btn").addClass(o),a.extended_btn_container=a.btn.find(".ws-killer-btn-container"),a.extended_btn_container.addClass(r),l=a.extended_btn),l.click(function(e){if(!wsUtil.getCookie("WhiteCallback_noClickOnPhone")){i.dragObject={};var n=new Date;n.setMinutes(n.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onbtn",n),t.showWindow("btn"),t.sendGoal("showonbtn")}return e.preventDefault(),!1}),a.btn.appendTo("body"),a.btn.hide(),"pc"!=WBK.settings.device&&a.btn.addClass("cbk-not-scalling"),1!=i.hideBtn&&(t.initPhonePosition(),t.initBtn(),2==i.hideBtn?wsUtil.setTimeout("btnShowTimeout",function(){i.btnShow=!0,WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||a.btn.show()},1e3*i.timeouts.btnShowTimeout):0==i.hideBtn&&(i.btnShow=!0,WBK.settings.windowOpened||WBK.settings.windowGeneratorOpened||WBK.settings.chatWindowOpened||WBK.settings.chatInvitationOpened||a.btn.show())),a.windowbgr=e(n.windowbgr).hide().click(function(e){return t.hideWindow(),e.preventDefault(),!1}).appendTo("body"),i.killerTransparentBgr&&a.windowbgr.addClass("cbk-window-bgr-transparent"),a.window=e(n.window).hide().find("a.cbk-close-window").click(function(e){return t.hideWindow(),e.preventDefault(),!1}).end().appendTo("body"),i.killerLogo){var c="";i.killerUpdatedAt&&(c="?v="+i.killerUpdatedAt),e(n.windowlogo).html(e("<img/>").attr("src",WBK.settings.serverUrl+i.killerLogo+c)).prependTo(a.window.find(".cbk-forms"))}if("extended_btn"==i.btnType&&i.killerBtnLogo&&"pc"==WBK.settings.device&&a.extended_btn.addClass("ws-killer-logo-yes").find(".ws-killer-logo-img").attr("src",WBK.settings.staticServerUrl+i.killerBtnLogo+"?v="+i.killerUpdatedAt),"pc"==WBK.settings.device&&(1===i.windowPosition?a.window.addClass("cbk-window-left"):2===i.windowPosition&&a.window.addClass("cbk-window-modal")),WBK.settings.hideCopyright?a.window.find("a.cbk-copyright").remove():e("body").on("click","a.cbk-copyright",function(t){WBK.sendAdvertLinkStat(e(this).data("widget"),e(this).attr("href"),e(this).text(),WBK.settings.killerId)}),i.windowBtnTextOnline&&a.window.find("#cbkPhoneBtn").html(i.windowBtnTextOnline),i.windowBtnTextOffline&&a.window.find("#cbkPhoneDeferredBtn").html(i.windowBtnTextOffline),i.hideDefered&&a.window.find(".cbk-link-btn").hide(),a.window.find("div.cbk-form").hide(),e("#cbkCallDeferredTime").change(function(){t.setPhoneInputFocus()}),e("#cbkPhoneBtn").click(function(n){n.preventDefault(),t.hideErorrs();var s=e("#cbkPhoneInput").val();if(WBK.settings.phoneMask=e("#cbkPhoneInput").attr("placeholder"),s)if(s=WBK.checkPhone(s))if(i.useDepartment){if(i.callToPhone=s,i.callToPhoneIsDeferred=!1,!e.fn._frameCheck()){var o=/\#callbackwidget\-(.*)/,r=window.top.location.hash.match(o),l=!(!r||!r[1])&&decodeURI(r[1]);if(l){var c=!1;for(var d in i.departments)i.departments[d].department&&i.departments[d].department==l&&(c=!0);if(c)return t.callToPhone(i.callToPhone,l),void(window.top.location.hash="")}}e("#cbkDepartment").empty();for(var d in i.departments)i.departments[d].department&&""!=i.departments[d].department&&e("#cbkDepartment").append(e("<option>").val(i.departments[d].department).text(i.departments[d].department));a.window.find("div.cbk-form").hide();var u=a.window.find("div.cbk-departmentform");"none"!=i.timerType&&u.find("div.cbk-timer").show(),u.show(),WBK.animateOnce(u,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(u.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow()}else t.callToPhone(s);else t.showError(e("#cbkPhoneInput"),i.text.cbkErrorNoPhone);else t.showError(e("#cbkPhoneInput"),i.text.cbkErrorNoPhone);return!1}),e("#cbkDepartmentBtn").click(function(n){return i.callToPhoneIsDeferred?t.callToPhoneAt(i.callToPhone,e("#cbkCallDeferredTime option:selected").attr("data-date"),e("#cbkCallDeferredTime").val(),e("#cbkDepartment").val()):t.callToPhone(i.callToPhone,e("#cbkDepartment").val()),n.preventDefault(),
!1}),a.window.find("div.cbk-callform .cbk-button-no").click(function(e){t.hideErorrs(),a.window.find("div.cbk-form").hide(),t.checkWorkTime(),t.setWorkDays(),a.window.find("div.cbk-cdform .cbk-form-title").html(i.text.cbkCallLaterTitle),t.personalizeForms();var n=a.window.find("div.cbk-cdform");return n.show(),WBK.animateOnce(n,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(n.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow(),t.setPhoneInputFocus(),e.preventDefault(),!1}),e("#cbkPhoneDeferredBtn").click(function(n){t.hideErorrs();var s=e("#cbkPhoneDeferredInput").val();if(WBK.settings.phoneMask=e("#cbkPhoneDeferredInput").attr("placeholder"),s){if(s=WBK.checkPhone(s))if(i.useDepartment){i.callToPhone=s,i.callToPhoneIsDeferred=!0,e("#cbkDepartment").empty();for(var o in i.departments)i.departments[o].department&&""!=i.departments[o].department&&e("#cbkDepartment").append(e("<option>").val(i.departments[o].department).text(i.departments[o].department));a.window.find("div.cbk-form").hide();var r=a.window.find("div.cbk-departmentform");r.find("div.cbk-timer").hide(),r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow()}else t.callToPhoneAt(s,e("#cbkCallDeferredTime option:selected").attr("data-date"),e("#cbkCallDeferredTime").val())}else t.showError(e("#cbkPhoneDeferredInput"),i.text.cbkErrorNoPhone);return n.preventDefault(),!1}),a.window.find("div.cbk-crqform .cbk-button-yes").click(function(e){return t.callAfterForm(!0),t.onResizeWindow(),e.preventDefault(),!1}),a.window.find("div.cbk-crqform .cbk-button-no").click(function(e){a.window.find("div.cbk-form").hide(),t.setFormText(a.window.find("div.cbk-naform .cbk-form-title"),i.text.killerText[1].no_connect[WBK.settings.hasVisitorName]),t.personalizeForms();var n=a.window.find("div.cbk-naform");return n.show(),WBK.animateOnce(n,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(n.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow(),e.preventDefault(),!1}),a.window.find("div.cbk-gnform .cbk-button-yes").click(function(n){t.hideErorrs();var s=e("#cbkNameInput").val(),o=e("#cbkAgreement:checked").length;if(o)if(s&&""!==s){var r=WBK.settings.serverUrl+"/api?action=setname&callback=?";if(jWS.getJSON(r,{code:WBK.settings.whiteSaasCode,name:s,killerId:WBK.settings.killerId,visitorId:WBK.settings.visitorId},function(e){}),WBK.settings.visitorName=s,t.personalizeForms(),i.callStarted)if(i.skipSendRecordToVisitor)a.window.find("div.cbk-geform .cbk-button-no").click();else{a.window.find("div.cbk-geform .cbk-form-title").html(i.text.cbkSendCallToEmailTitle2),t.personalizeForms(),a.window.find("div.cbk-form").hide();var l=a.window.find("div.cbk-geform");l.show(),WBK.animateOnce(l,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(l.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow()}else t.showWindow("auto")}else t.showError(e("#cbkNameInput"),i.text.cbkErrorNoName);else t.showError(e("#cbkAgreement").parent(),i.text.cbkErrorNoAgree);return n.preventDefault(),!1}),a.window.find("div.cbk-gnform .cbk-button-no").click(function(e){if(i.skipSendRecordToVisitor)a.window.find("div.cbk-geform .cbk-button-no").click();else{a.window.find("div.cbk-geform .cbk-form-title").html(i.text.cbkSendCallToEmailTitle3),t.personalizeForms(),a.window.find("div.cbk-form").hide();var n=a.window.find("div.cbk-geform");n.show(),WBK.animateOnce(n,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(n.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow()}return e.preventDefault(),!1}),a.window.find("div.cbk-geform .cbk-button-yes").click(function(n){t.hideErorrs();var s=e("#cbkEmailInput").val();if(s&&""!==s){var o=WBK.settings.serverUrl+"/api?action=setemail&callback=?";jWS.getJSON(o,{code:WBK.settings.whiteSaasCode,email:s,callId:i.callId,killerId:WBK.settings.killerId,visitorId:WBK.settings.visitorId},function(e){}),a.window.find("div.cbk-form").hide();var r=a.window.find("div.cbk-shareform");a.window.find("div.cbk-shareform .cbk-form-title").html(i.text.cbkShareTitle[i.killerWorking][i.killerHasMoney][WBK.settings.hasVisitorName]),t.personalizeForms(),r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow()}else t.showError(e("#cbkEmailInput"),i.text.cbkErrorNoEmail);return n.preventDefault(),!1}),a.window.find("div.cbk-geform .cbk-button-no").click(function(e){a.window.find("div.cbk-form").hide();var n=a.window.find("div.cbk-shareform"),s=i.text.cbkShareTitle[i.killerWorking][i.killerHasMoney][WBK.settings.hasVisitorName];return"hide"==i.timerType&&i.calling&&(s=i.text.cbkCallTitleOnHideTimer),a.window.find("div.cbk-shareform .cbk-form-title").html(s),t.personalizeForms(),n.show(),WBK.animateOnce(n,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(n.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow(),e.preventDefault(),!1}),WBK.settings.phoneMasks){var d=e.masksSort(WBK.settings.phoneMasks,["#"],/[0-9]|#/,"mask"),u={inputmask:{definitions:{"#":{validator:"[0-9]",cardinality:1}},clearIncomplete:!1,showMaskOnHover:!1,autoUnmask:!0},match:/[0-9]/,replace:"#",list:d,listKey:"mask",onMaskChange:function(){e(this).attr("placeholder",e(this).inputmask("getemptymask"))}};e("#cbkPhoneInput").inputmasks(u),e("#cbkPhoneDeferredInput").inputmasks(u),e(".cbk-phone-checker").inputmasks(u)}e("#cbkPhoneInput").bind("keydown",function(t){13===t.keyCode&&e("#cbkPhoneBtn").click()}),e("#cbkPhoneDeferredInput").bind("keydown",function(t){13===t.keyCode&&e("#cbkPhoneDeferredBtn").click()}),"pc"==WBK.settings.device&&e("#cbkCallDeferredDate").change(function(){var n=new Date;n.setTime(n.getTime()-1e3*i.timeDelta);var a=e(this).val().split("-");n.setYear(a[0]),n.setMonth(parseInt(a[1])-1),n.setDate(a[2]),t.setWorkTimes(n),t.setPhoneInputFocus()}),a.window.find(".cbk-ink-reaction").on("click",function(i){var n=t.getBackground(e(this)),a=t.getLuma(n)>183?" inverse":"",s=e('<div class="cbk-ink'+a+'"></div>'),o=e(this).offset(),r=i.pageX-o.left,l=i.pageY-o.top;s.css({top:l,left:r}).appendTo(e(this)),wsUtil.setTimeout("cbkInkReactionTimout",function(){s.remove()},1500)}),WBK.settings.hideCopyright||"pc"!=WBK.settings.device||WBK.settings.thisIsCallbackKILLER||wsUtil.setInterval("animateCopyright",function(){WBK.animateOnce(a.window.find("a.cbk-copyright"),"cbk-tada")},1e3*i.timeouts.animateCopyright),e(window).on("resize.callbackkiller",function(){t.onResizeWindow()}),e(window).on("scroll.callbackkiller",function(){t.onScroll()}),wsUtil.deleteCookie("WhiteCallback_timePage"),WBK.pageIdentAdd(WBK.pageIdent),WBK.pageIdentGetMainPage()?WBK.pageIdentObserve():WBK.pageIdentSetMainPage(WBK.pageIdent),"pc"==WBK.settings.device&&(i.noShowOnExit||e("body").mouseleave(function(n){var a={x:n.pageX,y:n.pageY-e(document).scrollTop()};if(a.y<=10){if(!WBK.settings.windowOpened&&!WBK.settings.windowGeneratorOpened&&!WBK.settings.chatWindowOpened&&!WBK.settings.chatInvitationOpened&&(1!=parseInt(wsGenerator.settings.showExit)||wsUtil.getCookie("WhiteGenerator_show_"+WBK.settings.generatorId))&&!wsUtil.getCookie("WhiteCallback_noShowOnExit")&&parseInt(wsUtil.getCookie("WhiteCallback_timePage"))>parseInt(i.showOnExitApperanceTimeout)){i.showOnExitXPosition=a.x;var s=new Date;s.setMinutes(s.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onexit",s),t.showWindow("exit")}i.showWindowReapperanceTimeout||wsUtil.deleteCookie("WhiteCallback_noShowWindow")}}),wsUtil.getCookie("WhiteCallback_noShowWindow")||i.noShowWindow||wsUtil.setTimeout("showWindowOnTimer",function(){if(!wsUtil.getCookie("WhiteCallback_noShowWindow")&&(wsUtil.getCookie("WhiteCallback_noShowOnExit")&&!i.showWindowReapperanceTimeout||!wsUtil.getCookie("WhiteCallback_noShowOnExit"))&&(t.checkWorkTime(),!WBK.settings.windowOpened)){var e=new Date;e.setMinutes(e.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onshow",e),t.showWindow("auto")}},1e3*i.showWindowApperanceTimeout),t.checkWorkTime()),"pc"!=WBK.settings.device&&(a.btn.addClass("callbackkiller-mobile"),a.window.addClass("callbackkiller-mobile"),i.windowRatio=window.innerWidth/window.screen.availWidth,wsUtil.setInterval("mobileResize",function(){i.windowRatio!==window.innerWidth/window.screen.availWidth&&(i.windowRatio=window.innerWidth/window.screen.availWidth,t.onResizeWindow())},250)),e("body").on("click.callbackwidget",'a[href="#callbackwidget"], a[href="'+window.top.location.origin+'#callbackwidget"], a[href="'+window.top.location.origin+'/#callbackwidget"], a[href="#callbackkiller"], a[href="'+window.top.location.origin+'#callbackkiller"], a[href="'+window.top.location.origin+'/#callbackkiller"]',function(e){return"extended_btn"==i.btnType?a.extended_btn.click():a.btn.click(),e.preventDefault(),!1}),e("body").on("click.callbackwidget",'a[href="#callbackwidgetmodal"], a[href="'+window.top.location.origin+'#callbackwidgetmodal"], a[href="'+window.top.location.origin+'/#callbackwidgetmodal"], a[href="#callbackwidgetmodal"], a[href="'+window.top.location.origin+'#callbackkillermodal"], a[href="'+window.top.location.origin+'/#callbackkillermodal"]',function(e){var i=new Date;return i.setMinutes(i.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onbtn",i),t.showWindow("modal"),e.preventDefault(),!1}),e("body").keyup(function(e){WBK.settings.windowOpened&&27===e.keyCode&&t.hideWindow()}),a.window.find("span.cbk-service-name").html(WBK.settings.servicename)},checkWorkTime:function(){if(i.killerWorkdays){var e=new Date;e.setTime(e.getTime()-1e3*i.timeDelta+60*e.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3);var t=i.killerWorkdays.time_start[i.currentDay].split(":"),n=i.killerWorkdays.time_end[i.currentDay].split(":"),a=i.killerWorkdays.time_start[i.prevDay].split(":"),s=i.killerWorkdays.time_end[i.prevDay].split(":");if(i.killerIsPaused&&i.killerPausedStart&&i.killerPausedEnd){var o=i.killerPausedStart.split("."),r=new Date(parseInt(o[2]),parseInt(o[1])-1,parseInt(o[0]),e.getHours(),e.getMinutes(),e.getSeconds());r.setTime(r.getTime()-1e3*i.timeDelta+60*e.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3);var l=i.killerPausedEnd.split("."),c=new Date(parseInt(l[2]),parseInt(l[1])-1,parseInt(l[0]),e.getHours(),e.getMinutes()+1,e.getSeconds());c.setTime(c.getTime()-1e3*i.timeDelta+60*e.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3),(e.getDate()>=r.getDate()&&e.getMonth()==r.getMonth()||e.getDate()<=r.getDate()&&e.getMonth()>r.getMonth())&&e.getFullYear()>=r.getFullYear()&&(e.getDate()<=c.getDate()&&e.getMonth()==c.getMonth()||e.getDate()>=c.getDate()&&e.getMonth()<c.getMonth())&&e.getFullYear()<=c.getFullYear()&&(i.killerIsPausedNow=!0)}if(i.killerWorkdays.workdays[i.currentDay]&&"false"!==i.killerWorkdays.workdays[i.currentDay]&&!i.killerIsPausedNow){var d=new Date(e.getTime());d.setHours(t[0]),d.setMinutes(t[1]),d.setSeconds(0);var u=new Date(e.getTime());u.setHours(n[0]),parseInt(t[0])>parseInt(n[0])&&u.setHours(u.getHours()+24),u.setMinutes(n[1]),u.setSeconds(0),parseInt(t[0])===parseInt(n[0])&&parseInt(t[1])===parseInt(n[1])?i.killerWorking=1:e>d?e<u?(i.killerWorking=1,i.killerWorkingToday=!0):(i.killerWorking=0,i.killerWorkingToday=!1):(i.killerWorking=0,i.killerWorkingToday=!0)}else if(i.killerWorkdays.workdays[i.prevDay]&&"false"!==i.killerWorkdays.workdays[i.prevDay]&&parseInt(s[0])<parseInt(a[0])&&!i.killerIsPausedNow){var d=new Date(e.getTime());d.setDate(d.getDate()-1),d.setHours(a[0]),d.setMinutes(a[1]),d.setSeconds(0);var u=new Date(e.getTime());u.setDate(u.getDate()-1),u.setHours(s[0]),parseInt(a[0])>parseInt(s[0])&&u.setHours(u.getHours()+24),u.setMinutes(s[1]),u.setSeconds(0),parseInt(a[0])===parseInt(s[0])&&parseInt(a[1])===parseInt(s[1])?i.killerWorking=1:e>d?e<u?(i.killerWorking=1,i.killerWorkingToday=!0):(i.killerWorking=0,i.killerWorkingToday=!1):(i.killerWorking=0,i.killerWorkingToday=!0)}else i.killerWorkingToday=!1}else i.killerWorking=0,i.killerWorkingToday=!1},setWorkTimes:function(n){t.checkWorkTime(),e("#cbkCallDeferredTime").empty();var a=n.getDay()-1;a<0&&(a+=7);var s=new Date,o=new Date;o.setTime(o.getTime()-1e3*i.timeDelta+60*o.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3);var r=i.killerWorkdays.time_start[a].split(":"),l=i.killerWorkdays.time_end[a].split(":");i.hourDelta=-o.getTimezoneOffset()/60-i.killerTimezone;var c=new Date(o.getTime());c.setHours(r[0]),c.setHours(c.getHours()+i.hourDelta),c.setMinutes(r[1]),n.getDate()===o.getDate()&&i.killerWorking&&(c.setHours(s.getHours()+1),c.setMinutes(0)),c.setSeconds(0),n.setHours(c.getHours()),n.setMinutes(c.getMinutes()),n.setSeconds(0);var d=new Date(o.getTime());if(d.setHours(l[0]),d.setHours(d.getHours()+i.hourDelta),parseInt(r[0])>parseInt(l[0])?d.setHours(d.getHours()+24):parseInt(r[0])===parseInt(l[0])&&d.setHours(d.getHours()+12),d.setMinutes(l[1]),d.setSeconds(0),c<d)for(;c<d;){var u=c.getHours(),h=c.getMinutes();u>=8&&u<22?(u<10&&(u="0"+u),h<10&&(h="0"+h),e("#cbkCallDeferredTime").append(e("<option>").val(u+":"+h).text(u+":"+h).attr("data-date",n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate())),c.setHours(c.getHours()+1),n.setHours(n.getHours()+1),c.setMinutes(0),n.setMinutes(0),c<d||c>d||e("#cbkCallDeferredTime").append(e("<option>").val(u+":30").text(u+":30").attr("data-date",n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()))):(c.setHours(c.getHours()+1),n.setHours(n.getHours()+1))}else{e("#cbkCallDeferredDate option:selected").remove();var n=new Date;n.setTime(n.getTime()-1e3*i.timeDelta);var g=e("#cbkCallDeferredDate option:selected").val().split("-");n.setYear(g[0]),n.setMonth(parseInt(g[1])-1),n.setDate(g[2]),t.setWorkTimes(n)}},setWorkDays:function(){e("#cbkCallDeferredDate").empty();var n={0:i.text.cbkMondayText,1:i.text.cbkTuesdayText,2:i.text.cbkWednesdayText,3:i.text.cbkThursdayText,4:i.text.cbkFridayText,5:i.text.cbkSaturdayText,6:i.text.cbkSundayText},a=new Date,s=!1,o=!1;if(i.killerIsPaused&&i.killerPausedStart&&i.killerPausedEnd){var r=i.killerPausedStart.split("."),l=new Date(parseInt(r[2]),parseInt(r[1])-1,parseInt(r[0]),a.getHours(),a.getMinutes(),a.getSeconds());l.setTime(l.getTime()-1e3*i.timeDelta+60*a.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3);var c=i.killerPausedEnd.split("."),d=new Date(parseInt(c[2]),parseInt(c[1])-1,parseInt(c[0]),a.getHours(),a.getMinutes()+1,a.getSeconds());d.setTime(d.getTime()-1e3*i.timeDelta+60*a.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3),o=Math.round((d.getTime()-a.getTime())/864e5)}i.killerIsPausedNow?(a.setTime(d.getTime()),s=i.killerPausedDay):(a.setTime(a.getTime()-1e3*i.timeDelta+60*a.getTimezoneOffset()*1e3+60*i.killerTimezone*60*1e3),s=i.currentDay,o=0);for(var u=!1,h=2,g=3,p=0;p<4;p++){var f=s+p;f>6&&(f-=7);var w=!1;if((0===p&&i.killerWorkingToday||p>0)&&i.killerWorkdays.workdays[f]&&"false"!==i.killerWorkdays.workdays[f]){var m=new Date(a.getTime()),v=n[f],b=!1;1===p?(m=new Date(a.getTime()+864e5),i.killerIsPaused&&(m>=l&&m<d?(m=new Date(d.getTime()+864e5),b=!0):(h=1,g=2)),u||(u=new Date(m.getTime())),w=o+p,v=w>6||b?m.getDate()+" "+WBK.settings.months[m.getMonth()]:n[f]):2===p?(m=new Date(a.getTime()+1728e5),i.killerIsPaused&&(m>=l&&m<d?(m=new Date(d.getTime()+24*h*60*60*1e3),b=!0):g=h+1),u&&!b||(u=new Date(m.getTime())),w=o+p,v=w>6||b?m.getDate()+" "+WBK.settings.months[m.getMonth()]:n[f]):3===p?(m=new Date(a.getTime()+2592e5),i.killerIsPaused&&m>=l&&m<d&&(m=new Date(d.getTime()+24*g*60*60*1e3),b=!0),u||(u=new Date(m.getTime())),w=o+p,v=w>6||b?m.getDate()+" "+WBK.settings.months[m.getMonth()]:n[f]):u||(u=new Date(a.getTime()));var k=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate();e("#cbkCallDeferredDate").append(e("<option>").val(k).text(v))}}if(!u){m=new Date(a.getTime()+864e5),u=new Date(a.getTime()+864e5),v=n[i.currentDay];var k=m.getFullYear()+"-"+(m.getMonth()+1)+"-"+m.getDate();e("#cbkCallDeferredDate").append(e("<option>").val(k).text(v))}t.setWorkTimes(u)},initKiller:function(){t._initKiller(),wsUtil.setTimeout("cbkInitKilerTimout",function(){t._initKiller()},3e3)},_initKiller:function(){if(WBK.settings.callbackEnabled&&i.killerFormCall){if("ru-mod.ru"===window.location.hostname&&"/emarket/cart/"===window.location.pathname)return!1;var n="form";2===i.killerFormCall&&(n="form.callbackwidget-call-form, form.callbackkiller-call-form"),console.log("Forms to check:"),console.log(e(document).find(n)),e(document).find(n).off("submit.cbk").on("submit.cbk",function(){t.checkFormOnSubmit(this)});try{e(document).find("iframe").each(function(){var i=this;try{i.contentWindow&&i.contentDocument&&(console.log("Forms in frame to check:"),console.log(e(i.contentWindow.document).find(n)),e(i.contentWindow.document).find(n).off("submit.cbk").on("submit.cbk",function(){t.checkFormOnSubmit(this)}))}catch(a){}})}catch(a){}}e(document).find("input, select").each(function(){var t=e(this).attr("type");"button"!==t&&"submit"!==t&&"radio"!==t&&"checkbox"!==t&&(e(this).off("focus.callbackkiller").on("focus.callbackkiller",function(){i.noShowWindow=!0}),e(this).off("blur.callbackkiller").on("blur.callbackkiller",function(){i.noShowWindow=!1}))}),e(document).find("iframe").each(function(){var t=this;try{t.contentWindow&&t.contentDocument&&e(t.contentWindow.document).find("input, select").each(function(){var t=e(this).attr("type");"button"!==t&&"submit"!==t&&"radio"!==t&&"checkbox"!==t&&(e(this).off("focus.callbackkiller").on("focus.callbackkiller",function(){i.noShowWindow=!0}),e(this).off("blur.callbackkiller").on("blur.callbackkiller",function(){i.noShowWindow=!1}))})}catch(n){}}),t.startCheckNeedToCall()},checkFormOnSubmit:function(n){console.log("Form submitted:"),console.log(e(n)),t.checkWorkTime(),e(n).find("input").each(function(){var a=e(this).attr("type");if("button"!==a&&"submit"!==a&&"radio"!==a&&"checkbox"!==a&&"file"!==a&&"image"!==a&&"password"!==a&&"hidden"!==a){var s=e(this).val();if(WBK.settings.phoneMask="+_(___)___-__-__",s){var s=WBK.checkPhone(e(this).val());if(s){var o=new Date;o.setMinutes(o.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","onform",o);var r=e(n).find("input.callbackwidget-name").val(),l=e(n).find("input.callbackwidget-email").val();""==r&&""==l||WBK.setVisitorData({name:r,email:l}),WBK.settings.phoneMask=e(".cbk-phone-checker:first").attr("placeholder"),i.killerWorking?(wsUtil.setCookie("WhiteCallback_needcall",!0),wsUtil.setCookie("WhiteCallback_needcall_phone",s)):(t.setWorkDays(),t.deferredCall(s,e("#cbkCallDeferredTime option:first").attr("data-date"),e("#cbkCallDeferredTime option:first").text()))}}}})},startCheckNeedToCall:function(){t.checkNeedToCall(),wsUtil.setInterval("checkNeedToCall",function(){t.checkNeedToCall()},1e3*i.timeouts.needToCall)},checkNeedToCall:function(){if(wsUtil.getCookie("WhiteCallback_needcall")&&(t.checkWorkTime(),i.killerWorking)){if(i.killerFormCallHide){if(i.showWindowReapperanceTimeout){var n=new Date;n.setDate(n.getDate()+parseInt(i.showWindowReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowWindow",1,n)}else wsUtil.setCookie("WhiteCallback_noShowWindow",1);var n=new Date;n.setMinutes(n.getMinutes()+parseInt(i.showOnExitReapperanceTimeout)),wsUtil.setCookie("WhiteCallback_noShowOnExit",1,n)}else t.showWindow("auto");i.callingFromForm=!0;var a=wsUtil.getCookie("WhiteCallback_needcall_phone");e("#cbkPhoneInput").val(a),i.phoneMask=e("#cbkPhoneInput").attr("placeholder"),wsUtil.deleteCookie("WhiteCallback_needcall"),wsUtil.deleteCookie("WhiteCallback_needcall_phone"),t.callToPhone(a)}},callAfterForm:function(n){if(i.managerRatingCheck&&n){t.initRating(),a.window.find("div.cbk-form").hide();var s=a.window.find("div.cbk-ratingform");s.show(),WBK.animateOnce(s,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(s.find("div.cbk-form-title"),"cbk-bounce")})}else if(!i.killerVisitorGetName||WBK.settings.visitorName||i.callingFromForm)if(i.skipSendRecordToVisitor)a.window.find("div.cbk-geform .cbk-button-no").click();else{a.window.find("div.cbk-form").hide(),a.window.find("div.cbk-geform .cbk-form-title").html(i.text.cbkSendCallToEmailTitle2),t.personalizeForms();var o=a.window.find("div.cbk-geform");o.show(),WBK.animateOnce(o,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(o.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkEmailInput").focus()}else{a.window.find("div.cbk-form").hide(),i.managerRatingCheck?a.window.find("div.cbk-gnform .cbk-form-title").html(i.text.cbkGetNameTitle):a.window.find("div.cbk-gnform .cbk-form-title").html(i.text.cbkGetNameTitle2),a.window.find("div.cbk-gnform .cbk-button-no").parent().show(),a.window.find("div.cbk-gnform .cbk-service-name").html(WBK.settings.servicename);var r=a.window.find("div.cbk-gnform");r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkNameInput").focus()}},initRating:function(){var n=a.window.find("ul.cbk-call-rating");n.find("a").unbind("mouseenter.callbackkiller").unbind("mouseleave.callbackkiller").unbind("click.callbackkiller").removeClass("cbk-marked"),n.find("a").on("mouseenter.callbackkiller",function(){for(var t=e(this).data("value"),i=1;i<=t;i++)e("#cbkRating"+i).addClass("cbk-marked")}).on("mouseleave.callbackkiller",function(){n.find("a").removeClass("cbk-marked")}).on("click.callbackkiller",function(n){var a=WBK.settings.serverUrl+"/api?action=rating&callback=?",s=e(this).data("value");return jWS.getJSON(a,{code:WBK.settings.whiteSaasCode,rating:s,callId:i.callId,killerId:WBK.settings.killerId,visitorId:WBK.settings.visitorId},function(e){}),t.callAfterForm(!1),t.onResizeWindow(),n.preventDefault(),!1})},personalizeForms:function(){var t=this,n=i.callTimeout+"&nbsp;"+wsUtil.doEnding(i.callTimeout,i.text.cbkSecond1,i.text.cbkSecond2,i.text.cbkSecond3);a.window.find("div.cbk-form-title").each(function(){e(this).html(e(this).html().replace(/\[time\]/g,n))}),WBK.settings.visitorPhone&&(e("#cbkPhoneInput").val(WBK.settings.visitorPhone),e("#cbkPhoneDeferredInput").val(WBK.settings.visitorPhone)),WBK.settings.visitorEmail&&e("#cbkEmailInput").val(WBK.settings.visitorEmail),WBK.settings.visitorName?(a.window.find("span.cbk-visitor-name").replaceWith(e("<a>").addClass("cbk-change-name").addClass("cbk-button-no").addClass("cbk-button-no-dark").attr("href","javascript:void(0)").html(WBK.settings.visitorName)),a.window.find(".cbk-visitor-name-no-link").text(WBK.settings.visitorName),e("#cbkNameInput").val(WBK.settings.visitorName),a.window.find("div.cbk-form-title").each(function(){e(this).html(e(this).html().replace(/\[name\]/g,"<a href='javascript:void(0)' class='cbk-change-name cbk-button-no cbk-button-no-dark'>"+WBK.settings.visitorName+"</a>"))})):(a.window.find(".cbk-visitor-name-to-delete").remove(),a.window.find("div.cbk-form-title").each(function(){e(this).html(e(this).html().replace("[name]",""))})),a.window.find("a.cbk-copyright").attr("href",i.cbkLink),WBK.settings.thisIsCallbackKILLER&&a.window.find("a.cbk-copyright").addClass("cbk-copyright-callbackkiller").html("     "),a.window.find(".cbk-change-name").unbind("click").on("click",function(n){a.window.find("div.cbk-form").hide(),a.window.find("div.cbk-gnform .cbk-form-title").html(i.text.cbkGetNameTitle3),a.window.find("div.cbk-gnform .cbk-button-no").parent().hide(),t.personalizeForms(),a.window.find("div.cbk-gnform .cbk-service-name").html(WBK.settings.servicename);var s=a.window.find("div.cbk-gnform");return s.show(),WBK.animateOnce(s,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(s.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkNameInput").focus(),t.onResizeWindow(),n.preventDefault(),!1})},setPhoneInputFocus:function(){var t="cbkPhoneInput";e("div.cbk-cdform:visible").length&&(t="cbkPhoneDeferredInput"),e("#"+t).val()||i.calling||(""!==WBK.settings.phoneBase?(e("#"+t).val(WBK.settings.phoneBase),"pc"==WBK.settings.device&&(e("#"+t).focus(),7===WBK.settings.phoneBase&&wsUtil.setCaretPosition(e("#"+t),3,3),77===WBK.settings.phoneBase&&wsUtil.setCaretPosition(e("#"+t),4,4),38===WBK.settings.phoneBase&&wsUtil.setCaretPosition(e("#"+t),3,3),44===WBK.settings.phoneBase&&wsUtil.setCaretPosition(e("#"+t),4,4))):"pc"==WBK.settings.device&&wsUtil.setCaretPosition(e("#"+t),2,2))},setFormText:function(e,i){e.html(t.formatText(i))},formatText:function(e){var t=e.title;return e.title&&e.text?t=e.title+"<br/><small>"+e.text+"</small>":!e.title&&e.text&&(t="<small>"+e.text+"</small>"),t},sendGoal:function(e){if(i.killerIsPayed){var t,n,a=!1,s="CallbackWidget";switch(WBK.settings.thisIsCallbackKILLER&&(s="CallbackKILLER"),e){case"call":t=WBK.settings.thisIsCallbackKILLER?"CBK_CALL":"CBW_CALL",n="NewCall",a=!0;break;case"showonbtn":t=WBK.settings.thisIsCallbackKILLER?"CBK_SHOW_ON_BTN":"CBW_SHOW_ON_BTN",n="ShowOnBtn";break;case"form":t=WBK.settings.thisIsCallbackKILLER?"CBK_CALL_ON_FORM":"CBW_CALL_ON_FORM",n="NewCallOnForm"}wsUtil.sendGoal(t,n,s,a)}},callToPhone:function(n,a,s){if(n=WBK.checkPhone(n),n&&!i.calling){i.calling=!0,i.callStarted=!0;var o={phone:n,department:a?a:"",customtext:s?s:e('meta[name="callbackkiller:customtext"]').length?e('meta[name="callbackkiller:customtext"]').attr("content"):"",phoneMask:WBK.settings.phoneMask,shownOn:wsUtil.getCookie("WhiteCallback_shownOn"),url:"string"==typeof document.URL?document.URL:"",device:WBK.settings.device,code:WBK.settings.whiteSaasCode,visitorId:WBK.settings.visitorId,visitId:WBK.settings.visitId,googleClientId:wsUtil.getGoogleClientId(),killerId:WBK.settings.killerId,generatorId:WBK.settings.generatorId,invader_id:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderCallbackStatId,instinct_id:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctCallbackStatId,generatorLeadId:WBK.settings.genLeadId,roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId()},r=WBK.settings.serverUrl+"/api?action=call&callback=?";e.getJSON(r,o,function(e){i.callingGenerator=!1,WBK.settings.genLeadId=!1,WBK.settings.visitorPhone=n,WBK.settings.called=!0,t.onCall(e,o)})}},onCall:function(n,s){if(n.Success||!n.Errors||i.callingFromForm){if(n.Success&&n.Data.noWorkTime&&!i.callingFromForm)n.Data.killerWorkdays&&(i.killerWorkdays=n.Data.killerWorkdays),n.Data.killerIsPaused&&(i.killerIsPaused=n.Data.killerIsPaused),n.Data.killerPausedStart&&(i.killerPausedStart=n.Data.killerPausedStart),n.Data.killerPausedEnd&&(i.killerPausedEnd=n.Data.killerPausedEnd),n.Data.killerPausedDay&&(i.killerPausedDay=n.Data.killerPausedDay),i.calling=!1,i.callStarted=!1,t.showWindow("auto",!0);else if(n.Success&&n.Data.callId){if(i.callingFromForm&&(i.killerFormCallHide||t.showWindow("auto",!1),a.window.find("div.cbk-callform .cbk-form-title").html(i.text.cbkCallTitleOnFormCall),e("#cbkPhoneBtn").hide()),n.Data.callId){i.callId=n.Data.callId;var o=new Date;o.setMinutes(o.getMinutes()+15),wsUtil.setCookie("WhiteCallback_callId",i.callId,o),WBK.initSocket()}if(i.killerHasMoney)if(parseInt(n.Data.callOff))if(i.skipSendRecordToVisitor)a.window.find("div.cbk-geform .cbk-button-no").click();else{a.window.find("div.cbk-form").hide(),a.window.find("div.cbk-geform .cbk-form-title").html(i.text.cbkSendCallToEmailTitle3),t.personalizeForms();var r=a.window.find("div.cbk-geform");r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkEmailInput").focus(),t.onResizeWindow()}else{if(!a.window.find("div.cbk-callform:visible").length){a.window.find("div.cbk-form").hide();var l=a.window.find("div.cbk-callform");l.show()}a.window.find("div.cbk-callform .cbk-link-btn .cbk-button-no").hide(),i.calling=!0,"hide"==i.timerType?t.callAfterForm():wsUtil.setInterval("callTimerAnimation",function(){var e=a.window.find("div.cbk-callform .cbk-timer .cbk-number-sec"),n=a.window.find("div.cbk-callform .cbk-timer .cbk-number-msec"),s=parseInt(e.text()),o=parseInt(n.text());if(o--,o<1&&(s--,o=99),s<1){wsUtil.deleteInterval("callTimerAnimation"),i.calling=!1,a.window.find("div.cbk-form").hide();var r=a.window.find("div.cbk-crqform");r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),t.onResizeWindow(),o=0,s=0}s<10&&(s="0"+s),o<10&&(o="0"+o),e.text(s),n.text(o)},10)}else if(i.skipSendRecordToVisitor)a.window.find("div.cbk-geform .cbk-button-no").click();else{a.window.find("div.cbk-form").hide(),a.window.find("div.cbk-geform .cbk-form-title").html(i.text.cbkSendCallToEmailTitle3),t.personalizeForms();var r=a.window.find("div.cbk-geform");r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkEmailInput").focus(),t.onResizeWindow()}"onform"==wsUtil.getCookie("WhiteCallback_shownOn")&&38835==WBK.settings.siteId?t.sendGoal("form"):t.sendGoal("call")}}else i.useDepartment&&t.showError(e("#cbkDepartment"),n.Errors[0]),i.calling?t.showError(e("#cbkPhoneInput"),n.Errors[0]):t.showError(e("#cbkPhoneDeferredInput"),n.Errors[0]),i.calling=!1,i.callStarted=!1},newCall:function(n,s,o,r){if(n=WBK.checkPhone(n),n&&!i.calling){var l,c;if(e(".callbackwidget-name").each(function(){e(this).val()&&(l=e(this).val())}),e(".callbackwidget-email").each(function(){e(this).val()&&(c=e(this).val())}),(l||c)&&WBK.setVisitorData({name:l,email:c,phone:n}),WBK.settings.phoneMask=a.window.find(".cbk-phone-checker:first").attr("placeholder"),t.checkWorkTime(),i.killerWorking||s)if(o&&r){var d=new Date;d.setMinutes(d.getMinutes()+r),t.deferredCall(n,d.getFullYear()+"-"+((d.getMonth()+1<10?"0":"")+(d.getMonth()+1))+"-"+(d.getDate()<10?"0":"")+d.getDate(),(d.getHours()<10?"0":"")+d.getHours()+":"+(d.getMinutes()<10?"0":"")+d.getMinutes())}else t.callToPhone(n);else t.setWorkDays(),t.deferredCall(n,e("#cbkCallDeferredTime option:first").attr("data-date"),e("#cbkCallDeferredTime option:first").text())}},callToPhoneAt:function(n,s,o,r,l){n=WBK.checkPhone(n),n&&(i.callStarted=!0,t.deferredCall(n,s,o,r,l,function(n){if(!n.Success&&n.Errors)t.showError(e("#cbkPhoneDeferredInput"),n.Errors[0]),i.calling=!1;else if(n.Success){if(n.Data.callId){i.callId=n.Data.callId;var s=new Date;s.setMinutes(s.getMinutes()+15),wsUtil.setCookie("WhiteCallback_callId",i.callId,s)}if(WBK.settings.visitorName)if(i.skipSendRecordToVisitor)a.window.find("div.cbk-geform .cbk-button-no").click();else{a.window.find("div.cbk-form").hide(),a.window.find("div.cbk-geform .cbk-form-title").html(i.text.cbkSendCallToEmailTitle3),t.personalizeForms();var o=a.window.find("div.cbk-geform");o.show(),WBK.animateOnce(o,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(o.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkEmailInput").focus()}else{a.window.find("div.cbk-form").hide(),a.window.find("div.cbk-gnform .cbk-form-title").html(i.text.cbkGetNameTitle2),t.personalizeForms(),a.window.find("div.cbk-gnform .cbk-service-name").html(WBK.settings.servicename);var r=a.window.find("div.cbk-gnform");r.show(),WBK.animateOnce(r,"cbk-fadeIn",function(){"pc"==WBK.settings.device&&WBK.animateOnce(r.find("div.cbk-form-title"),"cbk-bounce")}),"pc"==WBK.settings.device&&e("#cbkNameInput").focus()}t.onResizeWindow(),"onform"==wsUtil.getCookie("WhiteCallback_shownOn")&&38835==WBK.settings.siteId?t.sendGoal("form"):t.sendGoal("call")}}))},deferredCall:function(t,n,a,s,o,r){if(t=WBK.checkPhone(t)){var l=WBK.settings.serverUrl+"/api?action=calldeferred&callback=?";jWS.getJSON(l,{phone:t,department:s?s:"",customtext:o?o:e('meta[name="callbackkiller:customtext"]').length?e('meta[name="callbackkiller:customtext"]').attr("content"):"",phoneMask:WBK.settings.phoneMask,shownOn:wsUtil.getCookie("WhiteCallback_shownOn"),
url:"string"==typeof document.URL?document.URL:"",device:WBK.settings.device,code:WBK.settings.whiteSaasCode,visitorId:WBK.settings.visitorId,visitId:WBK.settings.visitId,googleClientId:wsUtil.getGoogleClientId(),killerWorking:i.killerWorking,hourDelta:i.hourDelta,date:n,time:a,killerId:WBK.settings.killerId,generatorId:WBK.settings.generatorId,generatorLeadId:WBK.settings.genLeadId,invader_id:WBK.settings.invaderId,invaderStatId:WBK.settings.invaderCallbackStatId,instinct_id:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctCallbackStatId,roistatPromo:wsUtil.getRoistatPromo(),advertiseId:wsUtil.getAdvertiseId(),calltrackingId:wsUtil.getCalltrackingId(),lpgeneratorId:wsUtil.getLPGeneratorId()},function(e){"undefined"!=typeof r&&r(e),WBK.settings.genLeadId=!1,WBK.settings.called=!0})}},onCallStatus:function(e){if(parseInt(e.site_id)===WBK.settings.siteId&&parseInt(e.call_id)===i.callId)if(1===parseInt(e.call_status)&&"hide"!=i.timerType){if(WBK.settings.windowOpened||(!i.callingFromForm||i.callingFromForm&&!i.killerFormCallHide)&&t.showWindow("auto"),a.window.find("div.cbk-callform").is(":visible")&&(a.window.find("div.cbk-callform .cbk-form-title").html(i.text.cbkCallTitleCalling),t.personalizeForms(),"pc"==WBK.settings.device)){var n=a.window.find("div.cbk-callform");WBK.animateOnce(n.find("div.cbk-form-title"),"cbk-bounce")}}else if(2===parseInt(e.call_status))WBK.settings.windowOpened||(!i.callingFromForm||i.callingFromForm&&!i.killerFormCallHide)&&t.showWindow("auto"),wsUtil.deleteInterval("callTimerAnimation"),i.calling=!1,t.callAfterForm(),t.onResizeWindow();else if(4===parseInt(e.call_status)){WBK.settings.windowOpened||(!i.callingFromForm||i.callingFromForm&&!i.killerFormCallHide)&&t.showWindow("auto"),wsUtil.deleteInterval("callTimerAnimation"),a.window.find(".cbk-timer").hide(),i.calling=!1,a.window.find("div.cbk-form").hide();var n=a.window.find("div.cbk-callform");n.find("div.cbk-form-title").html(i.text.cbkCallTitleFail),t.personalizeForms(),n.show(),"pc"==WBK.settings.device&&WBK.animateOnce(n.find("div.cbk-form-title"),"cbk-bounce")}},setDefaultText:function(){i.text={cbkBtnTitle:" ",cbkCopyright:" <span class='cbk-service-name'></span>   ",cbkCallTitleCalling:"<span class='cbk-visitor-name'></span><span class='cbk-visitor-name-to-delete'>, </span>   ,  !",cbkCallTitleFail:"     ,    !",cbkCallTitleNoTariff:"<span class='cbk-visitor-name-to-delete'>, </span><span class='cbk-visitor-name'></span>!<br/> ,    !",cbkCallTitleNoTariffOnExit:"<span class='cbk-visitor-name'></span><span class='cbk-visitor-name-to-delete'>, </span>   ?  ,    !",cbkCallTitleOnFormCall:"!<br/><small>    !</small>",cbkCallTitleOnHideTimer:"   ,<br/><small>       !</small>",cbkDepartmentTitle:"    .",cbkDepartmentBtnTitle:"",cbkPhoneBtnTitle:" !",cbkPhoneDeferredBtnTitle:" !",cbkCallLaterBtnTitle:"   ",cbkCallResultQuestionTitle:"<span class='cbk-visitor-name'></span>,<br/><small>     ?</small>",cbkYes:"",cbkNo:"",cbkRatingTitle:"<br/><small>      </small>",cbkSendCallToEmailTitle:"<span class='cbk-visitor-name'></span>,<br/><small> .      email     <span class='cbk-service-name'>"+WBK.settings.servicename+"</span>.</small>",cbkSendCallToEmailTitle2:"<span class='cbk-visitor-name'> </span><span class='cbk-visitor-name-to-delete'>,</span><br/><small><span class='cbk-visitor-name-to-delete'>  </span>   email     <span class='cbk-service-name'>"+WBK.settings.servicename+"</span>.</small>",cbkSendCallToEmailTitle3:"<span class='cbk-visitor-name'> </span><span class='cbk-visitor-name-to-delete'>,</span><br/><small><span class='cbk-visitor-name-to-delete'> </span>  .      email   .</small>",cbkEmailPlaceholder:" email",cbkSendEmail:" !",cbkNoThanks:", ",cbkGetNameTitle:" .<br/><small>          ?</small>",cbkGetNameTitle2:",<br/><small>          ?</small>",cbkGetNameTitle3:"<span class='cbk-visitor-name-no-link'></span>,<br/><small>   <span class='cbk-visitor-name-no-link'></span>,    ,     :)</small>",cbkGetNamePlaceholder:"   ",cbkAcceptAgreement:"  <a target='_blank' href='"+WBK.settings.serviceoferta+"'></a>",cbkSendName:" !",cbkSkip:" &gt;&gt;",cbkShareTitle:{0:{0:{0:"!<br/><small>     .</small>",1:"[name], !<br/><small>     .</small>"},1:{0:"!<br/><small>     .</small>",1:"[name], !<br/><small>     .</small>"}},1:{0:{0:"  !",1:"[name],   !"},1:{0:"  !",1:"[name],   !"}}},cbkYesAgree:", !",cbkCallLaterTitle:"<br/><small>  .</small>",cbkCallLaterTitle3:"   ?<br/><small>     ?</small>",cbkErrorNoPhone:",   !",cbkErrorNoAgree:"   !",cbkErrorNoName:",   !",cbkErrorNoEmail:",   email!",cbkSecond1:"",cbkSecond2:"",cbkSecond3:"",cbkMondayText:"",cbkTuesdayText:"",cbkWednesdayText:"",cbkThursdayText:"",cbkFridayText:"",cbkSaturdayText:"",cbkSundayText:""}},setDefaultSettings:function(){var t={timeouts:{socketReconnect:2,needToCall:1,shakeBtn:5,rotatePhoneIcons:1.5,phonePulse:1.5,animateCopyright:5,btnShowTimeout:0},btnShowScroll:0,btnShow:!1,callTimeout:24,btnColor:!1,btnTextColor:!1,btnNoPulse:!1,btnPosition:!1,btnExtendedPosition:!1,btnExtendedCorner:!1,btnSize:!1,btnStaticOnScroll:!1,btnText:!1,btnTextAdd:!1,btnType:"phone",calling:!1,callingGenerator:!1,callingFromForm:!1,callId:!1,callStarted:!1,callToPhoneIsDeferred:!1,currentDay:0,departments:!1,hideBtn:0,hourDelta:0,killerId:!1,killerCallOff:!1,killerFormCall:!1,killerFormCallHide:0,killerIsPayed:!1,killerLogo:!1,killerBtnLogo:!1,killerUpdatedAt:!1,killerTimezone:3,killerTransparentBgr:!1,killerWorkdays:!1,killerWorking:0,killerWorkingToday:!0,killerHasMoney:0,killerIsPaused:!1,killerPausedStart:!1,killerPausedEnd:!1,killerPausedDay:!1,killerIsPausedNow:!1,noShowOnExit:!1,noShowWindow:!1,phonePositionRight:20,phonePositionBottom:5,prevDay:0,showWindowApperanceTimeout:27,showWindowReapperanceTimeout:1,showOnExitApperanceTimeout:8,showOnExitReapperanceTimeout:1440,skipSendRecordToVisitor:!1,managerRatingCheck:!0,killerVisitorGetName:!0,timeDelta:0,useDepartment:"",sockjs:!1,cbkLink:"https://whitesaas.com?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=&utm_term=",cssUrl:"//saas-support.com/widget/cbk.css",btnMobilePositionHorizontal:40,btnMobilePositionHorizontalType:"left",btnMobilePositionVertical:95,btnMobilePositionVerticalType:"bottom",mobileViewPort:!1,timerType:"millisecond",windowPosition:0,dragObject:{},btnHideMobileZoom:!1,scallingMobile:!1,formHeight:!1,hideDefered:0,scrollLeft:0,scrollTop:0};e.extend(!0,i,t)},setTemplate:function(){n={btn:'<a class="callbackkiller cbk-btn" href="javascript:void(0)"><span class="cbk-title">'+i.text.cbkBtnTitle+"</span></a>",phone:'<a class="callbackkiller cbk-phone" href="javascript:void(0)"><div class="cbk-phone-bgr"></div><div class="cbk-phone-content"><div class="cbk-phone-phone cbk-rotate-icon"><i class="ws-icon-phone"></i></div><div class="cbk-phone-text">'+i.text.cbkBtnTitle+"</div></div></a>",extended_btn:'<div class="ws-killer"><div class="ws-killer-btn-container"><div class="ws-killer-btn"><div class="ws-killer-btn-ico"><div class="ws-killer-btn-logo"><i class="ws-icon-phone"></i><img src="" class="ws-killer-logo-img"></div></div><div class="ws-btn-title">'+i.text.cbkBtnTitle+"</div></div></div></div>",windowbgr:'<div class="cbk-window-bgr"></div>',windowlogo:'<div class="cbk-window-logo"></div>',window:'<div class="callbackkiller cbk-window"><div class="cbk-background"><div></div></div><a class="cbk-close-window" href="javascript:void(0)">&times;</a><a class="cbk-copyright" target="_blank" href="'+i.cbkLink+'" data-widget="callback">'+i.text.cbkCopyright+'</a><div class="cbk-forms"><div class="cbk-form cbk-callform"><div class="cbk-form-title"></div><input type="tel" id="cbkPhoneInput" class="cbk-input" maxlength="22"/><input type="text" class="cbk-phone-checker cbk-input-hidden"/><button type="button" id="cbkPhoneBtn" class="cbk-button cbk-button-lg cbk-ink-reaction">'+i.text.cbkPhoneBtnTitle+'</button><div class="cbk-timer"></div><br/><div class="cbk-link-btn"><a href="javascript:void(0)" class="cbk-button-no">'+i.text.cbkCallLaterBtnTitle+'</a></div></div><div class="cbk-form cbk-cdform"><div class="cbk-form-title"></div><div class="cbk-deferred"><select id="cbkCallDeferredDate" class="cbk-select cbk-deferred-date"></select> <div></div> <select id="cbkCallDeferredTime" class="cbk-select cbk-deferred-time"></select></div><input type="tel" id="cbkPhoneDeferredInput" class="cbk-input" maxlength="22"/><button type="button" id="cbkPhoneDeferredBtn" class="cbk-button cbk-button-lg cbk-ink-reaction">'+i.text.cbkPhoneDeferredBtnTitle+'</button></div><div class="cbk-form cbk-departmentform"><div class="cbk-form-title">'+i.text.cbkDepartmentTitle+'</div><select id="cbkDepartment" class="cbk-select"></select><button type="button" id="cbkDepartmentBtn" class="cbk-button cbk-button-lg cbk-ink-reaction">'+i.text.cbkDepartmentBtnTitle+'</button><div class="cbk-timer"></div></div><div class="cbk-form cbk-crqform"><div class="cbk-form-title">'+i.text.cbkCallResultQuestionTitle+'</div><button type="button" class="cbk-button cbk-button-yes">'+i.text.cbkYes+'</button><button type="button" class="cbk-button cbk-button-no">'+i.text.cbkNo+'</button></div><div class="cbk-form cbk-ratingform"><div class="cbk-form-title">'+i.text.cbkRatingTitle+'</div><ul class="cbk-call-rating"><li><a id="cbkRating1" href="javascript:void(0)" data-value="1">1</a></li><li><a id="cbkRating2" href="javascript:void(0)" data-value="2">2</a></li><li><a id="cbkRating3" href="javascript:void(0)" data-value="3">3</a></li><li><a id="cbkRating4" href="javascript:void(0)" data-value="4">4</a></li><li><a id="cbkRating5" href="javascript:void(0)" data-value="5">5</a></li></ul></div><div class="cbk-form cbk-gnform"><div class="cbk-form-title">'+i.text.cbkGetNameTitle+'</div><input type="text" id="cbkNameInput" class="cbk-input" placeholder="'+i.text.cbkGetNamePlaceholder+'"/><div><label class="cbk-label"><input type="checkbox" checked name="oferta" id="cbkAgreement" class="cbk-input-checkbox">'+i.text.cbkAcceptAgreement+'</label></div><button type="button" class="cbk-button cbk-button-yes">'+i.text.cbkSendName+'</button><div class="cbk-link-btn"><a href="javascript:void(0)" class="cbk-button-no">'+i.text.cbkSkip+'</a></div></div><div class="cbk-form cbk-geform"><div class="cbk-form-title">'+i.text.cbkSendCallToEmailTitle+'</div><input type="text" id="cbkEmailInput" class="cbk-input" placeholder="'+i.text.cbkEmailPlaceholder+'"/><button type="button" class="cbk-button cbk-button-yes">'+i.text.cbkSendEmail+'</button><div class="cbk-link-btn"><a href="javascript:void(0)" class="cbk-button-no">'+i.text.cbkNoThanks+'</a></div></div><div class="cbk-form cbk-shareform"><div class="cbk-form-title"></div></div><div class="cbk-form cbk-naform"><div class="cbk-form-title"></div></div></div></div></div>'}}}}(jWS),wsInstinct=function($){var _this,s,t,w,_debug;return{settings:{},templates:{},widget:{},init:function(e){_this=this,s=this.settings,t=this.templates,w=this.widget,$.fn._frameCheck()&&"undefined"==typeof WBK&&(WBK=document.WBK),_debug=WBK.checkDebug(),_this.loader(e)},loader:function(e){var t=e.Data.instinct;return _this.setSettings(t),WBK.settings.instinctId=parseInt(e.Settings.instinctId),_this.clearStorageData(),s.checked_variants_id=_this.checkVariants(),s.checked_variants_id.length?(_this.setTemplate(),void _this.initWidget()):void _this.log("  ")},clearStorageData:function(){wsUtil.checkStorageTime(["ws_instinct_close_"+WBK.settings.instinctId,"ws_instinct_click_"+WBK.settings.instinctId,"ws_instinct_show_count_time_"+WBK.settings.instinctId]),wsUtil.getStorage("ws_instinct_show_count_time_"+WBK.settings.instinctId)||wsUtil.deleteStorage("ws_instinct_show_data_"+WBK.settings.instinctId)},initWidget:function(){w.window=$(t),w.window.hide().appendTo("body"),w.window.find("span.service-name").html(WBK.settings.servicename),_this.loadWindowEvents(),_this.initPosition(),_this.initTimer()},startShow:function(){_this.checkShow()&&1!=s.started&&(_debug&&_this.log(" "),_this.sendEvents("show","",""),s.started=!0,_this.generateVariant())},getCount:function(){var e,t={shows:0,max_show:s.show_count};return wsUtil.getStorage("ws_instinct_show_data_"+WBK.settings.instinctId)?(e=JSON.parse(wsUtil.getStorage("ws_instinct_show_data_"+WBK.settings.instinctId)),t.max_show!=e.max_show&&(_debug&&_this.log("   ; : "+e.max_show+" : "+t.max_show),e.max_show=t.max_show,wsUtil.setStorage("ws_instinct_show_data_"+WBK.settings.instinctId,JSON.stringify(e)),wsUtil.deleteStorage("ws_instinct_show_count_time_"+WBK.settings.instinctId))):e=t,e},updateCount:function(){var e=_this.getCount();if(e.shows=e.shows+1,wsUtil.setStorage("ws_instinct_show_data_"+WBK.settings.instinctId,JSON.stringify(e)),e.shows>=e.max_show){var t=new Date;"minutes"==s.repeat_show_count_type?t.setMinutes(t.getMinutes()+parseInt(s.repeat_show_count_time)):"days"==s.repeat_show_count_type&&t.setDate(t.getDate()+parseInt(s.repeat_show_count_time)),wsUtil.setStorage("ws_instinct_show_count_time_"+WBK.settings.instinctId,t.getTime())}},generateVariant:function(){if(s.show_variant=!1,_this.checkShow()){_debug&&_this.log(" ");var e=s.checked_variants_id[wsUtil.getRandomArbitrary(0,s.checked_variants_id.length-1)],t=WBK.settings.serverUrl+"/api?action=instinctGenerate&callback=?";$.getJSON(t,{instinctId:WBK.settings.instinctId,variantId:e,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId},function(e){1==e.Success&&wsUtil.setInterval("WidgetInstinctShowTimer",function(){WBK.checkWidgetOpened("instinct")&&(wsUtil.deleteInterval("WidgetInstinctShowTimer"),_this.showVariant(e.Data.variant))},3e3)})}},showVariant:function(e){s.show_variant=e,w.window.find(".inst-title").html(WBK.formatText(e.title)),w.window.find(".inst-text").html(WBK.formatText(e.text)),w.window.find("span.inst-sum").each(function(){$(this).html(wsUtil.humanizeNumber($(this).html()))}),e.img_src?(w.window.removeClass("inst-no-image"),w.window.find(".inst-logo-img").attr("src",WBK.settings.staticServerUrl+"/uploaded/instinct_variants/"+e.id+"/"+e.img_src)):w.window.addClass("inst-no-image"),_this.showWidget(),s.show_count_enabled&&_this.updateCount(),wsUtil.setTimeout("WidgetInstinctCloseTimer",function(){wsUtil.deleteInterval("WidgetInstinctCloseTimer"),_this.hideWidget();var e=_this.getTimeGenerate();wsUtil.setStorage("ws_instinct_time_generate",e);var t=new Date;t.setSeconds(t.getSeconds()+e),wsUtil.setStorage("ws_instinct_time_showed",t.getTime()),wsUtil.setTimeout("WidgetInstinctGenerateTimer",function(){wsUtil.deleteInterval("WidgetInstinctGenerateTimer"),_this.generateVariant()},1e3*e)},1e3*s.show_time)},getTimeGenerate:function(){var e=1;switch(s.interval_show){case"time":e=s.interval_show_time;break;case"behavioral":e=wsUtil.getRandomArbitrary(3,20);break;case"interval":e=wsUtil.getRandomArbitrary(s.interval_show_start,s.interval_show_end)}return e},checkShow:function(){var e=!0;if(wsUtil.getStorage("ws_instinct_close_"+WBK.settings.instinctId)||wsUtil.getStorage("ws_instinct_click_"+WBK.settings.instinctId))return _debug&&_this.log("      "),!1;if(s.show_count_enabled){var t=_this.getCount();s.started&&_debug&&_this.log("  ; : "+t.shows+"; . : "+t.max_show),wsUtil.getStorage("ws_instinct_show_count_time_"+WBK.settings.instinctId)&&(_debug&&_this.log("  "),e=!1)}else wsUtil.deleteStorage("ws_instinct_show_data_"+WBK.settings.instinctId),wsUtil.deleteStorage("ws_instinct_show_count_time_"+WBK.settings.instinctId);return e},checkVariants:function(){var e=[];return $.each(s.variants,function(t,i){var n=!1;switch(i.action){case"killer":i.action_value==WBK.settings.killerId&&(n=!0);break;case"generator":i.action_value==WBK.settings.generatorId&&(n=!0);break;case"chat":i.action_value==WBK.settings.chatWidgetId&&(n=!0);break;case"url":case"javascript":case"other_widget":case"none":n=!0}n&&e.push(t)}),e},initPosition:function(){var e={};switch(s.position_x){case"left":e.left=s.position_x_value+"%",e.right="auto";break;case"right":e.right=s.position_x_value+"%",e.left="auto"}switch(s.position_y){case"bottom":e.bottom=s.position_y_value+"%",e.top="auto";break;case"top":e.top=s.position_y_value+"%",e.bottom="auto"}w.window.css(e)},initTimer:function(){if("disabled"!=s.start_show&&"scroll"!=s.start_show){var e=1;"paused"==s.start_show&&(e=s.show_paused_time),"behavioral"==s.start_show&&(e=wsUtil.getRandomArbitrary(3,27));var t=_this.getTimeGenerate(),i=wsUtil.getStorage("ws_instinct_time_generate"),n=wsUtil.getStorage("ws_instinct_time_showed");i&&n&&i==t&&(n=(new Date).setTime(n),n=(n-(new Date).getTime())/1e3,n>0&&(_debug&&_this.log("       : "+n),e=n)),wsUtil.setInterval("WidgetInstinctTimer",function(){WBK.checkWidgetOpened("instinct")&&(wsUtil.deleteInterval("WidgetInstinctTimer"),_this.startShow())},1e3*e)}},loadWindowEvents:function(){w.window.find(".inst-close").on("click",function(e){e.preventDefault(),_this.stopWidget()}),w.window.on("click",function(e){$(e.target).hasClass("inst-close")||$(e.target).hasClass("service-name")||$(e.target).hasClass("inst-copyright-url")||_this.clickWidget()}),"scroll"==s.start_show&&$(window).on("scroll.inst-container",function(){var e=$(window).scrollTop(),t=$(document).height()-$(window).height(),i=e/t*100;s.show_scroll_percent<=i&&(_this.startShow(),$(window).off("scroll.inst-container"))})},clickWidget:function(){switch(_this.hideWidget(),s.show_variant.action){case"killer":var d=new Date;d.setMinutes(d.getMinutes()+144e3),wsUtil.setCookie("WhiteCallback_shownOn","on_instinct",d),wsKiller.showWindow("instinct");break;case"generator":wsGenerator.showWidget("instinct");break;case"chat":wsChat.showWidget();break;case"url":parseInt(s.show_variant.open_window)?window.location.href=s.show_variant.action_value:window.open(s.show_variant.action_value,"_blank");break;case"javascript":case"other_widget":eval(s.show_variant.action_value)}var date=new Date;"minutes"==s.repeat_show_click_type?date.setMinutes(date.getMinutes()+parseInt(s.repeat_show_click_time)):"days"==s.repeat_show_click_type&&date.setDate(date.getDate()+parseInt(s.repeat_show_click_time)),wsUtil.setStorage("ws_instinct_click_"+WBK.settings.instinctId,date.getTime()),_this.sendEvents("click",s.show_variant.action,s.show_variant.action_value),_this.sendGoal("click")},stopWidget:function(){var e=new Date;"minutes"==s.repeat_show_close_type?e.setMinutes(e.getMinutes()+parseInt(s.repeat_show_close_time)):"days"==s.repeat_show_close_type&&e.setDate(e.getDate()+parseInt(s.repeat_show_close_time)),wsUtil.setStorage("ws_instinct_close_"+WBK.settings.instinctId,e.getTime()),_this.hideWidget(),_this.sendEvents("close",s.show_variant.action,s.show_variant.action_value),_this.sendGoal("close")},showWidget:function(){w.window.show(),"none"!=s.animation_type&&WBK.animateElTime(w.window,s.animation_type,!1,500),"disabled"!=s.show_sound&&WBK.Sound("instinct/"+s.show_sound)},hideWidget:function(){w.window.fadeOut()},sendEvents:function(e,t,i){var n=WBK.settings.serverUrl+"/api?action=instinctEvent&callback=?";$.getJSON(n,{event:e,widgetType:t,widgetId:parseInt(i)?parseInt(i):0,instinctId:WBK.settings.instinctId,instinctStatId:WBK.settings.instinctStatId,code:WBK.settings.whiteSaasCode,visitId:WBK.settings.visitId,visitorId:WBK.settings.visitorId},function(i){if("undefined"!=typeof i.Data.id){if("click"===e)switch(t){case"killer":WBK.settings.instinctCallbackStatId=i.Data.id;break;case"generator":WBK.settings.instinctGeneratorStatId=i.Data.id}"show"===e&&(WBK.settings.instinctStatId=i.Data.id)}})},sendGoal:function(e){var t,i,n,a="Instinct";switch(e){case"click":t="INST_CLICK",i=n="ClickInstinct";break;case"close":t="INST_CANCEL",i=n="ClickInstinct"}wsUtil.sendGoal(t,i,a)},setTemplate:function(){t='<div class="inst-container inst-no-image inst-corner-'+s.corner_type+" inst-shadow-"+s.container_shadow+'" style="background: '+s.color_background+";color: "+s.color_text+'"><div class="inst-logo"><img class="inst-logo-img"></div><div class="inst-body"><div class="inst-title"></div><div class="inst-text"></div></div><div class="inst-close '+(s.hide_close?" ws-hide":"")+'"></div></div>'},setSettings:function(e){var t={checked_variants_id:[],show_variant:!1,started:!1};$.extend(!0,s,t),$.extend(!0,s,e)},log:function(e){wsUtil.log("INSTINCT : "+e)}}}(jWS),function(e){e.ajaxSetup({async:!0}),e.fn.WBK=function(e){if("object"!=typeof e&&e){if("string"==typeof e)return}else if(e.hasOwnProperty("whiteSaasCode"))return jWS.fn._frameCheck()?"object"==typeof document.WBK?void console.log("Only one instance of WhiteSaas can be run"):(document.WBK=new t(e),document.WBK):"object"==typeof window.top.WBK?void console.log("Only one instance of WhiteSaas can be run"):(window.top.WBK=new t(e),window.top.WBK);return this},e.fn._frameCheck=function(){try{return window!=window.top||document!=top.document||self.location!=top.location}catch(e){return!0}};var t=function(t){if(/mtproxy\.yandex\.net/.test(document.URL))return!1;try{if(/webvisor\.com/.test(window.parent.location.hostname))return!1}catch(i){}var n=this;if(n.setDefaultSettings(),n.pageIdent=n.pageIdentGen(),e.extend(n.settings,t),document.referrer&&""!=document.referrer&&!wsUtil.getCookie("WhiteSaas_referrer")){var a=new Date;a.setHours(a.getHours()+1),wsUtil.setCookie("WhiteSaas_referrer",document.referrer,a)}if(!this.settings.whiteSaasCode)return!1;var s=n.settings.serverUrl+"/api?action=load&callback=?",o="";document.URL&&(o=encodeURIComponent(document.URL)),jWS.getJSON(s,{code:n.settings.whiteSaasCode,url:o,referrer:encodeURIComponent(wsUtil.getCookie("WhiteSaas_referrer")),cookie:n.clearServiceCookie(document.cookie),visit_count:n.getVisitCount(),visitorId:!!wsUtil.getCookie("WhiteCallback_visitorId")&&wsUtil.getCookie("WhiteCallback_visitorId")},function(e){try{JSON.stringify||"undefined"==typeof JSON.encode||(JSON.stringify=JSON.encode),JSON.parse||"undefined"==typeof JSON.decode||(JSON.parse=JSON.decode)}catch(t){}n.onLoad(e)}),jWS.fn._frameCheck()?(document.WhiteSaas=this,document.WhiteCallback=this,document.CallbackKiller=this):(window.top.WhiteSaas=this,window.top.WhiteCallback=this,window.top.CallbackKiller=this)};t.prototype.clearServiceCookie=function(e){for(var t=e.split("; "),i=[],n=0;n<t.length;n++)if("string"==typeof t[n])if(0===t[n].search(/WhiteCallback_openedpage/)||0===t[n].search(/sw_openedpage/));else{var a=t[n];i.push(a.substring(0,64))}return i.join("; ")},t.prototype.onLoad=function(e){var t=this;if(e.Success&&e.Data&&e.Settings){if(t.settings.device=e.Settings.device,!e.Settings.visitorId)return!1;if(t.settings.visitorId=e.Settings.visitorId,!wsUtil.getCookie("WhiteCallback_visitorId")){var i=new Date;i.setMinutes(i.getMinutes()+30),wsUtil.setCookie("WhiteCallback_visitorId",t.settings.visitorId,i)}e.Settings.visitId&&(t.settings.visitId=e.Settings.visitId,wsUtil.setCookie("WhiteCallback_visit",e.Settings.visitId),t.updateVisit()),e.Settings.visitorName&&""!==e.Settings.visitorName&&(t.settings.visitorName=e.Settings.visitorName,t.settings.hasVisitorName=1),e.Settings.visitorPhone&&""!==e.Settings.visitorPhone&&(t.settings.visitorPhone=e.Settings.visitorPhone),e.Settings.visitorEmail&&""!==e.Settings.visitorEmail&&(t.settings.visitorEmail=e.Settings.visitorEmail),e.Settings.thisIsCallbackKILLER&&(t.settings.thisIsCallbackKILLER=!0),e.Settings.serviceName&&(t.settings.servicename=e.Settings.serviceName),e.Settings.serviceOferta&&(t.settings.serviceoferta=e.Settings.serviceOferta),e.Settings.serviceDomain&&(t.settings.servicedomain=e.Settings.serviceDomain),e.Settings.serviceId&&(t.settings.serviceid=e.Settings.serviceId),e.Settings.siteId&&(t.settings.siteId=parseInt(e.Settings.siteId)),(e.Settings.phoneBase||""===e.Settings.phoneBase)&&(""===e.Settings.phoneBase?t.settings.phoneBase="":t.settings.phoneBase=parseInt(e.Settings.phoneBase)),e.Settings.phoneMasks&&(t.settings.phoneMasks=e.Settings.phoneMasks),e.Settings.windowNoCopyright&&(t.settings.hideCopyright=!0);var n=new Date;e.Settings.utcTime?t.settings.utcTime=e.Settings.utcTime:t.settings.utcTime=parseInt(n.getTime()/1e3),e.Settings.siteCode&&(t.settings.whiteSaasCode=e.Settings.siteCode),wsUtil.initTimeouts(),wsUtil.initIntervals(),t.initStyles(),t.updatePageShowCount(),wsUtil.deleteCookie("CallbackKiller_timePage"),t.pageIdentAdd(t.pageIdent),t.pageIdentGetMainPage()?t.pageIdentObserve():t.pageIdentSetMainPage(t.pageIdent),t.loadWidgets(e)}},t.prototype.loadWidgets=function(e){var t=this;try{e.Data.callback&&e.Settings.killerId&&(wsKiller.init(e),"function"==typeof window.ws_OnKillerLoad&&window.ws_OnKillerLoad())}catch(i){wsUtil.log("KILLER : "+i.stack)}try{e.Data.chat&&e.Settings.chatWidgetId&&(wsChat.init(e),"function"==typeof window.ws_OnChatLoad&&window.ws_OnChatLoad())}catch(i){wsUtil.log("CHAT : "+i.stack)}if("mobile"!==t.settings.device){try{e.Data.generator&&e.Settings.generatorId&&(wsGenerator.init(e),"function"==typeof window.ws_OnGeneratorLoad&&window.ws_OnGeneratorLoad())}catch(i){wsUtil.log("GENERATOR : "+i.stack)}try{e.Data.invader&&e.Settings.invaderId&&(wsInvader.init(e),"function"==typeof window.ws_OnInvaderLoad&&window.ws_OnInvaderLoad())}catch(i){wsUtil.log("INVADER : "+i.stack)}try{e.Data.instinct&&e.Settings.instinctId&&(wsInstinct.init(e),"function"==typeof window.ws_OnInstinctLoad&&window.ws_OnInstinctLoad())}catch(i){wsUtil.log("INSTINCT : "+i.stack)}}},t.prototype.setVisitorData=function(e){if(!e.name&&!e.email&&!e.phone)return!1;var t=WBK.settings.serverUrl+"/api?action=setVisitorData&callback=?";jWS.getJSON(t,{code:WBK.settings.whiteSaasCode,name:e.name?e.name:WBK.settings.visitorName,email:e.email?e.email:WBK.settings.visitorEmail,phone:e.phone?e.phone:WBK.settings.visitorPhone,visitorId:WBK.settings.visitorId},function(t){WBK.settings.visitorName=e.name?e.name:WBK.settings.visitorName,WBK.settings.visitorEmail=e.email?e.email:WBK.settings.visitorEmail,WBK.settings.visitorPhone=e.phone?e.phone:WBK.settings.visitorPhone})},t.prototype.getVisitCount=function(){return parseInt(wsUtil.getStorage("ws_visit_count"))?parseInt(wsUtil.getStorage("ws_visit_count")):0},t.prototype.updateVisit=function(){var e=this,t=wsUtil.getStorage("ws_visit_id");t!=e.settings.visitId&&(wsUtil.setStorage("ws_visit_id",e.settings.visitId),e.updateVisitCount())},t.prototype.updateVisitCount=function(){var e=this,t=e.getVisitCount(),i=t?t+1:1;wsUtil.setStorage("ws_visit_count",i)},t.prototype.getPageShowCount=function(){return parseInt(wsUtil.getStorage("ws_page_show_count"))?parseInt(wsUtil.getStorage("ws_page_show_count")):0},t.prototype.updatePageShowCount=function(){var e=this,t=e.getPageShowCount(),i=t?t+1:1;wsUtil.setStorage("ws_page_show_count",i)},t.prototype.initStyles=function(){e("body").append("<style id='whitesaas_style'></style>")},t.prototype.addStyles=function(t){e("#whitesaas_style").append(t)},t.prototype.showInvader=function(){window.wsInvader&&wsInvader.showWidget()},t.prototype.showWidgetGenerator=function(e){window.wsGenerator&&wsGenerator.showWidget(e)},t.prototype.showWidgetChat=function(){window.wsChat&&wsChat.showWidget()},t.prototype.showWindow=function(e,t){window.wsKiller&&wsKiller.showWindow(e,t)},t.prototype.newCall=function(e,t){window.wsKiller&&wsKiller.newCall(e,t)},t.prototype.checkFormOnSubmit=function(e){window.wsKiller&&wsKiller.checkFormOnSubmit(e)},t.prototype.callToPhone=function(e,t,i){window.wsKiller&&wsKiller.callToPhone(e,t,i)},t.prototype.setCookie=function(e,t,i,n,a,s){window.wsUtil&&wsUtil.setCookie(e,t,i,n,a,s)},t.prototype.getCookie=function(e){window.wsUtil&&wsUtil.getCookie(e)},t.prototype.setPhoneInputFocusForm=function(e){var t=this;e.val()||(""!==t.settings.phoneBase?(e.val(t.settings.phoneBase),"mobile"!==t.settings.device&&(e.focus(),7===t.settings.phoneBase&&wsUtil.setCaretPosition(e,3,3),38!==t.settings.phoneBase&&47!==t.settings.phoneBase||wsUtil.setCaretPosition(e,3,3),358!==t.settings.phoneBase&&992!==t.settings.phoneBase&&375!==t.settings.phoneBase&&77!==t.settings.phoneBase||wsUtil.setCaretPosition(e,4,4))):"mobile"!==t.settings.device&&wsUtil.setCaretPosition(e,2,2))},t.prototype.initSocket=function(t){var i=this;e.getScript(i.settings.serverUrl+"/widget/socket.io.js",function(){if(!i.settings.socket){var e=i.settings.socketioUrl+"?type=visitor&site_id="+i.settings.siteId+"&id="+i.settings.visitorId,n=new io.connect(e),a={disconnect:function(e){i.settings.socket=!1},sync:function(e){switch(e.event){case"onVisitorMessage":wsChat.onVisitorMessage(e);break;case"onVisitorMessageRead":wsChat.onVisitorMessageRead()}},connected:function(e){i.settings.socket=n,i.settings.socketConnected?WBK.settings.chatEnabled&&wsChat.socketConnected(e,t):"undefined"!=typeof t&&t(e),i.settings.socketConnected=1},onOperatorStatus:function(e){wsChat.onOperatorStatus(e)},onConnectToChat:function(e){wsChat.onConnectToChat(e)},onDisconnectFromChat:function(e){wsChat.onDisconnectFromChat(e)},onCloseChat:function(e){wsChat.onCloseChat(e)},onOperatorPrinting:function(e){wsChat.onOperatorPrinting(e)},onOperatorMessage:function(e){wsChat.onOperatorMessage(e)},onOperatorUpdateMessage:function(e){wsChat.onOperatorUpdateMessage(e)},onMessageReceived:function(e){},onMessageRead:function(e){wsChat.onMessageRead(e)},onUpdateRegistrationId:function(e){wsChat.onUpdateRegistrationId(e)},onCallStatus:function(e){wsKiller.onCallStatus(e)}};Object.keys(a).forEach(function(e){n.on(e,function(t){a[e].call(i,t)})})}})},t.prototype.updateTimeAll=function(){var e=new Date;e.setDate(e.getDate()+1),wsUtil.setCookie("WhiteCallback_timeAll",parseInt(wsUtil.getCookie("WhiteCallback_timeAll"))+1||1,e),wsUtil.setCookie("WhiteCallback_timePage",parseInt(wsUtil.getCookie("WhiteCallback_timePage"))+1||1,e)},t.prototype.pageIdentAdd=function(t){var i=this,n=new Date;n.setFullYear(n.getFullYear()+1);var a=wsUtil.getCookie("WhiteCallback_openedPages"),s=a?a+"."+t:t;wsUtil.setCookie("WhiteCallback_openedPages",s,n),wsUtil.setInterval("incrementPageTime",function(){i.incrementPageTime.apply(i,[t])},1e3),e(window).on("beforeunload",function(){i.pageIdentRemove.apply(i,[t]),wsUtil.deleteInterval("incrementPageTime")})},t.prototype.incrementPageTime=function(e){var t=new Date,i=parseInt((new Date).getTime()/1e3);t.setFullYear(t.getFullYear()+1),wsUtil.setCookie("WhiteCallback_openedpage_"+e,i,t)},t.prototype.pageIdentRemove=function(e){var t=[],i=wsUtil.getCookie("WhiteCallback_openedPages")||"",n=i.split(".");if(wsUtil.deleteCookie("WhiteCallback_openedpage_"+e),0==n.length)return wsUtil.deleteCookie("WhiteCallback_openedPages");
for(var a in n)n.hasOwnProperty(a)&&n[a]!==e&&t.push(n[a]);if(t.length>0){var s=new Date;s.setFullYear(s.getFullYear()+1),wsUtil.setCookie("WhiteCallback_openedPages",t.join("."),s),this.pageIdentSetUpdateMainPage(t[0])}else wsUtil.deleteCookie("WhiteCallback_openedPages"),wsUtil.deleteCookie("WhiteCallback_mainPage"),wsUtil.deleteCookie("WhiteCallback_updateMainPage")},t.prototype.pageIdentSetMainPage=function(e){var t=this,i=new Date;i.setFullYear(i.getFullYear()+1),wsUtil.setCookie("WhiteCallback_mainPage",e,i),wsUtil.setInterval("updateTimeAll",function(){t.updateTimeAll.call(t)},1e3)},t.prototype.pageIdentObserve=function(){var e=this;wsUtil.setInterval("pageIdentObserve",function(){var t=wsUtil.getCookie("WhiteCallback_updateMainPage");t===e.pageIdent&&(e.pageIdentSetMainPage.apply(e,[e.pageIdent]),wsUtil.deleteInterval("pageIdentObserve"),wsUtil.deleteCookie("WhiteCallback_updateMainPage"));var i=parseInt((new Date).getTime()/1e3),n=wsUtil.getCookie("WhiteCallback_mainPage"),a=wsUtil.getCookie("WhiteCallback_openedpage_"+n);a=parseInt(a),(a+3<i||isNaN(a))&&e.pageIdentRemove.apply(e,[n])},1e3)},t.prototype.pageIdentSetUpdateMainPage=function(e){if(e.length>0){var t=new Date;t.setFullYear(t.getFullYear()+1),wsUtil.setCookie("WhiteCallback_updateMainPage",e,t)}else wsUtil.deleteCookie("WhiteCallback_updateMainPage")},t.prototype.pageIdentGetMainPage=function(){return wsUtil.getCookie("WhiteCallback_mainPage")},t.prototype.pageIdentGen=function(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=0;i<5;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},t.prototype.animateOnce=function(t,i,n){t.addClass("cbk-animated").addClass(i),setTimeout(function(){t.removeClass("cbk-animated").removeClass(i),n&&e.isFunction(n)&&n()},1e3)},t.prototype.animateFastOnce=function(t,i,n){t.addClass("cbk-animated").addClass("cbk-animated-fast").addClass(i),setTimeout(function(){t.removeClass("cbk-animated").removeClass("cbk-animated-fast").removeClass(i),n&&e.isFunction(n)&&n()},250)},t.prototype.animateElTime=function(t,i,n,a){t.addClass("cbk-animated").addClass("cbk-animated-fast").addClass(i),setTimeout(function(){t.removeClass("cbk-animated").removeClass("cbk-animated-fast").removeClass(i),n&&e.isFunction(n)&&n()},a)},t.prototype.sendAdvertLinkStat=function(e,t,i,n){var a=this,s=a.settings.serverUrl+"/api?action=advertlinkstat&callback=?";jWS.getJSON(s,{code:a.settings.whiteSaasCode,widget:e,widgetId:n,adverturl:t,adverttext:i,visitId:a.settings.visitId,visitorId:a.settings.visitorId},function(e){})},t.prototype.Sound=function(e){var t=this;if(!e)return!1;var i=!1,n=document.createElement("audio");if(i=!!n.canPlayType,n.canPlayType(!0)&&"no"!=n.canPlayType("audio/mpeg")?ext=".mp3":"no"!=n.canPlayType('audio/ogg; codecs="vorbis"')&&""!=n.canPlayType('audio/ogg; codecs="vorbis"')?ext=".ogg":i=!1,i){var a=t.settings.staticServerUrl+"/widget/audio/"+e+ext;n.src=a,n.load(),n.play()}},t.prototype.checkPhone=function(t){var i=!1;return t&&(t=t.toString(),t=t.replace(/\D/g,""),12===t.length&&"3"===t.charAt(0)&&"8"===t.charAt(1)?(0!==t.indexOf("380",0)&&(t=!1),i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):11===t.length&&"3"===t.charAt(0)&&"8"===t.charAt(1)&&"0"===t.charAt(2)?i=!1:10===t.length&&"0"===t.charAt(0)?(10===t.length&&(t="38"+t),i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):t.length>=13&&"8"===t.charAt(0)&&"6"===t.charAt(1)?(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):11===t.length&&"3"===t.charAt(0)&&"8"===t.charAt(1)&&"6"===t.charAt(2)?(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):12===t.length&&"4"===t.charAt(0)&&"4"===t.charAt(1)?(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):10!==t.length&&11!==t.length||"6"!==t.charAt(0)||"6"!==t.charAt(1)?"3"===t.charAt(0)&&"5"===t.charAt(1)&&"8"===t.charAt(2)?(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):12===t.length&&"3"===t.charAt(0)&&"7"===t.charAt(1)&&"5"===t.charAt(2)?(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):10!==t.length&&14!==t.length||"4"!==t.charAt(0)||"7"!==t.charAt(1)?12===t.length&&"9"===t.charAt(0)&&"9"===t.charAt(1)&&"2"===t.charAt(2)?(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):10===t.length&&"0"!==t.charAt(0)||11===t.length?(10===t.length&&(t="7"+t),11===t.length&&"8"===t.charAt(0)&&(t=t.substring(0,0)+"7"+t.substring(1)),i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):!(t.lenght>=11&&"0"!==t.charAt(0))||"8"!==t.charAt(0)&&"7"!==t.charAt(0)||"3"!==t.charAt(1)&&"4"!==t.charAt(1)&&"8"!==t.charAt(1)&&"9"!==t.charAt(1)||("8"===t.charAt(0)&&(t="7"+t.substring(1)),t=t.substring(0,11),i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1)):(i=e(".cbk-phone-checker:first").val(t).blur().val(),i&&""!==i||(i=!1))),i},t.prototype.checkWidgetOpened=function(e){var t=this,i=!0;switch(e){case"instinct":(t.settings.windowGeneratorOpened||t.settings.windowOpened||t.settings.chatWindowOpened)&&(i=!1)}return i},t.prototype.checkDebug=function(){var e=!1;return 1==wsUtil.getStorage("ws_debug")&&(e=!0),e},t.prototype.getDeviceWidth=function(){var e=0==window.orientation?window.screen.width:window.screen.height;return navigator.userAgent.indexOf("Android")>=0&&(e=window.screen.width),e},t.prototype.formatText=function(e){return e?(e=this.replaceTagVariant(e),e=this.replaceGetParamText(e)):""},t.prototype.replaceGetParamText=function(e){if(!e)return"";for(var t=/\[get:([-\w]+)\]/;_res=t.exec(e);){var i=this.urlParam(_res[1]);e=e.replace(_res[0],i?decodeURIComponent(i):"")}return e},t.prototype.replaceTagVariant=function(t){if(!t)return"";for(var i=/\[\#([-\w]+)\]/;_result=i.exec(t);){var n=new RegExp("\\[\\#"+_result[1]+"\\]","gi");t=t.replace(n,e("#"+_result[1]).text())}return t},t.prototype.urlParam=function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null==t?null:t[1]||0},t.prototype.loadFont=function(){if(!this.fontLoaded){this.fontLoaded=!0;var e=8;WBK.addStyles("@font-face{font-family: 'whitesaas';src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.eot?"+e+"');src: url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.eot?"+e+"#iefix') format('embedded-opentype'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.woff2?"+e+"') format('woff2'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.woff?"+e+"') format('woff'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.ttf?"+e+"') format('truetype'),url('"+WBK.settings.staticServerUrl+"/widget/fonts/whitesaas.svg?"+e+"#font3435') format('svg');font-weight: normal;font-style: normal;}")}},t.prototype.setDefaultSettings=function(){this.settings={thisIsCallbackKILLER:!1,servicename:"WhiteSaaS",servicedomain:"whitesaas.com",serviceoferta:"https://whitesaas.com/img/oferta.pdf",serviceid:0,partnerLink:"https://whitesaas.com?utm_source=widget&utm_medium=self&utm_campaign="+location.hostname+"&utm_content=&utm_term=",whiteSaasCode:0,utcTime:!1,visitorId:!1,visitId:!1,siteId:0,visitorName:!1,visitorPhone:!1,visitorEmail:!1,hasVisitorName:0,phoneBase:7,phoneMasks:!1,device:"pc",phoneMask:"+_(___)___-__-__",language:"ru",months:{0:"",1:"",2:"",3:"",4:"",5:"",6:"",7:"",8:"",9:"",10:"",11:""},domain:document.domain,serverUrl:"https://whitesaas.com",staticServerUrl:"https://cdn.saas-support.com",socketioUrl:"https://chat.callbackkiller.com/cbk",socketConnected:0,windowOpened:!1,windowGeneratorOpened:!1,windowInvaderOpened:!1,callbackEnabled:!1,generatorEnabled:!1,chatEnabled:!1,chatBtnOpened:!1,chatWindowOpened:!1,chatInvitationOpened:!1,chatInvitationShown:!1,hideCopyright:!1,invaderStatId:!1,invaderCallbackStatId:!1,invaderGeneratorStatId:!1,instinctStatId:!1,instinctCallbackStatId:!1,instinctGeneratorStatId:!1,generatorStatId:!1,genLeadId:!1,called:!1,fontLoaded:!1}}}(jWS),jWS(document).ready(function(){!window.whitesaas_code&&window.callbackkiller_code&&(window.whitesaas_code=window.callbackkiller_code),jWS().WBK({whiteSaasCode:window.whitesaas_code})}),!window.whitesaas_code)for(var scripts=document.getElementsByTagName("script"),i=scripts.length;i--;i>=0)if(!window.whitesaas_code){var whitecallbackScript=scripts[i],whitecallbackScriptQueryString=whitecallbackScript.src.replace(/^[^\?]+\??/,""),whitecallbackScriptParams=parseQuery(whitecallbackScriptQueryString);whitecallbackScriptParams.wcb_code?window.whitesaas_code=whitecallbackScriptParams.wcb_code:whitecallbackScriptParams.cbk_code&&(window.whitesaas_code=whitecallbackScriptParams.cbk_code)}!window.whitesaas_code&&window.callbackkiller_code&&(window.whitesaas_code=window.callbackkiller_code)}();
//# sourceMappingURL=maps/cbk.js.map
